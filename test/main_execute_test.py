'''
Universidad de La Laguna
Máster en Ingeniería Informática
Trabajo de Final de Máster
Pyimagos development
'''

import pytest

import numpy as np
import cv2 as cv

from src.main_execute import search_complete_contours
from src.expected_contours.distal_phalanx import ExpectedContourDistalPhalanx
from src.expected_contours.medial_phalanx import ExpectedContourMedialPhalanx
from src.expected_contours.proximal_phalanx import ExpectedContourProximalPhalanx
from src.expected_contours.metacarpal import ExpectedContourMetacarpal
from src.expected_contours.ulna import ExpectedContourUlna
from src.expected_contours.radius import ExpectedContourRadius
from src.expected_contours.sesamoid import ExpectedContourSesamoid
from src.expected_contours.metacarpal_sesamoid import (
  ExpectedContourSesamoidMetacarpal
)

class TestMainExecute:

  def test_empty_expected_contours(self):
    contours = [
      np.array(
        [[[5, 5]],
        [[10, 5]],
        [[10, 10]],
        [[5, 10]]],
        dtype=np.int32
      ),
    ]
    expected_contours = []
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      50,
      50,
    )
    assert len(complete_contours) == 0

  def test_empty_contours(self):
    contours = []
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      50,
      50,
    )
    assert len(complete_contours) == 0

  def test_horizontal_line_contour(self):
    contours = [
      np.array(
        [[[2, 2]],
         [[4, 2]]],
         dtype=np.int32
      )
    ]
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      41,
      97,
    )
    assert len(complete_contours) == 0

  def test_vertical_line_contour(self):
    contours = [
      np.array(
        [[[2, 2]],
         [[2, 4]]],
         dtype=np.int32
      )
    ]
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      41,
      97,
    )
    assert len(complete_contours) == 0

  @pytest.fixture(scope='class')
  def ideal_distal_phalanx_contour(self):
    yield np.array(
        [[[25, 66]],
        [[24, 67]],
        [[21, 67]],
        [[19, 69]],
        [[19, 72]],
        [[20, 73]],
        [[20, 74]],
        [[21, 75]],
        [[21, 77]],
        [[22, 78]],
        [[22, 81]],
        [[23, 82]],
        [[23, 83]],
        [[22, 84]],
        [[22, 87]],
        [[21, 88]],
        [[21, 89]],
        [[20, 90]],
        [[20, 91]],
        [[19, 92]],
        [[19, 96]],
        [[20, 97]],
        [[31, 97]],
        [[32, 96]],
        [[35, 96]],
        [[36, 95]],
        [[39, 95]],
        [[40, 94]],
        [[41, 94]],
        [[40, 93]],
        [[40, 92]],
        [[41, 91]],
        [[40, 90]],
        [[39, 90]],
        [[34, 85]],
        [[34, 84]],
        [[32, 82]],
        [[32, 79]],
        [[31, 78]],
        [[31, 75]],
        [[32, 74]],
        [[32, 68]],
        [[31, 67]],
        [[28, 67]],
        [[27, 66]]],
        dtype=np.int32
      )

  def test_single_ideal_distal_phalanx(self, ideal_distal_phalanx_contour):
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    complete_contours = search_complete_contours(
      [ideal_distal_phalanx_contour],
      expected_contours,
      600,
      41,
      97,
    )
    assert len(complete_contours) == 1
    found_contours = complete_contours[0]['contours_committed']
    assert len(found_contours) == 1
    assert np.array_equal(found_contours[0], ideal_distal_phalanx_contour)

  def test_invalid_image_width(self, ideal_distal_phalanx_contour):
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    with pytest.raises(ValueError) as excinfo:
      search_complete_contours(
        [ideal_distal_phalanx_contour],
        expected_contours,
        600,
        21,
        97,
      )
    assert "Image width is not enough to cover the whole contour." \
      in str(excinfo.value)
  
  def test_invalid_image_height(self, ideal_distal_phalanx_contour):
    expected_contours = [ExpectedContourDistalPhalanx(1)]
    with pytest.raises(ValueError) as excinfo:
      search_complete_contours(
        [ideal_distal_phalanx_contour],
        expected_contours,
        600,
        22,
        30,
      )
    assert "Image height is not enough to cover the whole contour." \
      in str(excinfo.value)

  def test_ideal_distal_phalanx_and_medial_phalanx(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
      ExpectedContourMedialPhalanx(1),
    ]
    ideal_medial_phalanx = np.array(
      [[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    )
    ideal_distal_phalanx = np.array(
      [[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
    complete_contours = search_complete_contours(
      [ideal_distal_phalanx, ideal_medial_phalanx],
      expected_contours,
      600,
      60,
      140,
    )
    assert len(complete_contours) == 1
    found_contours = complete_contours[0]['contours_committed']
    assert len(found_contours) == 2
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx) or
           np.array_equal(found_contours[1], ideal_distal_phalanx))
    assert (np.array_equal(found_contours[0], ideal_medial_phalanx) or
           np.array_equal(found_contours[1], ideal_medial_phalanx))

  def test_timeout(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
      ExpectedContourMedialPhalanx(1),
    ]
    ideal_medial_phalanx = np.array(
      [[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    )
    ideal_distal_phalanx = np.array(
      [[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
    complete_contours = search_complete_contours(
      [ideal_distal_phalanx, ideal_medial_phalanx],
      expected_contours,
      0,
      60,
      140,
    )
    assert len(complete_contours) == 0

  def test_ideal_finger_jump(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
    ]
    expected_contours.append(
      ExpectedContourMedialPhalanx(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    ideal_medial_phalanx = np.array(
      [[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    )
    ideal_distal_phalanx = np.array(
      [[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
    ideal_distal_phalanx_second_finger = np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]],
      dtype=np.int32
    )
    complete_contours = search_complete_contours(
      [
        ideal_distal_phalanx,
        ideal_medial_phalanx,
        ideal_distal_phalanx_second_finger
      ],
      expected_contours,
      20,
      120,
      140,
    )
    assert len(complete_contours) == 1
    found_contours = complete_contours[0]['contours_committed']
    assert len(found_contours) == 3
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx) or
           np.array_equal(found_contours[1], ideal_distal_phalanx) or
           np.array_equal(found_contours[2], ideal_distal_phalanx))
    assert (np.array_equal(found_contours[0], ideal_medial_phalanx) or
           np.array_equal(found_contours[1], ideal_medial_phalanx) or 
           np.array_equal(found_contours[2], ideal_medial_phalanx))
    assert (
    np.array_equal(
      found_contours[0],
      ideal_distal_phalanx_second_finger
    ) or
    np.array_equal(
      found_contours[1],
      ideal_distal_phalanx_second_finger
    ) or
    np.array_equal(
      found_contours[2],
      ideal_distal_phalanx_second_finger
    ))

  def test_noisy_finger_jump(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
    ]
    expected_contours.append(
      ExpectedContourMedialPhalanx(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    contours = [
      np.array([[[ 39, 116]],
            [[ 38, 117]],
            [[ 36, 117]],
            [[ 35, 118]],
            [[ 34, 118]],
            [[ 33, 119]],
            [[ 29, 119]],
            [[ 28, 118]],
            [[ 24, 118]],
            [[ 22, 120]],
            [[ 22, 125]],
            [[ 24, 127]],
            [[ 24, 128]],
            [[ 25, 129]],
            [[ 25, 134]],
            [[ 26, 135]],
            [[ 26, 136]],
            [[ 27, 137]],
            [[ 27, 142]],
            [[ 28, 143]],
            [[ 28, 151]],
            [[ 29, 152]],
            [[ 29, 153]],
            [[ 37, 153]],
            [[ 38, 152]],
            [[ 43, 152]],
            [[ 44, 151]],
            [[ 45, 151]],
            [[ 46, 150]],
            [[ 47, 150]],
            [[ 48, 149]],
            [[ 53, 149]],
            [[ 54, 148]],
            [[ 55, 148]],
            [[ 55, 145]],
            [[ 50, 140]],
            [[ 50, 139]],
            [[ 47, 136]],
            [[ 47, 135]],
            [[ 45, 133]],
            [[ 45, 132]],
            [[ 44, 131]],
            [[ 44, 124]],
            [[ 45, 123]],
            [[ 45, 121]],
            [[ 46, 120]],
            [[ 42, 116]]],
            dtype=np.int32
      ),
            
      np.array([[[76, 89]],
            [[76, 91]],
            [[75, 92]],
            [[75, 95]],
            [[74, 96]],
            [[74, 97]],
            [[79, 97]],
            [[80, 96]],
            [[85, 96]],
            [[83, 94]],
            [[82, 94]],
            [[79, 91]],
            [[78, 91]]],
            dtype=np.int32
      ),

      np.array([[[ 27,  85]],
            [[ 26,  86]],
            [[ 23,  86]],
            [[ 21,  88]],
            [[ 21,  91]],
            [[ 22,  92]],
            [[ 22,  93]],
            [[ 23,  94]],
            [[ 23,  96]],
            [[ 24,  97]],
            [[ 24, 100]],
            [[ 25, 101]],
            [[ 25, 102]],
            [[ 24, 103]],
            [[ 24, 106]],
            [[ 23, 107]],
            [[ 23, 108]],
            [[ 22, 109]],
            [[ 22, 110]],
            [[ 21, 111]],
            [[ 21, 115]],
            [[ 22, 116]],
            [[ 33, 116]],
            [[ 34, 115]],
            [[ 37, 115]],
            [[ 38, 114]],
            [[ 41, 114]],
            [[ 42, 113]],
            [[ 43, 113]],
            [[ 42, 112]],
            [[ 42, 111]],
            [[ 43, 110]],
            [[ 42, 109]],
            [[ 41, 109]],
            [[ 36, 104]],
            [[ 36, 103]],
            [[ 34, 101]],
            [[ 34,  98]],
            [[ 33,  97]],
            [[ 33,  94]],
            [[ 34,  93]],
            [[ 34,  87]],
            [[ 33,  86]],
            [[ 30,  86]],
            [[ 29,  85]]],
            dtype=np.int32
      ),
      np.array([[[55, 72]],
            [[54, 73]],
            [[50, 73]],
            [[49, 74]],
            [[47, 74]],
            [[49, 76]],
            [[49, 77]],
            [[52, 80]],
            [[52, 81]],
            [[54, 83]],
            [[57, 83]],
            [[58, 82]],
            [[61, 82]],
            [[61, 81]],
            [[60, 80]],
            [[60, 79]],
            [[59, 78]],
            [[59, 76]],
            [[58, 75]],
            [[58, 74]],
            [[57, 73]],
            [[57, 72]]],
            dtype=np.int32
      ),
      np.array([[[74, 70]],
            [[73, 71]],
            [[72, 71]],
            [[71, 72]],
            [[70, 72]],
            [[70, 76]],
            [[71, 77]],
            [[71, 81]],
            [[78, 81]],
            [[78, 77]],
            [[79, 76]],
            [[79, 74]],
            [[76, 71]],
            [[75, 71]]],
            dtype=np.int32
      ),
      np.array([[[130,  54]],
            [[130,  56]],
            [[131,  57]],
            [[131,  61]],
            [[132,  62]],
            [[132,  64]],
            [[133,  64]],
            [[134,  63]],
            [[137,  63]],
            [[138,  62]],
            [[141,  62]],
            [[142,  61]],
            [[145,  61]],
            [[146,  60]],
            [[147,  60]],
            [[146,  60]],
            [[145,  59]],
            [[143,  59]],
            [[142,  58]],
            [[140,  58]],
            [[139,  57]],
            [[138,  57]],
            [[137,  56]],
            [[135,  56]],
            [[134,  55]],
            [[132,  55]],
            [[131,  54]]],
            dtype=np.int32
      ),
            
      np.array([
            [[ 98,  35]],
            [[ 97,  36]],
            [[ 96,  36]],
            [[ 94,  38]],
            [[ 94,  39]],
            [[ 93,  40]],
            [[ 93,  42]],
            [[ 94,  43]],
            [[ 94,  44]],
            [[ 95,  45]],
            [[ 95,  47]],
            [[ 96,  48]],
            [[ 96,  50]],
            [[ 95,  51]],
            [[ 95,  54]],
            [[ 94,  55]],
            [[ 94,  56]],
            [[ 93,  57]],
            [[ 93,  58]],
            [[ 88,  63]],
            [[ 88,  67]],
            [[ 90,  67]],
            [[ 91,  68]],
            [[ 98,  68]],
            [[ 99,  69]],
            [[104,  69]],
            [[105,  68]],
            [[111,  68]],
            [[112,  67]],
            [[115,  67]],
            [[115,  63]],
            [[110,  58]],
            [[110,  57]],
            [[109,  56]],
            [[109,  55]],
            [[108,  54]],
            [[108,  50]],
            [[109,  49]],
            [[109,  46]],
            [[110,  45]],
            [[110,  44]],
            [[111,  43]],
            [[111,  41]],
            [[110,  40]],
            [[110,  37]],
            [[109,  37]],
            [[108,  36]],
            [[106,  36]],
            [[105,  35]]],
            dtype=np.int32
      ),

      np.array([[[34, 11]],
            [[33, 12]],
            [[33, 13]],
            [[31, 15]],
            [[31, 16]],
            [[29, 18]],
            [[29, 19]],
            [[26, 22]],
            [[26, 23]],
            [[24, 25]],
            [[24, 26]],
            [[23, 27]],
            [[26, 27]],
            [[27, 26]],
            [[33, 26]],
            [[34, 25]],
            [[41, 25]],
            [[42, 24]],
            [[48, 24]],
            [[49, 23]],
            [[52, 23]],
            [[51, 22]],
            [[50, 22]],
            [[48, 20]],
            [[47, 20]],
            [[45, 18]],
            [[44, 18]],
            [[42, 16]],
            [[41, 16]],
            [[39, 14]],
            [[38, 14]],
            [[36, 12]],
            [[35, 12]]],
            dtype=np.int32
      ),
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      120,
      140,
    )
    assert len(complete_contours) == 1
    found_contours = complete_contours[0]['contours_committed']
    assert len(found_contours) == 3
    ideal_distal_phalanx = contours[2]
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx) or
           np.array_equal(found_contours[1], ideal_distal_phalanx) or
           np.array_equal(found_contours[2], ideal_distal_phalanx))
    ideal_medial_phalanx = contours[0]
    assert (np.array_equal(found_contours[0], ideal_medial_phalanx) or
           np.array_equal(found_contours[1], ideal_medial_phalanx) or 
           np.array_equal(found_contours[2], ideal_medial_phalanx))
    ideal_distal_phalanx_second_finger = contours[6]
    assert (
    np.array_equal(
      found_contours[0],
      ideal_distal_phalanx_second_finger
    ) or
    np.array_equal(
      found_contours[1],
      ideal_distal_phalanx_second_finger
    ) or
    np.array_equal(
      found_contours[2],
      ideal_distal_phalanx_second_finger
    ))


  def test_all_candidate_contours_have_invalid_shape(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
    ]
    expected_contours.append(
      ExpectedContourMedialPhalanx(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    contours = [
      np.array([[[ 39, 116]],
       [[ 38, 117]],
       [[ 36, 117]],
       [[ 35, 118]],
       [[ 34, 118]],
       [[ 33, 119]],
       [[ 29, 119]],
       [[ 28, 118]],
       [[ 24, 118]],
       [[ 22, 120]],
       [[ 22, 125]],
       [[ 24, 127]],
       [[ 24, 128]],
       [[ 25, 129]],
       [[ 25, 134]],
       [[ 26, 135]],
       [[ 26, 136]],
       [[ 27, 137]],
       [[ 27, 142]],
       [[ 28, 143]],
       [[ 28, 151]],
       [[ 29, 152]],
       [[ 29, 153]],
       [[ 37, 153]],
       [[ 38, 152]],
       [[ 43, 152]],
       [[ 44, 151]],
       [[ 45, 151]],
       [[ 46, 150]],
       [[ 47, 150]],
       [[ 48, 149]],
       [[ 53, 149]],
       [[ 54, 148]],
       [[ 55, 148]],
       [[ 55, 145]],
       [[ 50, 140]],
       [[ 50, 139]],
       [[ 47, 136]],
       [[ 47, 135]],
       [[ 45, 133]],
       [[ 45, 132]],
       [[ 44, 131]],
       [[ 44, 124]],
       [[ 45, 123]],
       [[ 45, 121]],
       [[ 46, 120]],
       [[ 42, 116]]],
       dtype=np.int32
    ),
    np.array([[[76, 89]],
       [[76, 91]],
       [[75, 92]],
       [[75, 95]],
       [[74, 96]],
       [[74, 97]],
       [[79, 97]],
       [[80, 96]],
       [[85, 96]],
       [[83, 94]],
       [[82, 94]],
       [[79, 91]],
       [[78, 91]]],
       dtype=np.int32
    ),
    np.array([[[ 27,  85]],
       [[ 26,  86]],
       [[ 23,  86]],
       [[ 21,  88]],
       [[ 21,  91]],
       [[ 22,  92]],
       [[ 22,  93]],
       [[ 23,  94]],
       [[ 23,  96]],
       [[ 24,  97]],
       [[ 24, 100]],
       [[ 25, 101]],
       [[ 25, 102]],
       [[ 24, 103]],
       [[ 24, 106]],
       [[ 23, 107]],
       [[ 23, 108]],
       [[ 22, 109]],
       [[ 22, 110]],
       [[ 21, 111]],
       [[ 21, 115]],
       [[ 22, 116]],
       [[ 33, 116]],
       [[ 34, 115]],
       [[ 37, 115]],
       [[ 38, 114]],
       [[ 41, 114]],
       [[ 42, 113]],
       [[ 43, 113]],
       [[ 42, 112]],
       [[ 42, 111]],
       [[ 43, 110]],
       [[ 42, 109]],
       [[ 41, 109]],
       [[ 36, 104]],
       [[ 36, 103]],
       [[ 34, 101]],
       [[ 34,  98]],
       [[ 33,  97]],
       [[ 33,  94]],
       [[ 34,  93]],
       [[ 34,  87]],
       [[ 33,  86]],
       [[ 30,  86]],
       [[ 29,  85]]],
       dtype=np.int32
    ),
    np.array([[[55, 72]],
       [[54, 73]],
       [[50, 73]],
       [[49, 74]],
       [[47, 74]],
       [[49, 76]],
       [[49, 77]],
       [[52, 80]],
       [[52, 81]],
       [[54, 83]],
       [[57, 83]],
       [[58, 82]],
       [[61, 82]],
       [[61, 81]],
       [[60, 80]],
       [[60, 79]],
       [[59, 78]],
       [[59, 76]],
       [[58, 75]],
       [[58, 74]],
       [[57, 73]],
       [[57, 72]]],
       dtype=np.int32
    ),
    np.array([[[74, 70]],
       [[73, 71]],
       [[72, 71]],
       [[71, 72]],
       [[70, 72]],
       [[70, 76]],
       [[71, 77]],
       [[71, 81]],
       [[78, 81]],
       [[78, 77]],
       [[79, 76]],
       [[79, 74]],
       [[76, 71]],
       [[75, 71]]],
       dtype=np.int32
    ),
    np.array([[[130,  54]],
       [[130,  56]],
       [[131,  57]],
       [[131,  61]],
       [[132,  62]],
       [[132,  64]],
       [[133,  64]],
       [[134,  63]],
       [[137,  63]],
       [[138,  62]],
       [[141,  62]],
       [[142,  61]],
       [[145,  61]],
       [[146,  60]],
       [[147,  60]],
       [[146,  60]],
       [[145,  59]],
       [[143,  59]],
       [[142,  58]],
       [[140,  58]],
       [[139,  57]],
       [[138,  57]],
       [[137,  56]],
       [[135,  56]],
       [[134,  55]],
       [[132,  55]],
       [[131,  54]]],
       dtype=np.int32),
    np.array([[[34, 11]],
       [[33, 12]],
       [[33, 13]],
       [[31, 15]],
       [[31, 16]],
       [[29, 18]],
       [[29, 19]],
       [[26, 22]],
       [[26, 23]],
       [[24, 25]],
       [[24, 26]],
       [[23, 27]],
       [[26, 27]],
       [[27, 26]],
       [[33, 26]],
       [[34, 25]],
       [[41, 25]],
       [[42, 24]],
       [[48, 24]],
       [[49, 23]],
       [[52, 23]],
       [[51, 22]],
       [[50, 22]],
       [[48, 20]],
       [[47, 20]],
       [[45, 18]],
       [[44, 18]],
       [[42, 16]],
       [[41, 16]],
       [[39, 14]],
       [[38, 14]],
       [[36, 12]],
       [[35, 12]]],
       dtype=np.int32
      )
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      120,
      140,
    )
    assert len(complete_contours) == 0

  def test_not_enough_candidate_contours(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
    ]
    expected_contours.append(
      ExpectedContourMedialPhalanx(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    ideal_medial_phalanx = np.array(
      [[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    )
    ideal_distal_phalanx = np.array(
      [[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
    complete_contours = search_complete_contours(
      [
        ideal_distal_phalanx,
        ideal_medial_phalanx,
      ],
      expected_contours,
      20,
      120,
      140,
    )
    assert len(complete_contours) == 0


  def test_ideal_finger_jump_with_added_proximal_phalanx(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
      ExpectedContourMedialPhalanx(1)
    ]
    expected_contours.append(
      ExpectedContourProximalPhalanx(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    contours = [
       np.array([[[ 53, 151]],
              [[ 51, 153]],
              [[ 49, 153]],
              [[ 48, 154]],
              [[ 46, 154]],
              [[ 45, 155]],
              [[ 37, 155]],
              [[ 36, 156]],
              [[ 35, 156]],
              [[ 35, 164]],
              [[ 38, 167]],
              [[ 38, 168]],
              [[ 40, 170]],
              [[ 40, 171]],
              [[ 42, 173]],
              [[ 42, 174]],
              [[ 43, 175]],
              [[ 43, 177]],
              [[ 44, 178]],
              [[ 44, 180]],
              [[ 45, 181]],
              [[ 45, 183]],
              [[ 46, 184]],
              [[ 46, 185]],
              [[ 47, 186]],
              [[ 47, 187]],
              [[ 48, 188]],
              [[ 48, 191]],
              [[ 49, 192]],
              [[ 49, 195]],
              [[ 50, 196]],
              [[ 50, 203]],
              [[ 49, 204]],
              [[ 49, 211]],
              [[ 51, 213]],
              [[ 59, 213]],
              [[ 60, 212]],
              [[ 61, 212]],
              [[ 62, 211]],
              [[ 64, 211]],
              [[ 65, 210]],
              [[ 67, 210]],
              [[ 68, 209]],
              [[ 71, 209]],
              [[ 72, 208]],
              [[ 83, 208]],
              [[ 84, 207]],
              [[ 85, 207]],
              [[ 85, 205]],
              [[ 86, 204]],
              [[ 86, 202]],
              [[ 85, 201]],
              [[ 85, 200]],
              [[ 84, 199]],
              [[ 83, 199]],
              [[ 70, 186]],
              [[ 70, 185]],
              [[ 68, 183]],
              [[ 68, 182]],
              [[ 67, 181]],
              [[ 67, 180]],
              [[ 65, 178]],
              [[ 65, 177]],
              [[ 64, 176]],
              [[ 64, 175]],
              [[ 63, 174]],
              [[ 63, 173]],
              [[ 62, 172]],
              [[ 62, 170]],
              [[ 60, 168]],
              [[ 60, 163]],
              [[ 59, 162]],
              [[ 59, 160]],
              [[ 60, 159]],
              [[ 60, 158]],
              [[ 59, 157]],
              [[ 59, 155]],
              [[ 58, 154]],
              [[ 57, 154]],
              [[ 54, 151]]], 
              dtype=np.int32
       ),
       np.array([[[ 39, 116]],
              [[ 38, 117]],
              [[ 36, 117]],
              [[ 35, 118]],
              [[ 34, 118]],
              [[ 33, 119]],
              [[ 29, 119]],
              [[ 28, 118]],
              [[ 24, 118]],
              [[ 22, 120]],
              [[ 22, 125]],
              [[ 24, 127]],
              [[ 24, 128]],
              [[ 25, 129]],
              [[ 25, 134]],
              [[ 26, 135]],
              [[ 26, 136]],
              [[ 27, 137]],
              [[ 27, 142]],
              [[ 28, 143]],
              [[ 28, 151]],
              [[ 29, 152]],
              [[ 29, 153]],
              [[ 37, 153]],
              [[ 38, 152]],
              [[ 43, 152]],
              [[ 44, 151]],
              [[ 45, 151]],
              [[ 46, 150]],
              [[ 47, 150]],
              [[ 48, 149]],
              [[ 53, 149]],
              [[ 54, 148]],
              [[ 55, 148]],
              [[ 55, 145]],
              [[ 50, 140]],
              [[ 50, 139]],
              [[ 47, 136]],
              [[ 47, 135]],
              [[ 45, 133]],
              [[ 45, 132]],
              [[ 44, 131]],
              [[ 44, 124]],
              [[ 45, 123]],
              [[ 45, 121]],
              [[ 46, 120]],
              [[ 42, 116]]],
              dtype=np.int32
       ),
       np.array([[[ 27,  85]],
              [[ 26,  86]],
              [[ 23,  86]],
              [[ 21,  88]],
              [[ 21,  91]],
              [[ 22,  92]],
              [[ 22,  93]],
              [[ 23,  94]],
              [[ 23,  96]],
              [[ 24,  97]],
              [[ 24, 100]],
              [[ 25, 101]],
              [[ 25, 102]],
              [[ 24, 103]],
              [[ 24, 106]],
              [[ 23, 107]],
              [[ 23, 108]],
              [[ 22, 109]],
              [[ 22, 110]],
              [[ 21, 111]],
              [[ 21, 115]],
              [[ 22, 116]],
              [[ 33, 116]],
              [[ 34, 115]],
              [[ 37, 115]],
              [[ 38, 114]],
              [[ 41, 114]],
              [[ 42, 113]],
              [[ 43, 113]],
              [[ 42, 112]],
              [[ 42, 111]],
              [[ 43, 110]],
              [[ 42, 109]],
              [[ 41, 109]],
              [[ 36, 104]],
              [[ 36, 103]],
              [[ 34, 101]],
              [[ 34,  98]],
              [[ 33,  97]],
              [[ 33,  94]],
              [[ 34,  93]],
              [[ 34,  87]],
              [[ 33,  86]],
              [[ 30,  86]],
              [[ 29,  85]]], 
              dtype=np.int32
       ),
       np.array( [[[ 98,  35]],
              [[ 97,  36]],
              [[ 96,  36]],
              [[ 94,  38]],
              [[ 94,  39]],
              [[ 93,  40]],
              [[ 93,  42]],
              [[ 94,  43]],
              [[ 94,  44]],
              [[ 95,  45]],
              [[ 95,  47]],
              [[ 96,  48]],
              [[ 96,  50]],
              [[ 95,  51]],
              [[ 95,  54]],
              [[ 94,  55]],
              [[ 94,  56]],
              [[ 93,  57]],
              [[ 93,  58]],
              [[ 88,  63]],
              [[ 88,  67]],
              [[ 90,  67]],
              [[ 91,  68]],
              [[ 98,  68]],
              [[ 99,  69]],
              [[104,  69]],
              [[105,  68]],
              [[111,  68]],
              [[112,  67]],
              [[115,  67]],
              [[115,  63]],
              [[110,  58]],
              [[110,  57]],
              [[109,  56]],
              [[109,  55]],
              [[108,  54]],
              [[108,  50]],
              [[109,  49]],
              [[109,  46]],
              [[110,  45]],
              [[110,  44]],
              [[111,  43]],
              [[111,  41]],
              [[110,  40]],
              [[110,  37]],
              [[109,  37]],
              [[108,  36]],
              [[106,  36]],
              [[105,  35]]], 
              dtype=np.int32
       )
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      120,
      140,
    )
    assert len(complete_contours) == 1

    found_contours = complete_contours[0]['contours_committed']

    assert len(found_contours) == 4

    ideal_distal_phalanx = contours[2]
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx) or
           np.array_equal(found_contours[1], ideal_distal_phalanx) or
           np.array_equal(found_contours[2], ideal_distal_phalanx) or
           np.array_equal(found_contours[3], ideal_distal_phalanx))
  
    ideal_medial_phalanx = contours[1]
    assert (np.array_equal(found_contours[0], ideal_medial_phalanx) or
           np.array_equal(found_contours[1], ideal_medial_phalanx) or 
           np.array_equal(found_contours[2], ideal_medial_phalanx) or
           np.array_equal(found_contours[3], ideal_medial_phalanx))
  
    ideal_distal_phalanx_two = contours[3]
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[1], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[2], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[3], ideal_distal_phalanx_two))
  
    ideal_proximal_phalanx = contours[0]
    assert (np.array_equal(found_contours[0], ideal_proximal_phalanx) or
           np.array_equal(found_contours[1], ideal_proximal_phalanx) or 
           np.array_equal(found_contours[2], ideal_proximal_phalanx) or
           np.array_equal(found_contours[3], ideal_proximal_phalanx))


  def test_ideal_finger_jump_with_added_metacarpal(self):
    expected_contours = [
      ExpectedContourDistalPhalanx(1),
      ExpectedContourMedialPhalanx(1),
      ExpectedContourProximalPhalanx(1)
    ]
    expected_contours.append(
      ExpectedContourMetacarpal(
        1,
        ends_branchs_sequence=True,
        first_in_branch=expected_contours[0]
      )
    )
    expected_contours.append(
      ExpectedContourDistalPhalanx(
        2,
        previous_encounter=expected_contours[0]
      )
    )
    contours = [
       np.array([[[ 73, 211]],
       [[ 72, 212]],
       [[ 68, 212]],
       [[ 67, 213]],
       [[ 65, 213]],
       [[ 64, 214]],
       [[ 63, 214]],
       [[ 62, 215]],
       [[ 61, 215]],
       [[ 59, 217]],
       [[ 59, 218]],
       [[ 58, 219]],
       [[ 58, 220]],
       [[ 59, 221]],
       [[ 59, 225]],
       [[ 58, 226]],
       [[ 58, 229]],
       [[ 62, 233]],
       [[ 62, 234]],
       [[ 65, 237]],
       [[ 65, 238]],
       [[ 67, 240]],
       [[ 67, 241]],
       [[ 70, 244]],
       [[ 70, 245]],
       [[ 72, 247]],
       [[ 72, 248]],
       [[ 73, 249]],
       [[ 73, 250]],
       [[ 74, 251]],
       [[ 74, 252]],
       [[ 75, 253]],
       [[ 75, 254]],
       [[ 77, 256]],
       [[ 77, 257]],
       [[ 78, 258]],
       [[ 78, 259]],
       [[ 79, 260]],
       [[ 79, 261]],
       [[ 80, 262]],
       [[ 80, 263]],
       [[ 81, 264]],
       [[ 81, 265]],
       [[ 82, 266]],
       [[ 82, 267]],
       [[ 83, 268]],
       [[ 83, 269]],
       [[ 84, 270]],
       [[ 84, 271]],
       [[ 85, 272]],
       [[ 85, 273]],
       [[ 86, 274]],
       [[ 86, 276]],
       [[ 87, 277]],
       [[ 87, 280]],
       [[ 88, 281]],
       [[ 88, 285]],
       [[ 89, 286]],
       [[ 89, 295]],
       [[ 90, 296]],
       [[ 90, 298]],
       [[ 91, 299]],
       [[ 91, 300]],
       [[ 94, 303]],
       [[ 96, 303]],
       [[ 97, 304]],
       [[100, 304]],
       [[101, 305]],
       [[103, 305]],
       [[104, 304]],
       [[105, 304]],
       [[106, 303]],
       [[106, 302]],
       [[108, 300]],
       [[108, 299]],
       [[110, 297]],
       [[110, 296]],
       [[113, 293]],
       [[113, 292]],
       [[115, 290]],
       [[115, 289]],
       [[117, 287]],
       [[117, 286]],
       [[118, 285]],
       [[116, 283]],
       [[116, 282]],
       [[115, 282]],
       [[106, 273]],
       [[106, 272]],
       [[104, 270]],
       [[104, 269]],
       [[102, 267]],
       [[102, 266]],
       [[100, 264]],
       [[100, 263]],
       [[ 99, 262]],
       [[ 99, 261]],
       [[ 98, 260]],
       [[ 98, 259]],
       [[ 97, 258]],
       [[ 97, 257]],
       [[ 96, 256]],
       [[ 96, 255]],
       [[ 95, 254]],
       [[ 95, 253]],
       [[ 94, 252]],
       [[ 94, 250]],
       [[ 93, 249]],
       [[ 93, 248]],
       [[ 92, 247]],
       [[ 92, 246]],
       [[ 91, 245]],
       [[ 91, 243]],
       [[ 90, 242]],
       [[ 90, 240]],
       [[ 89, 239]],
       [[ 89, 237]],
       [[ 88, 236]],
       [[ 88, 227]],
       [[ 87, 226]],
       [[ 87, 223]],
       [[ 86, 222]],
       [[ 86, 220]],
       [[ 78, 212]],
       [[ 76, 212]],
       [[ 75, 211]]], 
       dtype=np.int32),
    np.array([[[ 53, 151]],
       [[ 51, 153]],
       [[ 49, 153]],
       [[ 48, 154]],
       [[ 46, 154]],
       [[ 45, 155]],
       [[ 37, 155]],
       [[ 36, 156]],
       [[ 35, 156]],
       [[ 35, 164]],
       [[ 38, 167]],
       [[ 38, 168]],
       [[ 40, 170]],
       [[ 40, 171]],
       [[ 42, 173]],
       [[ 42, 174]],
       [[ 43, 175]],
       [[ 43, 177]],
       [[ 44, 178]],
       [[ 44, 180]],
       [[ 45, 181]],
       [[ 45, 183]],
       [[ 46, 184]],
       [[ 46, 185]],
       [[ 47, 186]],
       [[ 47, 187]],
       [[ 48, 188]],
       [[ 48, 191]],
       [[ 49, 192]],
       [[ 49, 195]],
       [[ 50, 196]],
       [[ 50, 203]],
       [[ 49, 204]],
       [[ 49, 211]],
       [[ 51, 213]],
       [[ 59, 213]],
       [[ 60, 212]],
       [[ 61, 212]],
       [[ 62, 211]],
       [[ 64, 211]],
       [[ 65, 210]],
       [[ 67, 210]],
       [[ 68, 209]],
       [[ 71, 209]],
       [[ 72, 208]],
       [[ 83, 208]],
       [[ 84, 207]],
       [[ 85, 207]],
       [[ 85, 205]],
       [[ 86, 204]],
       [[ 86, 202]],
       [[ 85, 201]],
       [[ 85, 200]],
       [[ 84, 199]],
       [[ 83, 199]],
       [[ 70, 186]],
       [[ 70, 185]],
       [[ 68, 183]],
       [[ 68, 182]],
       [[ 67, 181]],
       [[ 67, 180]],
       [[ 65, 178]],
       [[ 65, 177]],
       [[ 64, 176]],
       [[ 64, 175]],
       [[ 63, 174]],
       [[ 63, 173]],
       [[ 62, 172]],
       [[ 62, 170]],
       [[ 60, 168]],
       [[ 60, 163]],
       [[ 59, 162]],
       [[ 59, 160]],
       [[ 60, 159]],
       [[ 60, 158]],
       [[ 59, 157]],
       [[ 59, 155]],
       [[ 58, 154]],
       [[ 57, 154]],
       [[ 54, 151]]], 
       dtype=np.int32),
    np.array([[[ 39, 116]],
       [[ 38, 117]],
       [[ 36, 117]],
       [[ 35, 118]],
       [[ 34, 118]],
       [[ 33, 119]],
       [[ 29, 119]],
       [[ 28, 118]],
       [[ 24, 118]],
       [[ 22, 120]],
       [[ 22, 125]],
       [[ 24, 127]],
       [[ 24, 128]],
       [[ 25, 129]],
       [[ 25, 134]],
       [[ 26, 135]],
       [[ 26, 136]],
       [[ 27, 137]],
       [[ 27, 142]],
       [[ 28, 143]],
       [[ 28, 151]],
       [[ 29, 152]],
       [[ 29, 153]],
       [[ 37, 153]],
       [[ 38, 152]],
       [[ 43, 152]],
       [[ 44, 151]],
       [[ 45, 151]],
       [[ 46, 150]],
       [[ 47, 150]],
       [[ 48, 149]],
       [[ 53, 149]],
       [[ 54, 148]],
       [[ 55, 148]],
       [[ 55, 145]],
       [[ 50, 140]],
       [[ 50, 139]],
       [[ 47, 136]],
       [[ 47, 135]],
       [[ 45, 133]],
       [[ 45, 132]],
       [[ 44, 131]],
       [[ 44, 124]],
       [[ 45, 123]],
       [[ 45, 121]],
       [[ 46, 120]],
       [[ 42, 116]]], 
       dtype=np.int32),
    np.array([[[ 27,  85]],
       [[ 26,  86]],
       [[ 23,  86]],
       [[ 21,  88]],
       [[ 21,  91]],
       [[ 22,  92]],
       [[ 22,  93]],
       [[ 23,  94]],
       [[ 23,  96]],
       [[ 24,  97]],
       [[ 24, 100]],
       [[ 25, 101]],
       [[ 25, 102]],
       [[ 24, 103]],
       [[ 24, 106]],
       [[ 23, 107]],
       [[ 23, 108]],
       [[ 22, 109]],
       [[ 22, 110]],
       [[ 21, 111]],
       [[ 21, 115]],
       [[ 22, 116]],
       [[ 33, 116]],
       [[ 34, 115]],
       [[ 37, 115]],
       [[ 38, 114]],
       [[ 41, 114]],
       [[ 42, 113]],
       [[ 43, 113]],
       [[ 42, 112]],
       [[ 42, 111]],
       [[ 43, 110]],
       [[ 42, 109]],
       [[ 41, 109]],
       [[ 36, 104]],
       [[ 36, 103]],
       [[ 34, 101]],
       [[ 34,  98]],
       [[ 33,  97]],
       [[ 33,  94]],
       [[ 34,  93]],
       [[ 34,  87]],
       [[ 33,  86]],
       [[ 30,  86]],
       [[ 29,  85]]], 
       dtype=np.int32),
    np.array([[[ 98,  35]],
       [[ 97,  36]],
       [[ 96,  36]],
       [[ 94,  38]],
       [[ 94,  39]],
       [[ 93,  40]],
       [[ 93,  42]],
       [[ 94,  43]],
       [[ 94,  44]],
       [[ 95,  45]],
       [[ 95,  47]],
       [[ 96,  48]],
       [[ 96,  50]],
       [[ 95,  51]],
       [[ 95,  54]],
       [[ 94,  55]],
       [[ 94,  56]],
       [[ 93,  57]],
       [[ 93,  58]],
       [[ 88,  63]],
       [[ 88,  67]],
       [[ 90,  67]],
       [[ 91,  68]],
       [[ 99,  68]],
       [[100,  69]],
       [[104,  69]],
       [[105,  68]],
       [[111,  68]],
       [[112,  67]],
       [[115,  67]],
       [[115,  63]],
       [[110,  58]],
       [[110,  57]],
       [[109,  56]],
       [[109,  55]],
       [[108,  54]],
       [[108,  50]],
       [[109,  49]],
       [[109,  46]],
       [[110,  45]],
       [[110,  44]],
       [[111,  43]],
       [[111,  41]],
       [[110,  40]],
       [[110,  37]],
       [[109,  37]],
       [[108,  36]],
       [[106,  36]],
       [[105,  35]]], 
       dtype=np.int32)
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      120,
      140,
    )
    assert len(complete_contours) == 1

    found_contours = complete_contours[0]['contours_committed']

    assert len(found_contours) == 5

    ideal_distal_phalanx = contours[3]
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx) or
           np.array_equal(found_contours[1], ideal_distal_phalanx) or
           np.array_equal(found_contours[2], ideal_distal_phalanx) or
           np.array_equal(found_contours[3], ideal_distal_phalanx) or
           np.array_equal(found_contours[4], ideal_distal_phalanx))
  
    ideal_medial_phalanx = contours[2]
    assert (np.array_equal(found_contours[0], ideal_medial_phalanx) or
           np.array_equal(found_contours[1], ideal_medial_phalanx) or 
           np.array_equal(found_contours[2], ideal_medial_phalanx) or
           np.array_equal(found_contours[3], ideal_medial_phalanx) or
           np.array_equal(found_contours[4], ideal_medial_phalanx))
  
    ideal_distal_phalanx_two = contours[4]
    assert (np.array_equal(found_contours[0], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[1], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[2], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[3], ideal_distal_phalanx_two) or
            np.array_equal(found_contours[4], ideal_distal_phalanx_two))
  
    ideal_proximal_phalanx = contours[1]
    assert (np.array_equal(found_contours[0], ideal_proximal_phalanx) or
           np.array_equal(found_contours[1], ideal_proximal_phalanx) or 
           np.array_equal(found_contours[2], ideal_proximal_phalanx) or
           np.array_equal(found_contours[3], ideal_proximal_phalanx) or
           np.array_equal(found_contours[4], ideal_proximal_phalanx))

    ideal_metacarpal = contours[0]
    assert (np.array_equal(found_contours[0], ideal_metacarpal) or
        np.array_equal(found_contours[1], ideal_metacarpal) or 
        np.array_equal(found_contours[2], ideal_metacarpal) or
        np.array_equal(found_contours[3], ideal_metacarpal) or
        np.array_equal(found_contours[4], ideal_metacarpal))

  def test_complete_ideal_fingers(self):
    expected_contours = np.empty(21, dtype=object)
    expected_contours[0] = ExpectedContourDistalPhalanx(1)
    expected_contours[1] = ExpectedContourMedialPhalanx(1)
    expected_contours[2] = ExpectedContourProximalPhalanx(1)
    expected_contours[3] = ExpectedContourMetacarpal(
      1,
      ends_branchs_sequence=True,
      first_in_branch=expected_contours[0]
    )
    expected_contours[4] = ExpectedContourDistalPhalanx(
      2,
      previous_encounter=expected_contours[0]
    )
    expected_contours[5] = ExpectedContourMedialPhalanx(
      2,
      previous_encounter=expected_contours[1]
    )
    expected_contours[6] = ExpectedContourProximalPhalanx(
      2,
      previous_encounter=expected_contours[2]
    )
    expected_contours[7] = ExpectedContourMetacarpal(
      2,
      ends_branchs_sequence=True,
      first_in_branch=expected_contours[4],
      previous_encounter=expected_contours[3]
    )
    expected_contours[8] = ExpectedContourDistalPhalanx(
      3,
      previous_encounter=expected_contours[0]
    )
    expected_contours[9] = ExpectedContourMedialPhalanx(
      3,
      previous_encounter=expected_contours[1]
    )
    expected_contours[10] = ExpectedContourProximalPhalanx(
      3,
      previous_encounter=expected_contours[2]
    )
    expected_contours[11] = ExpectedContourMetacarpal(
      3,
      ends_branchs_sequence=True,
      first_in_branch=expected_contours[8],
      previous_encounter=expected_contours[3]
    )
    expected_contours[12] = ExpectedContourDistalPhalanx(
      4,
      previous_encounter=expected_contours[0]
    )
    expected_contours[13] = ExpectedContourMedialPhalanx(
      4,
      previous_encounter=expected_contours[1]
    )
    expected_contours[14] = ExpectedContourProximalPhalanx(
      4,
      previous_encounter=expected_contours[2]
    )
    expected_contours[15] = ExpectedContourMetacarpal(
      4,
      ends_branchs_sequence=True,
      first_in_branch=expected_contours[12],
      previous_encounter=expected_contours[3]
    )
    expected_contours[16] = ExpectedContourDistalPhalanx(
      5,
      previous_encounter=expected_contours[0]
    )
    expected_contours[17] = ExpectedContourProximalPhalanx(
      5,
      previous_encounter=expected_contours[2]
    )
    expected_contours[18] = ExpectedContourMetacarpal(
      5,
      previous_encounter=expected_contours[3]
    )
    expected_contours[19] = ExpectedContourUlna()
    expected_contours[20] = ExpectedContourRadius()

    contours = [
      np.array([[[317, 252]],
      [[316, 253]],
      [[314, 253]],
      [[313, 254]],
      [[309, 254]],
      [[309, 255]],
      [[306, 258]],
      [[305, 258]],
      [[303, 260]],
      [[303, 261]],
      [[301, 263]],
      [[299, 263]],
      [[298, 264]],
      [[298, 265]],
      [[292, 271]],
      [[291, 271]],
      [[287, 275]],
      [[286, 275]],
      [[284, 277]],
      [[283, 277]],
      [[280, 280]],
      [[279, 280]],
      [[277, 282]],
      [[276, 282]],
      [[275, 283]],
      [[274, 283]],
      [[273, 284]],
      [[272, 284]],
      [[271, 285]],
      [[270, 285]],
      [[268, 287]],
      [[266, 287]],
      [[265, 288]],
      [[264, 288]],
      [[263, 289]],
      [[261, 289]],
      [[260, 290]],
      [[257, 290]],
      [[256, 291]],
      [[253, 291]],
      [[252, 292]],
      [[247, 292]],
      [[246, 293]],
      [[243, 293]],
      [[242, 294]],
      [[240, 294]],
      [[239, 295]],
      [[236, 295]],
      [[235, 296]],
      [[233, 296]],
      [[230, 299]],
      [[230, 303]],
      [[232, 305]],
      [[232, 306]],
      [[235, 309]],
      [[236, 309]],
      [[238, 311]],
      [[238, 315]],
      [[239, 316]],
      [[240, 316]],
      [[242, 318]],
      [[243, 318]],
      [[244, 319]],
      [[250, 319]],
      [[251, 320]],
      [[253, 320]],
      [[254, 319]],
      [[256, 319]],
      [[257, 318]],
      [[258, 318]],
      [[259, 317]],
      [[260, 317]],
      [[261, 316]],
      [[263, 316]],
      [[265, 314]],
      [[266, 314]],
      [[267, 313]],
      [[268, 313]],
      [[271, 310]],
      [[272, 310]],
      [[277, 305]],
      [[278, 305]],
      [[280, 303]],
      [[281, 303]],
      [[283, 301]],
      [[284, 301]],
      [[286, 299]],
      [[287, 299]],
      [[289, 297]],
      [[290, 297]],
      [[292, 295]],
      [[293, 295]],
      [[294, 294]],
      [[295, 294]],
      [[296, 293]],
      [[297, 293]],
      [[299, 291]],
      [[300, 291]],
      [[301, 290]],
      [[302, 290]],
      [[304, 288]],
      [[305, 288]],
      [[306, 287]],
      [[307, 287]],
      [[308, 286]],
      [[309, 286]],
      [[311, 284]],
      [[312, 284]],
      [[314, 282]],
      [[315, 282]],
      [[316, 281]],
      [[317, 281]],
      [[318, 280]],
      [[319, 280]],
      [[321, 278]],
      [[323, 278]],
      [[324, 277]],
      [[325, 277]],
      [[326, 276]],
      [[327, 276]],
      [[328, 275]],
      [[329, 275]],
      [[331, 273]],
      [[332, 273]],
      [[332, 272]],
      [[334, 270]],
      [[334, 269]],
      [[335, 268]],
      [[335, 264]],
      [[334, 263]],
      [[334, 262]],
      [[332, 260]],
      [[331, 260]],
      [[328, 257]],
      [[327, 257]],
      [[326, 256]],
      [[325, 256]],
      [[324, 255]],
      [[323, 255]],
      [[321, 253]],
      [[320, 253]],
      [[319, 252]]]),
      np.array([[[73, 211]],
      [[ 72, 212]],
      [[ 68, 212]],
      [[ 67, 213]],
      [[ 65, 213]],
      [[ 64, 214]],
      [[ 63, 214]],
      [[ 62, 215]],
      [[ 61, 215]],
      [[ 59, 217]],
      [[ 59, 218]],
      [[ 58, 219]],
      [[ 58, 220]],
      [[ 59, 221]],
      [[ 59, 225]],
      [[ 58, 226]],
      [[ 58, 229]],
      [[ 62, 233]],
      [[ 62, 234]],
      [[ 65, 237]],
      [[ 65, 238]],
      [[ 67, 240]],
      [[ 67, 241]],
      [[ 70, 244]],
      [[ 70, 245]],
      [[ 72, 247]],
      [[ 72, 248]],
      [[ 73, 249]],
      [[ 73, 250]],
      [[ 74, 251]],
      [[ 74, 252]],
      [[ 75, 253]],
      [[ 75, 254]],
      [[ 77, 256]],
      [[ 77, 257]],
      [[ 78, 258]],
      [[ 78, 259]],
      [[ 79, 260]],
      [[ 79, 261]],
      [[ 80, 262]],
      [[ 80, 263]],
      [[ 81, 264]],
      [[ 81, 265]],
      [[ 82, 266]],
      [[ 82, 267]],
      [[ 83, 268]],
      [[ 83, 269]],
      [[ 84, 270]],
      [[ 84, 271]],
      [[ 85, 272]],
      [[ 85, 273]],
      [[ 86, 274]],
      [[ 86, 276]],
      [[ 87, 277]],
      [[ 87, 280]],
      [[ 88, 281]],
      [[ 88, 285]],
      [[ 89, 286]],
      [[ 89, 295]],
      [[ 90, 296]],
      [[ 90, 298]],
      [[ 91, 299]],
      [[ 91, 300]],
      [[ 94, 303]],
      [[ 96, 303]],
      [[ 97, 304]],
      [[100, 304]],
      [[101, 305]],
      [[103, 305]],
      [[104, 304]],
      [[105, 304]],
      [[106, 303]],
      [[106, 302]],
      [[108, 300]],
      [[108, 299]],
      [[110, 297]],
      [[110, 296]],
      [[113, 293]],
      [[113, 292]],
      [[115, 290]],
      [[115, 289]],
      [[117, 287]],
      [[117, 286]],
      [[118, 285]],
      [[116, 283]],
      [[116, 282]],
      [[115, 282]],
      [[106, 273]],
      [[106, 272]],
      [[104, 270]],
      [[104, 269]],
      [[102, 267]],
      [[102, 266]],
      [[100, 264]],
      [[100, 263]],
      [[ 99, 262]],
      [[ 99, 261]],
      [[ 98, 260]],
      [[ 98, 259]],
      [[ 97, 258]],
      [[ 97, 257]],
      [[ 96, 256]],
      [[ 96, 255]],
      [[ 95, 254]],
      [[ 95, 253]],
      [[ 94, 252]],
      [[ 94, 250]],
      [[ 93, 249]],
      [[ 93, 248]],
      [[ 92, 247]],
      [[ 92, 246]],
      [[ 91, 245]],
      [[ 91, 243]],
      [[ 90, 242]],
      [[ 90, 240]],
      [[ 89, 239]],
      [[ 89, 237]],
      [[ 88, 236]],
      [[ 88, 227]],
      [[ 87, 226]],
      [[ 87, 223]],
      [[ 86, 222]],
      [[ 86, 220]],
      [[ 78, 212]],
      [[ 76, 212]],
      [[ 75, 211]]]),
      np.array(
      [[[356, 201]],
      [[355, 202]],
      [[350, 202]],
      [[349, 203]],
      [[348, 203]],
      [[347, 204]],
      [[346, 204]],
      [[345, 205]],
      [[344, 205]],
      [[343, 206]],
      [[343, 210]],
      [[344, 211]],
      [[344, 215]],
      [[343, 216]],
      [[343, 217]],
      [[341, 219]],
      [[341, 220]],
      [[335, 226]],
      [[334, 226]],
      [[331, 229]],
      [[330, 229]],
      [[328, 231]],
      [[327, 231]],
      [[326, 232]],
      [[325, 232]],
      [[324, 233]],
      [[323, 233]],
      [[322, 234]],
      [[321, 234]],
      [[320, 235]],
      [[319, 235]],
      [[318, 236]],
      [[317, 236]],
      [[316, 237]],
      [[315, 237]],
      [[314, 238]],
      [[312, 238]],
      [[311, 239]],
      [[310, 239]],
      [[307, 242]],
      [[307, 247]],
      [[309, 249]],
      [[316, 249]],
      [[317, 250]],
      [[320, 250]],
      [[321, 251]],
      [[322, 251]],
      [[323, 252]],
      [[324, 252]],
      [[325, 253]],
      [[327, 253]],
      [[328, 254]],
      [[329, 254]],
      [[332, 257]],
      [[332, 258]],
      [[335, 258]],
      [[336, 259]],
      [[339, 259]],
      [[340, 258]],
      [[343, 258]],
      [[344, 257]],
      [[344, 255]],
      [[345, 254]],
      [[345, 252]],
      [[346, 251]],
      [[346, 250]],
      [[347, 249]],
      [[347, 247]],
      [[348, 246]],
      [[348, 245]],
      [[349, 244]],
      [[349, 243]],
      [[351, 241]],
      [[351, 240]],
      [[354, 237]],
      [[354, 236]],
      [[359, 231]],
      [[359, 230]],
      [[367, 222]],
      [[368, 222]],
      [[374, 216]],
      [[374, 215]],
      [[376, 213]],
      [[373, 210]],
      [[372, 210]],
      [[371, 209]],
      [[370, 209]],
      [[367, 206]],
      [[366, 206]],
      [[363, 203]],
      [[362, 203]],
      [[361, 202]],
      [[360, 202]],
      [[359, 201]]]),
      np.array(
      [[[116, 196]],
      [[115, 197]],
      [[110, 197]],
      [[109, 198]],
      [[106, 198]],
      [[105, 199]],
      [[104, 199]],
      [[102, 201]],
      [[102, 204]],
      [[103, 205]],
      [[103, 212]],
      [[104, 213]],
      [[104, 214]],
      [[107, 217]],
      [[107, 218]],
      [[109, 220]],
      [[109, 221]],
      [[110, 222]],
      [[110, 224]],
      [[111, 225]],
      [[111, 226]],
      [[112, 227]],
      [[112, 229]],
      [[113, 230]],
      [[113, 232]],
      [[114, 233]],
      [[114, 235]],
      [[115, 236]],
      [[115, 238]],
      [[116, 239]],
      [[116, 240]],
      [[117, 241]],
      [[117, 243]],
      [[118, 244]],
      [[118, 247]],
      [[119, 248]],
      [[119, 250]],
      [[120, 251]],
      [[120, 253]],
      [[121, 254]],
      [[121, 257]],
      [[122, 258]],
      [[122, 260]],
      [[123, 261]],
      [[123, 264]],
      [[124, 265]],
      [[124, 269]],
      [[125, 270]],
      [[125, 274]],
      [[124, 275]],
      [[124, 279]],
      [[123, 280]],
      [[123, 282]],
      [[124, 282]],
      [[125, 283]],
      [[126, 283]],
      [[127, 284]],
      [[128, 284]],
      [[129, 285]],
      [[131, 285]],
      [[132, 286]],
      [[133, 286]],
      [[134, 287]],
      [[135, 287]],
      [[136, 288]],
      [[138, 288]],
      [[139, 289]],
      [[140, 289]],
      [[141, 290]],
      [[143, 290]],
      [[144, 291]],
      [[145, 291]],
      [[146, 292]],
      [[147, 292]],
      [[148, 293]],
      [[149, 293]],
      [[149, 282]],
      [[148, 281]],
      [[148, 279]],
      [[147, 278]],
      [[147, 277]],
      [[146, 276]],
      [[146, 275]],
      [[143, 272]],
      [[143, 271]],
      [[141, 269]],
      [[141, 268]],
      [[140, 267]],
      [[140, 266]],
      [[139, 265]],
      [[139, 263]],
      [[138, 262]],
      [[138, 261]],
      [[137, 260]],
      [[137, 258]],
      [[136, 257]],
      [[136, 255]],
      [[135, 254]],
      [[135, 250]],
      [[134, 249]],
      [[134, 246]],
      [[133, 245]],
      [[133, 240]],
      [[132, 239]],
      [[132, 231]],
      [[131, 230]],
      [[131, 229]],
      [[132, 228]],
      [[132, 226]],
      [[131, 225]],
      [[131, 223]],
      [[132, 222]],
      [[132, 218]],
      [[133, 217]],
      [[133, 215]],
      [[134, 214]],
      [[134, 210]],
      [[133, 209]],
      [[133, 206]],
      [[131, 204]],
      [[131, 203]],
      [[129, 201]],
      [[129, 200]],
      [[128, 199]],
      [[128, 198]],
      [[127, 197]],
      [[124, 197]],
      [[123, 196]],
      [[122, 196]],
      [[121, 197]],
      [[120, 196]],
      [[118, 196]],
      [[117, 197]]]),
      np.array(
      [[[156, 177]],
      [[155, 178]],
      [[151, 178]],
      [[150, 179]],
      [[149, 179]],
      [[147, 181]],
      [[147, 183]],
      [[146, 184]],
      [[146, 187]],
      [[145, 188]],
      [[145, 196]],
      [[147, 198]],
      [[147, 200]],
      [[148, 201]],
      [[148, 202]],
      [[149, 203]],
      [[149, 205]],
      [[150, 206]],
      [[150, 208]],
      [[151, 209]],
      [[151, 212]],
      [[152, 213]],
      [[152, 216]],
      [[153, 217]],
      [[153, 221]],
      [[154, 222]],
      [[154, 226]],
      [[155, 227]],
      [[155, 232]],
      [[156, 233]],
      [[156, 240]],
      [[157, 241]],
      [[157, 267]],
      [[156, 268]],
      [[156, 272]],
      [[155, 273]],
      [[155, 276]],
      [[154, 277]],
      [[154, 284]],
      [[153, 285]],
      [[153, 292]],
      [[152, 293]],
      [[152, 294]],
      [[153, 294]],
      [[154, 293]],
      [[155, 293]],
      [[156, 292]],
      [[157, 292]],
      [[158, 291]],
      [[159, 291]],
      [[160, 290]],
      [[161, 290]],
      [[162, 289]],
      [[163, 289]],
      [[164, 288]],
      [[165, 288]],
      [[166, 287]],
      [[167, 287]],
      [[168, 286]],
      [[170, 286]],
      [[171, 285]],
      [[172, 285]],
      [[173, 284]],
      [[174, 284]],
      [[175, 283]],
      [[176, 283]],
      [[177, 282]],
      [[178, 282]],
      [[179, 281]],
      [[180, 281]],
      [[181, 280]],
      [[182, 280]],
      [[183, 279]],
      [[184, 279]],
      [[185, 278]],
      [[186, 278]],
      [[187, 277]],
      [[188, 277]],
      [[188, 276]],
      [[187, 275]],
      [[187, 274]],
      [[186, 273]],
      [[186, 272]],
      [[183, 269]],
      [[183, 268]],
      [[181, 266]],
      [[181, 265]],
      [[180, 264]],
      [[180, 263]],
      [[179, 262]],
      [[179, 258]],
      [[178, 257]],
      [[178, 254]],
      [[177, 253]],
      [[177, 244]],
      [[176, 243]],
      [[176, 217]],
      [[177, 216]],
      [[177, 210]],
      [[178, 209]],
      [[178, 207]],
      [[179, 206]],
      [[179, 204]],
      [[181, 202]],
      [[181, 199]],
      [[182, 198]],
      [[182, 197]],
      [[181, 196]],
      [[181, 195]],
      [[180, 194]],
      [[181, 193]],
      [[180, 192]],
      [[180, 190]],
      [[179, 189]],
      [[179, 188]],
      [[177, 186]],
      [[177, 185]],
      [[174, 182]],
      [[175, 181]],
      [[173, 179]],
      [[171, 179]],
      [[170, 178]],
      [[167, 178]],
      [[166, 177]]]),
      np.array(
      [[[220, 173]],
      [[219, 174]],
      [[214, 174]],
      [[213, 175]],
      [[212, 175]],
      [[211, 176]],
      [[211, 178]],
      [[210, 179]],
      [[210, 181]],
      [[208, 183]],
      [[208, 184]],
      [[207, 185]],
      [[207, 189]],
      [[208, 190]],
      [[208, 195]],
      [[207, 196]],
      [[207, 197]],
      [[208, 198]],
      [[208, 208]],
      [[209, 209]],
      [[209, 215]],
      [[210, 216]],
      [[210, 220]],
      [[209, 221]],
      [[209, 231]],
      [[208, 232]],
      [[208, 236]],
      [[207, 237]],
      [[207, 241]],
      [[206, 242]],
      [[206, 246]],
      [[205, 247]],
      [[205, 250]],
      [[204, 251]],
      [[204, 253]],
      [[203, 254]],
      [[203, 256]],
      [[202, 257]],
      [[202, 259]],
      [[201, 260]],
      [[201, 261]],
      [[200, 262]],
      [[200, 263]],
      [[199, 264]],
      [[199, 265]],
      [[198, 266]],
      [[198, 267]],
      [[197, 268]],
      [[197, 269]],
      [[196, 270]],
      [[196, 271]],
      [[195, 272]],
      [[195, 273]],
      [[191, 277]],
      [[191, 278]],
      [[190, 279]],
      [[189, 279]],
      [[186, 282]],
      [[186, 284]],
      [[185, 285]],
      [[187, 285]],
      [[188, 286]],
      [[191, 286]],
      [[192, 287]],
      [[196, 287]],
      [[197, 288]],
      [[200, 288]],
      [[201, 289]],
      [[204, 289]],
      [[205, 290]],
      [[209, 290]],
      [[210, 291]],
      [[213, 291]],
      [[214, 292]],
      [[218, 292]],
      [[219, 293]],
      [[222, 293]],
      [[223, 294]],
      [[225, 294]],
      [[225, 293]],
      [[226, 292]],
      [[226, 291]],
      [[227, 290]],
      [[227, 289]],
      [[228, 288]],
      [[228, 286]],
      [[227, 285]],
      [[227, 284]],
      [[226, 283]],
      [[226, 282]],
      [[225, 281]],
      [[225, 278]],
      [[224, 277]],
      [[224, 260]],
      [[225, 259]],
      [[225, 254]],
      [[226, 253]],
      [[226, 250]],
      [[227, 249]],
      [[227, 246]],
      [[228, 245]],
      [[228, 241]],
      [[229, 240]],
      [[229, 236]],
      [[230, 235]],
      [[230, 232]],
      [[231, 231]],
      [[231, 228]],
      [[232, 227]],
      [[232, 223]],
      [[233, 222]],
      [[233, 220]],
      [[234, 219]],
      [[234, 216]],
      [[235, 215]],
      [[235, 212]],
      [[236, 211]],
      [[236, 210]],
      [[237, 209]],
      [[237, 207]],
      [[238, 206]],
      [[238, 204]],
      [[239, 203]],
      [[239, 201]],
      [[241, 199]],
      [[241, 198]],
      [[242, 197]],
      [[242, 194]],
      [[243, 193]],
      [[243, 191]],
      [[242, 190]],
      [[242, 186]],
      [[241, 185]],
      [[241, 184]],
      [[240, 183]],
      [[240, 182]],
      [[235, 177]],
      [[234, 177]],
      [[232, 175]],
      [[229, 175]],
      [[228, 174]],
      [[224, 174]],
      [[223, 173]]]),
      np.array(
      [[[391, 172]],
      [[390, 173]],
      [[388, 173]],
      [[385, 176]],
      [[384, 176]],
      [[382, 178]],
      [[382, 179]],
      [[379, 182]],
      [[378, 182]],
      [[376, 184]],
      [[375, 184]],
      [[373, 186]],
      [[372, 186]],
      [[371, 187]],
      [[370, 187]],
      [[369, 188]],
      [[367, 188]],
      [[366, 189]],
      [[365, 189]],
      [[364, 190]],
      [[363, 190]],
      [[362, 191]],
      [[359, 191]],
      [[358, 192]],
      [[356, 192]],
      [[355, 193]],
      [[354, 193]],
      [[352, 195]],
      [[352, 196]],
      [[353, 197]],
      [[353, 198]],
      [[356, 198]],
      [[357, 199]],
      [[360, 199]],
      [[361, 200]],
      [[364, 200]],
      [[367, 203]],
      [[367, 204]],
      [[368, 204]],
      [[370, 206]],
      [[372, 206]],
      [[373, 207]],
      [[374, 207]],
      [[376, 209]],
      [[376, 210]],
      [[377, 209]],
      [[379, 209]],
      [[380, 208]],
      [[380, 206]],
      [[381, 205]],
      [[381, 203]],
      [[382, 202]],
      [[382, 200]],
      [[383, 199]],
      [[383, 198]],
      [[385, 196]],
      [[385, 195]],
      [[395, 185]],
      [[396, 185]],
      [[398, 183]],
      [[400, 183]],
      [[404, 179]],
      [[403, 179]],
      [[402, 178]],
      [[402, 175]],
      [[400, 173]],
      [[399, 173]],
      [[398, 172]],
      [[397, 173]],
      [[395, 173]],
      [[394, 172]]]),
      np.array(
      [[[ 53, 151]],
      [[ 51, 153]],
      [[ 49, 153]],
      [[ 48, 154]],
      [[ 46, 154]],
      [[ 45, 155]],
      [[ 37, 155]],
      [[ 36, 156]],
      [[ 35, 156]],
      [[ 35, 164]],
      [[ 38, 167]],
      [[ 38, 168]],
      [[ 40, 170]],
      [[ 40, 171]],
      [[ 42, 173]],
      [[ 42, 174]],
      [[ 43, 175]],
      [[ 43, 177]],
      [[ 44, 178]],
      [[ 44, 180]],
      [[ 45, 181]],
      [[ 45, 183]],
      [[ 46, 184]],
      [[ 46, 185]],
      [[ 47, 186]],
      [[ 47, 187]],
      [[ 48, 188]],
      [[ 48, 191]],
      [[ 49, 192]],
      [[ 49, 195]],
      [[ 50, 196]],
      [[ 50, 203]],
      [[ 49, 204]],
      [[ 49, 211]],
      [[ 51, 213]],
      [[ 59, 213]],
      [[ 60, 212]],
      [[ 61, 212]],
      [[ 62, 211]],
      [[ 64, 211]],
      [[ 65, 210]],
      [[ 67, 210]],
      [[ 68, 209]],
      [[ 71, 209]],
      [[ 72, 208]],
      [[ 83, 208]],
      [[ 84, 207]],
      [[ 85, 207]],
      [[ 85, 205]],
      [[ 86, 204]],
      [[ 86, 202]],
      [[ 85, 201]],
      [[ 85, 200]],
      [[ 84, 199]],
      [[ 83, 199]],
      [[ 70, 186]],
      [[ 70, 185]],
      [[ 68, 183]],
      [[ 68, 182]],
      [[ 67, 181]],
      [[ 67, 180]],
      [[ 65, 178]],
      [[ 65, 177]],
      [[ 64, 176]],
      [[ 64, 175]],
      [[ 63, 174]],
      [[ 63, 173]],
      [[ 62, 172]],
      [[ 62, 170]],
      [[ 60, 168]],
      [[ 60, 163]],
      [[ 59, 162]],
      [[ 59, 160]],
      [[ 60, 159]],
      [[ 60, 158]],
      [[ 59, 157]],
      [[ 59, 155]],
      [[ 58, 154]],
      [[ 57, 154]],
      [[ 54, 151]]]),
      np.array(
      [[[112, 121]],
      [[111, 122]],
      [[ 95, 122]],
      [[ 94, 123]],
      [[ 94, 125]],
      [[ 93, 126]],
      [[ 93, 129]],
      [[ 92, 130]],
      [[ 93, 131]],
      [[ 92, 132]],
      [[ 93, 133]],
      [[ 93, 134]],
      [[ 94, 135]],
      [[ 94, 136]],
      [[ 96, 138]],
      [[ 96, 142]],
      [[ 97, 143]],
      [[ 97, 148]],
      [[ 98, 149]],
      [[ 98, 152]],
      [[ 99, 153]],
      [[ 99, 155]],
      [[100, 156]],
      [[100, 158]],
      [[101, 159]],
      [[101, 162]],
      [[102, 163]],
      [[102, 179]],
      [[101, 180]],
      [[101, 182]],
      [[100, 183]],
      [[100, 187]],
      [[ 99, 188]],
      [[ 99, 190]],
      [[100, 191]],
      [[100, 193]],
      [[101, 194]],
      [[102, 194]],
      [[103, 195]],
      [[106, 195]],
      [[107, 194]],
      [[113, 194]],
      [[114, 193]],
      [[125, 193]],
      [[126, 194]],
      [[130, 194]],
      [[131, 193]],
      [[133, 193]],
      [[135, 191]],
      [[135, 187]],
      [[134, 186]],
      [[134, 184]],
      [[133, 183]],
      [[133, 182]],
      [[131, 180]],
      [[131, 179]],
      [[130, 178]],
      [[130, 177]],
      [[128, 175]],
      [[128, 174]],
      [[127, 173]],
      [[127, 172]],
      [[126, 171]],
      [[126, 169]],
      [[125, 168]],
      [[125, 165]],
      [[124, 164]],
      [[124, 154]],
      [[123, 153]],
      [[123, 143]],
      [[122, 142]],
      [[122, 139]],
      [[121, 138]],
      [[121, 132]],
      [[122, 131]],
      [[122, 129]],
      [[123, 128]],
      [[122, 127]],
      [[122, 126]],
      [[119, 123]],
      [[119, 122]],
      [[118, 121]]]),
      np.array(
      [[[ 39, 116]],
      [[ 38, 117]],
      [[ 36, 117]],
      [[ 35, 118]],
      [[ 34, 118]],
      [[ 33, 119]],
      [[ 29, 119]],
      [[ 28, 118]],
      [[ 24, 118]],
      [[ 22, 120]],
      [[ 22, 125]],
      [[ 24, 127]],
      [[ 24, 128]],
      [[ 25, 129]],
      [[ 25, 134]],
      [[ 26, 135]],
      [[ 26, 136]],
      [[ 27, 137]],
      [[ 27, 142]],
      [[ 28, 143]],
      [[ 28, 151]],
      [[ 29, 152]],
      [[ 29, 153]],
      [[ 37, 153]],
      [[ 38, 152]],
      [[ 43, 152]],
      [[ 44, 151]],
      [[ 45, 151]],
      [[ 46, 150]],
      [[ 47, 150]],
      [[ 48, 149]],
      [[ 53, 149]],
      [[ 54, 148]],
      [[ 55, 148]],
      [[ 55, 145]],
      [[ 50, 140]],
      [[ 50, 139]],
      [[ 47, 136]],
      [[ 47, 135]],
      [[ 45, 133]],
      [[ 45, 132]],
      [[ 44, 131]],
      [[ 44, 124]],
      [[ 45, 123]],
      [[ 45, 121]],
      [[ 46, 120]],
      [[ 42, 116]]]),
      np.array(
      [[[240,  99]],
      [[240, 100]],
      [[238, 102]],
      [[238, 103]],
      [[235, 106]],
      [[235, 108]],
      [[234, 109]],
      [[235, 110]],
      [[235, 115]],
      [[234, 116]],
      [[234, 119]],
      [[233, 120]],
      [[233, 122]],
      [[232, 123]],
      [[232, 124]],
      [[231, 125]],
      [[231, 127]],
      [[230, 128]],
      [[230, 130]],
      [[229, 131]],
      [[229, 133]],
      [[228, 134]],
      [[228, 135]],
      [[227, 136]],
      [[227, 138]],
      [[226, 139]],
      [[226, 140]],
      [[225, 141]],
      [[225, 142]],
      [[224, 143]],
      [[224, 144]],
      [[223, 145]],
      [[223, 146]],
      [[222, 147]],
      [[222, 148]],
      [[220, 150]],
      [[220, 151]],
      [[209, 162]],
      [[209, 163]],
      [[208, 164]],
      [[208, 169]],
      [[209, 170]],
      [[210, 170]],
      [[211, 171]],
      [[215, 171]],
      [[216, 170]],
      [[227, 170]],
      [[228, 171]],
      [[229, 171]],
      [[230, 172]],
      [[233, 172]],
      [[234, 173]],
      [[235, 173]],
      [[236, 174]],
      [[238, 174]],
      [[239, 175]],
      [[249, 175]],
      [[250, 174]],
      [[250, 173]],
      [[251, 172]],
      [[251, 171]],
      [[252, 170]],
      [[252, 169]],
      [[251, 168]],
      [[251, 164]],
      [[250, 163]],
      [[250, 148]],
      [[251, 147]],
      [[251, 144]],
      [[252, 143]],
      [[252, 141]],
      [[253, 140]],
      [[253, 138]],
      [[254, 137]],
      [[254, 135]],
      [[255, 134]],
      [[255, 131]],
      [[256, 130]],
      [[256, 127]],
      [[257, 126]],
      [[257, 125]],
      [[258, 124]],
      [[258, 122]],
      [[260, 120]],
      [[260, 119]],
      [[265, 114]],
      [[265, 107]],
      [[264, 106]],
      [[264, 104]],
      [[262, 102]],
      [[249, 102]],
      [[248, 101]],
      [[246, 101]],
      [[245, 100]],
      [[241, 100]]]),
      np.array(
      [[[160,  94]],
      [[159,  95]],
      [[159,  96]],
      [[158,  97]],
      [[158,  98]],
      [[156, 100]],
      [[156, 102]],
      [[155, 103]],
      [[156, 104]],
      [[156, 107]],
      [[157, 108]],
      [[157, 118]],
      [[156, 119]],
      [[156, 143]],
      [[155, 144]],
      [[155, 148]],
      [[154, 149]],
      [[154, 152]],
      [[153, 153]],
      [[153, 154]],
      [[152, 155]],
      [[152, 156]],
      [[151, 157]],
      [[151, 158]],
      [[150, 159]],
      [[150, 160]],
      [[148, 162]],
      [[148, 163]],
      [[147, 164]],
      [[147, 167]],
      [[146, 168]],
      [[146, 173]],
      [[147, 174]],
      [[149, 174]],
      [[150, 175]],
      [[152, 175]],
      [[153, 174]],
      [[162, 174]],
      [[163, 173]],
      [[164, 174]],
      [[169, 174]],
      [[170, 175]],
      [[172, 175]],
      [[173, 176]],
      [[176, 176]],
      [[177, 177]],
      [[182, 177]],
      [[183, 176]],
      [[185, 176]],
      [[186, 175]],
      [[187, 175]],
      [[188, 174]],
      [[188, 170]],
      [[187, 169]],
      [[187, 166]],
      [[186, 165]],
      [[186, 163]],
      [[185, 162]],
      [[185, 161]],
      [[184, 160]],
      [[184, 157]],
      [[183, 156]],
      [[183, 152]],
      [[182, 151]],
      [[182, 137]],
      [[183, 136]],
      [[183, 130]],
      [[184, 129]],
      [[184, 113]],
      [[185, 112]],
      [[185, 111]],
      [[186, 110]],
      [[186, 109]],
      [[188, 107]],
      [[188, 102]],
      [[187, 101]],
      [[187,  99]],
      [[186,  98]],
      [[186,  97]],
      [[183,  94]],
      [[180,  94]],
      [[179,  95]],
      [[163,  95]],
      [[162,  94]]]),
      np.array(
      [[[ 27,  85]],
      [[ 26,  86]],
      [[ 23,  86]],
      [[ 21,  88]],
      [[ 21,  91]],
      [[ 22,  92]],
      [[ 22,  93]],
      [[ 23,  94]],
      [[ 23,  96]],
      [[ 24,  97]],
      [[ 24, 100]],
      [[ 25, 101]],
      [[ 25, 102]],
      [[ 24, 103]],
      [[ 24, 106]],
      [[ 23, 107]],
      [[ 23, 108]],
      [[ 22, 109]],
      [[ 22, 110]],
      [[ 21, 111]],
      [[ 21, 115]],
      [[ 22, 116]],
      [[ 33, 116]],
      [[ 34, 115]],
      [[ 37, 115]],
      [[ 38, 114]],
      [[ 41, 114]],
      [[ 42, 113]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 111]],
      [[ 43, 110]],
      [[ 42, 109]],
      [[ 41, 109]],
      [[ 36, 104]],
      [[ 36, 103]],
      [[ 34, 101]],
      [[ 34,  98]],
      [[ 33,  97]],
      [[ 33,  94]],
      [[ 34,  93]],
      [[ 34,  87]],
      [[ 33,  86]],
      [[ 30,  86]],
      [[ 29,  85]]]),
      np.array(
      [[[ 91,  70]],
      [[ 90,  71]],
      [[ 90,  72]],
      [[ 88,  74]],
      [[ 88,  79]],
      [[ 91,  82]],
      [[ 91,  84]],
      [[ 92,  85]],
      [[ 92, 100]],
      [[ 91, 101]],
      [[ 91, 106]],
      [[ 90, 107]],
      [[ 90, 110]],
      [[ 89, 111]],
      [[ 89, 112]],
      [[ 88, 113]],
      [[ 88, 117]],
      [[ 90, 119]],
      [[109, 119]],
      [[110, 118]],
      [[113, 118]],
      [[114, 117]],
      [[121, 117]],
      [[121, 114]],
      [[122, 113]],
      [[119, 110]],
      [[119, 109]],
      [[118, 108]],
      [[118, 107]],
      [[116, 105]],
      [[116, 103]],
      [[115, 102]],
      [[115,  98]],
      [[114,  97]],
      [[114,  95]],
      [[113,  94]],
      [[113,  82]],
      [[114,  81]],
      [[114,  80]],
      [[116,  78]],
      [[116,  74]],
      [[112,  70]],
      [[108,  70]],
      [[107,  71]],
      [[ 98,  71]],
      [[ 97,  70]]]),
      np.array(
      [[[261,  56]],
      [[260,  57]],
      [[247,  57]],
      [[246,  58]],
      [[246,  59]],
      [[245,  60]],
      [[245,  61]],
      [[244,  62]],
      [[244,  63]],
      [[245,  64]],
      [[245,  68]],
      [[246,  69]],
      [[245,  70]],
      [[245,  75]],
      [[244,  76]],
      [[244,  79]],
      [[243,  80]],
      [[243,  83]],
      [[242,  84]],
      [[242,  85]],
      [[240,  87]],
      [[240,  88]],
      [[239,  89]],
      [[239,  90]],
      [[238,  91]],
      [[238,  92]],
      [[237,  93]],
      [[237,  96]],
      [[238,  97]],
      [[245,  97]],
      [[246,  98]],
      [[249,  98]],
      [[250,  99]],
      [[269,  99]],
      [[270,  98]],
      [[271,  98]],
      [[271,  94]],
      [[270,  93]],
      [[270,  92]],
      [[269,  91]],
      [[269,  88]],
      [[268,  87]],
      [[268,  85]],
      [[267,  84]],
      [[267,  82]],
      [[266,  81]],
      [[266,  78]],
      [[265,  77]],
      [[265,  73]],
      [[266,  72]],
      [[266,  69]],
      [[268,  67]],
      [[268,  66]],
      [[269,  65]],
      [[269,  63]],
      [[270,  62]],
      [[270,  59]],
      [[267,  56]]]),
      np.array(
      [[[176,  40]],
      [[175,  41]],
      [[171,  41]],
      [[170,  42]],
      [[158,  42]],
      [[158,  43]],
      [[157,  44]],
      [[157,  45]],
      [[156,  46]],
      [[156,  47]],
      [[155,  48]],
      [[155,  49]],
      [[156,  50]],
      [[156,  52]],
      [[157,  53]],
      [[157,  54]],
      [[158,  55]],
      [[158,  57]],
      [[159,  58]],
      [[159,  73]],
      [[158,  74]],
      [[158,  77]],
      [[157,  78]],
      [[157,  81]],
      [[156,  82]],
      [[156,  84]],
      [[155,  85]],
      [[155,  90]],
      [[157,  92]],
      [[160,  92]],
      [[161,  91]],
      [[166,  91]],
      [[167,  92]],
      [[180,  92]],
      [[181,  91]],
      [[186,  91]],
      [[187,  90]],
      [[190,  90]],
      [[191,  89]],
      [[191,  85]],
      [[190,  84]],
      [[190,  83]],
      [[188,  81]],
      [[188,  79]],
      [[187,  78]],
      [[187,  77]],
      [[186,  76]],
      [[186,  74]],
      [[185,  73]],
      [[185,  71]],
      [[184,  70]],
      [[184,  67]],
      [[183,  66]],
      [[183,  65]],
      [[182,  64]],
      [[182,  62]],
      [[181,  61]],
      [[181,  54]],
      [[182,  53]],
      [[182,  52]],
      [[183,  51]],
      [[183,  48]],
      [[184,  47]],
      [[184,  46]],
      [[183,  45]],
      [[183,  44]],
      [[179,  40]]]),
      np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]]),
      np.array([[[251,  23]],
      [[250,  24]],
      [[247,  24]],
      [[245,  26]],
      [[245,  27]],
      [[244,  28]],
      [[244,  30]],
      [[246,  32]],
      [[246,  33]],
      [[247,  34]],
      [[247,  35]],
      [[248,  36]],
      [[248,  41]],
      [[249,  42]],
      [[248,  43]],
      [[248,  46]],
      [[246,  48]],
      [[246,  49]],
      [[245,  50]],
      [[245,  53]],
      [[246,  54]],
      [[254,  54]],
      [[255,  55]],
      [[256,  55]],
      [[257,  54]],
      [[262,  54]],
      [[263,  53]],
      [[268,  53]],
      [[269,  52]],
      [[269,  51]],
      [[268,  50]],
      [[268,  49]],
      [[261,  42]],
      [[261,  41]],
      [[260,  40]],
      [[260,  39]],
      [[259,  38]],
      [[259,  35]],
      [[258,  34]],
      [[258,  31]],
      [[259,  30]],
      [[259,  27]],
      [[258,  26]],
      [[257,  26]],
      [[255,  24]],
      [[252,  24]]]), # checked
      np.array(
      [[[160,   7]],
      [[159,   8]],
      [[159,   9]],
      [[158,  10]],
      [[157,  10]],
      [[155,   8]],
      [[155,   9]],
      [[154,  10]],
      [[154,  12]],
      [[153,  13]],
      [[153,  14]],
      [[154,  15]],
      [[154,  17]],
      [[155,  17]],
      [[156,  18]],
      [[156,  19]],
      [[157,  20]],
      [[157,  21]],
      [[158,  22]],
      [[158,  30]],
      [[157,  31]],
      [[157,  32]],
      [[154,  35]],
      [[154,  38]],
      [[155,  38]],
      [[156,  39]],
      [[172,  39]],
      [[173,  38]],
      [[177,  38]],
      [[178,  37]],
      [[180,  37]],
      [[181,  36]],
      [[182,  36]],
      [[181,  35]],
      [[181,  34]],
      [[178,  31]],
      [[177,  31]],
      [[176,  30]],
      [[176,  29]],
      [[172,  25]],
      [[172,  24]],
      [[171,  23]],
      [[171,  20]],
      [[170,  19]],
      [[170,  16]],
      [[171,  15]],
      [[171,  14]],
      [[170,  13]],
      [[171,  12]],
      [[167,   8]],
      [[164,   8]],
      [[163,   7]]]),
      np.array(
        [[[ 87, 342]],
        [[ 86, 343]],
        [[ 85, 343]],
        [[ 80, 348]],
        [[ 80, 349]],
        [[ 79, 350]],
        [[ 78, 350]],
        [[ 77, 351]],
        [[ 77, 356]],
        [[ 73, 360]],
        [[ 73, 361]],
        [[ 72, 362]],
        [[ 72, 364]],
        [[ 71, 365]],
        [[ 71, 366]],
        [[ 70, 367]],
        [[ 70, 369]],
        [[ 69, 370]],
        [[ 69, 371]],
        [[ 68, 372]],
        [[ 68, 374]],
        [[ 67, 375]],
        [[ 67, 376]],
        [[ 66, 377]],
        [[ 66, 378]],
        [[ 65, 379]],
        [[ 65, 380]],
        [[ 64, 381]],
        [[ 64, 382]],
        [[ 63, 383]],
        [[ 63, 384]],
        [[ 62, 385]],
        [[ 62, 386]],
        [[ 61, 387]],
        [[ 61, 388]],
        [[ 59, 390]],
        [[ 59, 391]],
        [[ 58, 392]],
        [[ 58, 393]],
        [[ 57, 394]],
        [[ 57, 395]],
        [[ 55, 397]],
        [[ 55, 398]],
        [[ 53, 400]],
        [[ 53, 401]],
        [[ 52, 402]],
        [[ 52, 403]],
        [[ 50, 405]],
        [[ 50, 406]],
        [[ 48, 408]],
        [[ 48, 409]],
        [[ 46, 411]],
        [[ 46, 412]],
        [[ 45, 413]],
        [[ 45, 414]],
        [[ 43, 416]],
        [[ 43, 417]],
        [[ 41, 419]],
        [[ 41, 420]],
        [[ 40, 421]],
        [[ 40, 422]],
        [[ 37, 425]],
        [[ 37, 426]],
        [[ 36, 427]],
        [[ 36, 428]],
        [[ 35, 429]],
        [[ 35, 430]],
        [[ 33, 432]],
        [[ 33, 433]],
        [[ 31, 435]],
        [[ 31, 436]],
        [[ 30, 437]],
        [[ 30, 438]],
        [[ 29, 439]],
        [[ 29, 440]],
        [[ 27, 442]],
        [[ 27, 444]],
        [[ 59, 444]],
        [[ 59, 443]],
        [[ 62, 440]],
        [[ 62, 439]],
        [[ 64, 437]],
        [[ 64, 435]],
        [[ 65, 434]],
        [[ 65, 433]],
        [[ 66, 432]],
        [[ 66, 431]],
        [[ 68, 429]],
        [[ 68, 428]],
        [[ 69, 427]],
        [[ 69, 426]],
        [[ 70, 425]],
        [[ 70, 424]],
        [[ 71, 423]],
        [[ 71, 421]],
        [[ 72, 420]],
        [[ 72, 419]],
        [[ 73, 418]],
        [[ 73, 415]],
        [[ 75, 413]],
        [[ 75, 411]],
        [[ 76, 410]],
        [[ 76, 409]],
        [[ 78, 407]],
        [[ 78, 406]],
        [[ 79, 405]],
        [[ 79, 404]],
        [[ 81, 402]],
        [[ 81, 401]],
        [[ 83, 399]],
        [[ 83, 398]],
        [[ 95, 386]],
        [[ 96, 386]],
        [[ 99, 383]],
        [[100, 383]],
        [[102, 381]],
        [[103, 381]],
        [[104, 380]],
        [[105, 380]],
        [[107, 378]],
        [[108, 378]],
        [[109, 377]],
        [[110, 377]],
        [[112, 375]],
        [[112, 371]],
        [[114, 369]],
        [[114, 368]],
        [[115, 367]],
        [[116, 367]],
        [[117, 366]],
        [[117, 361]],
        [[116, 360]],
        [[116, 359]],
        [[115, 358]],
        [[113, 358]],
        [[112, 357]],
        [[109, 357]],
        [[108, 356]],
        [[105, 356]],
        [[104, 355]],
        [[100, 355]],
        [[ 99, 354]],
        [[ 98, 354]],
        [[ 96, 352]],
        [[ 96, 351]],
        [[ 95, 350]],
        [[ 95, 343]],
        [[ 94, 342]]],
        dtype=np.int32
      ),
      np.array(
        [[[200, 351]],
        [[199, 352]],
        [[197, 352]],
        [[196, 353]],
        [[194, 353]],
        [[193, 354]],
        [[191, 354]],
        [[190, 355]],
        [[187, 355]],
        [[186, 356]],
        [[182, 356]],
        [[181, 357]],
        [[177, 357]],
        [[176, 358]],
        [[155, 358]],
        [[154, 359]],
        [[151, 359]],
        [[150, 358]],
        [[149, 359]],
        [[138, 359]],
        [[137, 358]],
        [[132, 358]],
        [[131, 359]],
        [[129, 359]],
        [[127, 361]],
        [[127, 364]],
        [[126, 365]],
        [[126, 366]],
        [[129, 369]],
        [[128, 370]],
        [[126, 370]],
        [[125, 371]],
        [[125, 374]],
        [[124, 375]],
        [[124, 377]],
        [[122, 379]],
        [[122, 380]],
        [[123, 381]],
        [[123, 383]],
        [[124, 384]],
        [[124, 400]],
        [[123, 401]],
        [[123, 407]],
        [[122, 408]],
        [[122, 411]],
        [[121, 412]],
        [[121, 415]],
        [[120, 416]],
        [[120, 418]],
        [[119, 419]],
        [[119, 422]],
        [[117, 424]],
        [[117, 428]],
        [[116, 429]],
        [[116, 430]],
        [[114, 432]],
        [[114, 434]],
        [[113, 435]],
        [[113, 436]],
        [[112, 437]],
        [[112, 439]],
        [[111, 440]],
        [[111, 444]],
        [[130, 444]],
        [[131, 443]],
        [[151, 443]],
        [[152, 442]],
        [[153, 442]],
        [[155, 440]],
        [[155, 439]],
        [[156, 438]],
        [[156, 437]],
        [[158, 435]],
        [[158, 434]],
        [[159, 433]],
        [[159, 432]],
        [[161, 430]],
        [[161, 429]],
        [[162, 428]],
        [[162, 427]],
        [[163, 426]],
        [[163, 425]],
        [[165, 423]],
        [[165, 422]],
        [[166, 421]],
        [[166, 420]],
        [[168, 418]],
        [[168, 417]],
        [[170, 415]],
        [[170, 414]],
        [[173, 411]],
        [[173, 410]],
        [[176, 407]],
        [[176, 406]],
        [[188, 394]],
        [[188, 393]],
        [[192, 389]],
        [[192, 388]],
        [[194, 386]],
        [[194, 384]],
        [[195, 383]],
        [[195, 379]],
        [[196, 378]],
        [[197, 378]],
        [[198, 377]],
        [[199, 377]],
        [[203, 373]],
        [[203, 372]],
        [[205, 370]],
        [[205, 369]],
        [[206, 368]],
        [[206, 367]],
        [[208, 365]],
        [[208, 364]],
        [[209, 363]],
        [[209, 361]],
        [[210, 360]],
        [[210, 358]],
        [[211, 357]],
        [[211, 356]],
        [[210, 355]],
        [[210, 353]],
        [[209, 352]],
        [[208, 352]],
        [[207, 351]]],
        dtype=np.int32
      )
    ]
    ideal_distal_phalanx_1 = contours[12]
    ideal_medial_phalanx_1 = contours[9]
    ideal_proximal_phalanx_1 = contours[7]
    ideal_metacarpal_1 = contours[1]
    ideal_distal_phalanx_2 = contours[16]
    ideal_medial_phalanx_2 = contours[13]
    ideal_proximal_phalanx_2 = contours[8]
    ideal_metacarpal_2 = contours[3]
    ideal_distal_phalanx_3 = contours[18]
    ideal_medial_phalanx_3 = contours[15]
    ideal_proximal_phalanx_3 = contours[11]
    ideal_metacarpal_3 = contours[4]
    ideal_distal_phalanx_4 = contours[17]
    ideal_medial_phalanx_4 = contours[14]
    ideal_proximal_phalanx_4 = contours[10]
    ideal_metacarpal_4 = contours[5]
    ideal_distal_phalanx_5 = contours[6]
    ideal_proximal_phalanx_5 = contours[2]
    ideal_metacarpal_5 = contours[0]
    ideal_ulna = contours[19]
    ideal_radius = contours[20]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      400,
      400,
    )
    assert len(complete_contours) == 1

    found_contours = complete_contours[0]['contours_committed']

    assert len(found_contours) == 21

    def check_if_contour_included(contour):
      assertion_passed = False
      for found_contour in found_contours:
        try:
          reference_hu_moments = cv.moments(contour)
          reference_hu_moments = cv.HuMoments(reference_hu_moments)
          reference_hu_moments = np.absolute(reference_hu_moments)
          reference_hu_moments_no_zeros = np.where( # to avoid DivideByZero
            reference_hu_moments == 0,
            np.finfo(float).eps,
            reference_hu_moments
          )
          reference_hu_moments = (
            np.log10(reference_hu_moments_no_zeros)
          ).flatten()

          hu_moments = cv.moments(found_contour)
          hu_moments = cv.HuMoments(hu_moments)
          hu_moments = np.absolute(hu_moments)
          hu_moments_no_zeros = np.where( # to avoid DivideByZero
            hu_moments == 0,
            np.finfo(float).eps,
            hu_moments
          )
          hu_moments = (np.log10(hu_moments_no_zeros)).flatten()
          
          difference = np.linalg.norm(hu_moments - reference_hu_moments)
          assert difference < 1e-06

          assertion_passed = True
        except AssertionError:
          pass
      if not assertion_passed:
        pytest.fail('Missing finger contour in the search output.')

    check_if_contour_included(ideal_distal_phalanx_1)
    check_if_contour_included(ideal_medial_phalanx_1)
    check_if_contour_included(ideal_proximal_phalanx_1)
    check_if_contour_included(ideal_metacarpal_1)
    check_if_contour_included(ideal_distal_phalanx_2)
    check_if_contour_included(ideal_medial_phalanx_2)
    check_if_contour_included(ideal_proximal_phalanx_2)
    check_if_contour_included(ideal_metacarpal_2)
    check_if_contour_included(ideal_distal_phalanx_3)
    check_if_contour_included(ideal_medial_phalanx_3)
    check_if_contour_included(ideal_proximal_phalanx_3)
    check_if_contour_included(ideal_metacarpal_3)
    check_if_contour_included(ideal_distal_phalanx_4)
    check_if_contour_included(ideal_medial_phalanx_4)
    check_if_contour_included(ideal_proximal_phalanx_4)
    check_if_contour_included(ideal_metacarpal_4)
    check_if_contour_included(ideal_distal_phalanx_5)
    check_if_contour_included(ideal_proximal_phalanx_5)
    check_if_contour_included(ideal_metacarpal_5)
    check_if_contour_included(ideal_ulna)
    check_if_contour_included(ideal_radius)

  def test_only_metacarpal_and_sesamoid(self):
    contours = [
      np.array(
        [[[317, 252]],
        [[316, 253]],
        [[314, 253]],
        [[313, 254]],
        [[309, 254]],
        [[309, 255]],
        [[306, 258]],
        [[305, 258]],
        [[303, 260]],
        [[303, 261]],
        [[301, 263]],
        [[299, 263]],
        [[298, 264]],
        [[298, 265]],
        [[292, 271]],
        [[291, 271]],
        [[287, 275]],
        [[286, 275]],
        [[284, 277]],
        [[283, 277]],
        [[280, 280]],
        [[279, 280]],
        [[277, 282]],
        [[276, 282]],
        [[275, 283]],
        [[274, 283]],
        [[273, 284]],
        [[272, 284]],
        [[271, 285]],
        [[270, 285]],
        [[268, 287]],
        [[266, 287]],
        [[265, 288]],
        [[264, 288]],
        [[263, 289]],
        [[261, 289]],
        [[260, 290]],
        [[257, 290]],
        [[256, 291]],
        [[253, 291]],
        [[252, 292]],
        [[247, 292]],
        [[246, 293]],
        [[243, 293]],
        [[242, 294]],
        [[240, 294]],
        [[239, 295]],
        [[236, 295]],
        [[235, 296]],
        [[233, 296]],
        [[230, 299]],
        [[230, 303]],
        [[232, 305]],
        [[232, 306]],
        [[235, 309]],
        [[236, 309]],
        [[237, 310]],
        [[237, 311]],
        [[238, 312]],
        [[238, 315]],
        [[239, 316]],
        [[240, 316]],
        [[242, 318]],
        [[243, 318]],
        [[244, 319]],
        [[250, 319]],
        [[251, 320]],
        [[253, 320]],
        [[254, 319]],
        [[256, 319]],
        [[257, 318]],
        [[258, 318]],
        [[259, 317]],
        [[260, 317]],
        [[261, 316]],
        [[263, 316]],
        [[265, 314]],
        [[266, 314]],
        [[267, 313]],
        [[268, 313]],
        [[271, 310]],
        [[272, 310]],
        [[277, 305]],
        [[278, 305]],
        [[280, 303]],
        [[281, 303]],
        [[283, 301]],
        [[284, 301]],
        [[286, 299]],
        [[287, 299]],
        [[289, 297]],
        [[290, 297]],
        [[292, 295]],
        [[293, 295]],
        [[294, 294]],
        [[295, 294]],
        [[296, 293]],
        [[297, 293]],
        [[299, 291]],
        [[300, 291]],
        [[301, 290]],
        [[302, 290]],
        [[304, 288]],
        [[305, 288]],
        [[306, 287]],
        [[307, 287]],
        [[308, 286]],
        [[309, 286]],
        [[311, 284]],
        [[312, 284]],
        [[314, 282]],
        [[315, 282]],
        [[316, 281]],
        [[317, 281]],
        [[318, 280]],
        [[319, 280]],
        [[321, 278]],
        [[323, 278]],
        [[324, 277]],
        [[325, 277]],
        [[326, 276]],
        [[327, 276]],
        [[328, 275]],
        [[329, 275]],
        [[331, 273]],
        [[332, 273]],
        [[332, 272]],
        [[334, 270]],
        [[334, 269]],
        [[335, 268]],
        [[335, 264]],
        [[334, 263]],
        [[334, 262]],
        [[332, 260]],
        [[331, 260]],
        [[328, 257]],
        [[327, 257]],
        [[326, 256]],
        [[325, 256]],
        [[324, 255]],
        [[323, 255]],
        [[321, 253]],
        [[320, 253]],
        [[319, 252]]],
        dtype=np.int32
      ),
      np.array(
        [[[294, 250]],
        [[293, 251]],
        [[293, 255]],
        [[294, 256]],
        [[299, 256]],
        [[300, 255]],
        [[301, 255]],
        [[302, 256]],
        [[304, 256]],
        [[305, 255]],
        [[305, 252]],
        [[304, 251]],
        [[303, 251]],
        [[302, 250]]],
        dtype=np.int32
      )
    ]
    expected_contours = [
      ExpectedContourSesamoidMetacarpal(),
      ExpectedContourSesamoid()
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      400,
      400,
    )
    assert len(complete_contours) == 1

    found_contours = complete_contours[0]['contours_committed']

    assert len(found_contours) == 2

    def check_if_contour_included(contour):
      assertion_passed = False
      for found_contour in found_contours:
        try:
          reference_hu_moments = cv.moments(contour)
          reference_hu_moments = cv.HuMoments(reference_hu_moments)
          reference_hu_moments = np.absolute(reference_hu_moments)
          reference_hu_moments_no_zeros = np.where( # to avoid DivideByZero
            reference_hu_moments == 0,
            np.finfo(float).eps,
            reference_hu_moments
          )
          reference_hu_moments = (
            np.log10(reference_hu_moments_no_zeros)
          ).flatten()

          hu_moments = cv.moments(found_contour)
          hu_moments = cv.HuMoments(hu_moments)
          hu_moments = np.absolute(hu_moments)
          hu_moments_no_zeros = np.where( # to avoid DivideByZero
            hu_moments == 0,
            np.finfo(float).eps,
            hu_moments
          )
          hu_moments = (np.log10(hu_moments_no_zeros)).flatten()
          
          difference = np.linalg.norm(hu_moments - reference_hu_moments)
          assert difference < 1e-06

          assertion_passed = True
        except AssertionError:
          pass
      if not assertion_passed:
        pytest.fail('Missing finger contour in the search output.')

    metacarpal = contours[0]
    sesamoid = contours[1]
    check_if_contour_included(metacarpal)
    check_if_contour_included(sesamoid)

  def test_contour_injection(self):
    contours = [
      np.array(
        [[[199, 364]],
        [[198, 365]],
        [[196, 365]],
        [[195, 366]],
        [[193, 366]],
        [[192, 367]],
        [[190, 367]],
        [[189, 368]],
        [[186, 368]],
        [[185, 369]],
        [[181, 369]],
        [[180, 370]],
        [[176, 370]],
        [[175, 371]],
        [[154, 371]],
        [[153, 372]],
        [[150, 372]],
        [[149, 371]],
        [[148, 372]],
        [[137, 372]],
        [[136, 371]],
        [[131, 371]],
        [[130, 372]],
        [[128, 372]],
        [[126, 374]],
        [[126, 377]],
        [[125, 378]],
        [[125, 379]],
        [[128, 382]],
        [[127, 383]],
        [[125, 383]],
        [[124, 384]],
        [[124, 387]],
        [[123, 388]],
        [[123, 390]],
        [[121, 392]],
        [[121, 393]],
        [[122, 394]],
        [[122, 396]],
        [[123, 397]],
        [[123, 413]],
        [[122, 414]],
        [[122, 420]],
        [[121, 421]],
        [[121, 424]],
        [[120, 425]],
        [[120, 428]],
        [[119, 429]],
        [[119, 431]],
        [[118, 432]],
        [[118, 435]],
        [[116, 437]],
        [[116, 441]],
        [[115, 442]],
        [[115, 443]],
        [[113, 445]],
        [[113, 447]],
        [[112, 448]],
        [[112, 449]],
        [[111, 450]],
        [[111, 452]],
        [[110, 453]],
        [[110, 457]],
        [[129, 457]],
        [[130, 456]],
        [[150, 456]],
        [[151, 455]],
        [[152, 455]],
        [[154, 453]],
        [[154, 452]],
        [[155, 451]],
        [[155, 450]],
        [[157, 448]],
        [[157, 447]],
        [[158, 446]],
        [[158, 445]],
        [[160, 443]],
        [[160, 442]],
        [[161, 441]],
        [[161, 440]],
        [[162, 439]],
        [[162, 438]],
        [[164, 436]],
        [[164, 435]],
        [[165, 434]],
        [[165, 433]],
        [[167, 431]],
        [[167, 430]],
        [[169, 428]],
        [[169, 427]],
        [[172, 424]],
        [[172, 423]],
        [[175, 420]],
        [[175, 419]],
        [[187, 407]],
        [[187, 406]],
        [[191, 402]],
        [[191, 401]],
        [[193, 399]],
        [[193, 397]],
        [[194, 396]],
        [[194, 392]],
        [[195, 391]],
        [[196, 391]],
        [[197, 390]],
        [[198, 390]],
        [[202, 386]],
        [[202, 385]],
        [[204, 383]],
        [[204, 382]],
        [[205, 381]],
        [[205, 380]],
        [[207, 378]],
        [[207, 377]],
        [[208, 376]],
        [[208, 374]],
        [[209, 373]],
        [[209, 371]],
        [[210, 370]],
        [[210, 369]],
        [[209, 368]],
        [[209, 366]],
        [[208, 365]],
        [[207, 365]],
        [[206, 364]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 86, 355]],
        [[ 85, 356]],
        [[ 84, 356]],
        [[ 79, 361]],
        [[ 79, 362]],
        [[ 78, 363]],
        [[ 77, 363]],
        [[ 76, 364]],
        [[ 76, 369]],
        [[ 72, 373]],
        [[ 72, 374]],
        [[ 71, 375]],
        [[ 71, 377]],
        [[ 70, 378]],
        [[ 70, 379]],
        [[ 69, 380]],
        [[ 69, 382]],
        [[ 68, 383]],
        [[ 68, 384]],
        [[ 67, 385]],
        [[ 67, 387]],
        [[ 66, 388]],
        [[ 66, 389]],
        [[ 65, 390]],
        [[ 65, 391]],
        [[ 64, 392]],
        [[ 64, 393]],
        [[ 63, 394]],
        [[ 63, 395]],
        [[ 62, 396]],
        [[ 62, 397]],
        [[ 61, 398]],
        [[ 61, 399]],
        [[ 60, 400]],
        [[ 60, 401]],
        [[ 58, 403]],
        [[ 58, 404]],
        [[ 57, 405]],
        [[ 57, 406]],
        [[ 56, 407]],
        [[ 56, 408]],
        [[ 54, 410]],
        [[ 54, 411]],
        [[ 52, 413]],
        [[ 52, 414]],
        [[ 51, 415]],
        [[ 51, 416]],
        [[ 49, 418]],
        [[ 49, 419]],
        [[ 47, 421]],
        [[ 47, 422]],
        [[ 45, 424]],
        [[ 45, 425]],
        [[ 44, 426]],
        [[ 44, 427]],
        [[ 42, 429]],
        [[ 42, 430]],
        [[ 40, 432]],
        [[ 40, 433]],
        [[ 39, 434]],
        [[ 39, 435]],
        [[ 36, 438]],
        [[ 36, 439]],
        [[ 35, 440]],
        [[ 35, 441]],
        [[ 34, 442]],
        [[ 34, 443]],
        [[ 32, 445]],
        [[ 32, 446]],
        [[ 30, 448]],
        [[ 30, 449]],
        [[ 29, 450]],
        [[ 29, 451]],
        [[ 28, 452]],
        [[ 28, 453]],
        [[ 26, 455]],
        [[ 26, 457]],
        [[ 58, 457]],
        [[ 58, 456]],
        [[ 61, 453]],
        [[ 61, 452]],
        [[ 63, 450]],
        [[ 63, 448]],
        [[ 64, 447]],
        [[ 64, 446]],
        [[ 65, 445]],
        [[ 65, 444]],
        [[ 67, 442]],
        [[ 67, 441]],
        [[ 68, 440]],
        [[ 68, 439]],
        [[ 69, 438]],
        [[ 69, 437]],
        [[ 70, 436]],
        [[ 70, 434]],
        [[ 71, 433]],
        [[ 71, 432]],
        [[ 72, 431]],
        [[ 72, 428]],
        [[ 74, 426]],
        [[ 74, 424]],
        [[ 75, 423]],
        [[ 75, 422]],
        [[ 77, 420]],
        [[ 77, 419]],
        [[ 78, 418]],
        [[ 78, 417]],
        [[ 80, 415]],
        [[ 80, 414]],
        [[ 82, 412]],
        [[ 82, 411]],
        [[ 94, 399]],
        [[ 95, 399]],
        [[ 98, 396]],
        [[ 99, 396]],
        [[101, 394]],
        [[102, 394]],
        [[103, 393]],
        [[104, 393]],
        [[106, 391]],
        [[107, 391]],
        [[108, 390]],
        [[109, 390]],
        [[111, 388]],
        [[111, 384]],
        [[113, 382]],
        [[113, 381]],
        [[114, 380]],
        [[115, 380]],
        [[116, 379]],
        [[116, 374]],
        [[115, 373]],
        [[115, 372]],
        [[114, 371]],
        [[112, 371]],
        [[111, 370]],
        [[108, 370]],
        [[107, 369]],
        [[104, 369]],
        [[103, 368]],
        [[ 99, 368]],
        [[ 98, 367]],
        [[ 97, 367]],
        [[ 95, 365]],
        [[ 95, 364]],
        [[ 94, 363]],
        [[ 94, 356]],
        [[ 93, 355]]],
        dtype=np.int32
      ),   
      np.array(
        [[[316, 265]],
        [[315, 266]],
        [[313, 266]],
        [[312, 267]],
        [[308, 267]],
        [[308, 268]],
        [[305, 271]],
        [[304, 271]],
        [[302, 273]],
        [[302, 274]],
        [[300, 276]],
        [[298, 276]],
        [[297, 277]],
        [[297, 278]],
        [[291, 284]],
        [[290, 284]],
        [[286, 288]],
        [[285, 288]],
        [[283, 290]],
        [[282, 290]],
        [[279, 293]],
        [[278, 293]],
        [[276, 295]],
        [[275, 295]],
        [[274, 296]],
        [[273, 296]],
        [[272, 297]],
        [[271, 297]],
        [[270, 298]],
        [[269, 298]],
        [[267, 300]],
        [[265, 300]],
        [[264, 301]],
        [[263, 301]],
        [[262, 302]],
        [[260, 302]],
        [[259, 303]],
        [[256, 303]],
        [[255, 304]],
        [[252, 304]],
        [[251, 305]],
        [[246, 305]],
        [[245, 306]],
        [[242, 306]],
        [[241, 307]],
        [[239, 307]],
        [[238, 308]],
        [[235, 308]],
        [[234, 309]],
        [[232, 309]],
        [[229, 312]],
        [[229, 316]],
        [[231, 318]],
        [[231, 319]],
        [[234, 322]],
        [[235, 322]],
        [[236, 323]],
        [[236, 324]],
        [[237, 325]],
        [[237, 328]],
        [[238, 329]],
        [[239, 329]],
        [[241, 331]],
        [[242, 331]],
        [[243, 332]],
        [[249, 332]],
        [[250, 333]],
        [[252, 333]],
        [[253, 332]],
        [[255, 332]],
        [[256, 331]],
        [[257, 331]],
        [[258, 330]],
        [[259, 330]],
        [[260, 329]],
        [[262, 329]],
        [[264, 327]],
        [[265, 327]],
        [[266, 326]],
        [[267, 326]],
        [[270, 323]],
        [[271, 323]],
        [[276, 318]],
        [[277, 318]],
        [[279, 316]],
        [[280, 316]],
        [[282, 314]],
        [[283, 314]],
        [[285, 312]],
        [[286, 312]],
        [[288, 310]],
        [[289, 310]],
        [[291, 308]],
        [[292, 308]],
        [[293, 307]],
        [[294, 307]],
        [[295, 306]],
        [[296, 306]],
        [[298, 304]],
        [[299, 304]],
        [[300, 303]],
        [[301, 303]],
        [[303, 301]],
        [[304, 301]],
        [[305, 300]],
        [[306, 300]],
        [[307, 299]],
        [[308, 299]],
        [[310, 297]],
        [[311, 297]],
        [[313, 295]],
        [[314, 295]],
        [[315, 294]],
        [[316, 294]],
        [[317, 293]],
        [[318, 293]],
        [[320, 291]],
        [[322, 291]],
        [[323, 290]],
        [[324, 290]],
        [[325, 289]],
        [[326, 289]],
        [[327, 288]],
        [[328, 288]],
        [[330, 286]],
        [[331, 286]],
        [[331, 285]],
        [[333, 283]],
        [[333, 282]],
        [[334, 281]],
        [[334, 277]],
        [[333, 276]],
        [[333, 275]],
        [[331, 273]],
        [[330, 273]],
        [[327, 270]],
        [[326, 270]],
        [[325, 269]],
        [[324, 269]],
        [[323, 268]],
        [[322, 268]],
        [[320, 266]],
        [[319, 266]],
        [[318, 265]]],
        dtype=np.int32
      ),   
      np.array(
        [[[293, 263]],
        [[292, 264]],
        [[292, 268]],
        [[293, 269]],
        [[298, 269]],
        [[299, 268]],
        [[300, 268]],
        [[301, 269]],
        [[303, 269]],
        [[304, 268]],
        [[304, 265]],
        [[303, 264]],
        [[302, 264]],
        [[301, 263]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 72, 224]],
        [[ 71, 225]],
        [[ 67, 225]],
        [[ 66, 226]],
        [[ 64, 226]],
        [[ 63, 227]],
        [[ 62, 227]],
        [[ 61, 228]],
        [[ 60, 228]],
        [[ 58, 230]],
        [[ 58, 231]],
        [[ 57, 232]],
        [[ 57, 233]],
        [[ 58, 234]],
        [[ 58, 238]],
        [[ 57, 239]],
        [[ 57, 242]],
        [[ 61, 246]],
        [[ 61, 247]],
        [[ 64, 250]],
        [[ 64, 251]],
        [[ 66, 253]],
        [[ 66, 254]],
        [[ 69, 257]],
        [[ 69, 258]],
        [[ 71, 260]],
        [[ 71, 261]],
        [[ 72, 262]],
        [[ 72, 263]],
        [[ 73, 264]],
        [[ 73, 265]],
        [[ 74, 266]],
        [[ 74, 267]],
        [[ 76, 269]],
        [[ 76, 270]],
        [[ 77, 271]],
        [[ 77, 272]],
        [[ 78, 273]],
        [[ 78, 274]],
        [[ 79, 275]],
        [[ 79, 276]],
        [[ 80, 277]],
        [[ 80, 278]],
        [[ 81, 279]],
        [[ 81, 280]],
        [[ 82, 281]],
        [[ 82, 282]],
        [[ 83, 283]],
        [[ 83, 284]],
        [[ 84, 285]],
        [[ 84, 286]],
        [[ 85, 287]],
        [[ 85, 289]],
        [[ 86, 290]],
        [[ 86, 293]],
        [[ 87, 294]],
        [[ 87, 298]],
        [[ 88, 299]],
        [[ 88, 308]],
        [[ 89, 309]],
        [[ 89, 311]],
        [[ 90, 312]],
        [[ 90, 313]],
        [[ 93, 316]],
        [[ 95, 316]],
        [[ 96, 317]],
        [[ 99, 317]],
        [[100, 318]],
        [[102, 318]],
        [[103, 317]],
        [[104, 317]],
        [[105, 316]],
        [[105, 315]],
        [[107, 313]],
        [[107, 312]],
        [[109, 310]],
        [[109, 309]],
        [[112, 306]],
        [[112, 305]],
        [[114, 303]],
        [[114, 302]],
        [[116, 300]],
        [[116, 299]],
        [[117, 298]],
        [[115, 296]],
        [[115, 295]],
        [[114, 295]],
        [[105, 286]],
        [[105, 285]],
        [[103, 283]],
        [[103, 282]],
        [[101, 280]],
        [[101, 279]],
        [[ 99, 277]],
        [[ 99, 276]],
        [[ 98, 275]],
        [[ 98, 274]],
        [[ 97, 273]],
        [[ 97, 272]],
        [[ 96, 271]],
        [[ 96, 270]],
        [[ 95, 269]],
        [[ 95, 268]],
        [[ 94, 267]],
        [[ 94, 266]],
        [[ 93, 265]],
        [[ 93, 263]],
        [[ 92, 262]],
        [[ 92, 261]],
        [[ 91, 260]],
        [[ 91, 259]],
        [[ 90, 258]],
        [[ 90, 256]],
        [[ 89, 255]],
        [[ 89, 253]],
        [[ 88, 252]],
        [[ 88, 250]],
        [[ 87, 249]],
        [[ 87, 240]],
        [[ 86, 239]],
        [[ 86, 236]],
        [[ 85, 235]],
        [[ 85, 233]],
        [[ 77, 225]],
        [[ 75, 225]],
        [[ 74, 224]]],
        dtype=np.int32
      ),   
      np.array(
        [[[355, 214]],
        [[354, 215]],
        [[349, 215]],
        [[348, 216]],
        [[347, 216]],
        [[346, 217]],
        [[345, 217]],
        [[344, 218]],
        [[343, 218]],
        [[342, 219]],
        [[342, 223]],
        [[343, 224]],
        [[343, 228]],
        [[342, 229]],
        [[342, 230]],
        [[340, 232]],
        [[340, 233]],
        [[334, 239]],
        [[333, 239]],
        [[330, 242]],
        [[329, 242]],
        [[327, 244]],
        [[326, 244]],
        [[325, 245]],
        [[324, 245]],
        [[323, 246]],
        [[322, 246]],
        [[321, 247]],
        [[320, 247]],
        [[319, 248]],
        [[318, 248]],
        [[317, 249]],
        [[316, 249]],
        [[315, 250]],
        [[314, 250]],
        [[313, 251]],
        [[311, 251]],
        [[310, 252]],
        [[309, 252]],
        [[306, 255]],
        [[306, 260]],
        [[308, 262]],
        [[315, 262]],
        [[316, 263]],
        [[319, 263]],
        [[320, 264]],
        [[321, 264]],
        [[322, 265]],
        [[323, 265]],
        [[324, 266]],
        [[326, 266]],
        [[327, 267]],
        [[328, 267]],
        [[331, 270]],
        [[331, 271]],
        [[334, 271]],
        [[335, 272]],
        [[338, 272]],
        [[339, 271]],
        [[342, 271]],
        [[343, 270]],
        [[343, 268]],
        [[344, 267]],
        [[344, 265]],
        [[345, 264]],
        [[345, 263]],
        [[346, 262]],
        [[346, 260]],
        [[347, 259]],
        [[347, 258]],
        [[348, 257]],
        [[348, 256]],
        [[350, 254]],
        [[350, 253]],
        [[353, 250]],
        [[353, 249]],
        [[358, 244]],
        [[358, 243]],
        [[366, 235]],
        [[367, 235]],
        [[373, 229]],
        [[373, 228]],
        [[375, 226]],
        [[372, 223]],
        [[371, 223]],
        [[370, 222]],
        [[369, 222]],
        [[366, 219]],
        [[365, 219]],
        [[362, 216]],
        [[361, 216]],
        [[360, 215]],
        [[359, 215]],
        [[358, 214]]],
        dtype=np.int32
      ),   
      np.array(
        [[[115, 209]],
        [[114, 210]],
        [[109, 210]],
        [[108, 211]],
        [[105, 211]],
        [[104, 212]],
        [[103, 212]],
        [[101, 214]],
        [[101, 217]],
        [[102, 218]],
        [[102, 225]],
        [[103, 226]],
        [[103, 227]],
        [[106, 230]],
        [[106, 231]],
        [[108, 233]],
        [[108, 234]],
        [[109, 235]],
        [[109, 237]],
        [[110, 238]],
        [[110, 239]],
        [[111, 240]],
        [[111, 242]],
        [[112, 243]],
        [[112, 245]],
        [[113, 246]],
        [[113, 248]],
        [[114, 249]],
        [[114, 251]],
        [[115, 252]],
        [[115, 253]],
        [[116, 254]],
        [[116, 256]],
        [[117, 257]],
        [[117, 260]],
        [[118, 261]],
        [[118, 263]],
        [[119, 264]],
        [[119, 266]],
        [[120, 267]],
        [[120, 270]],
        [[121, 271]],
        [[121, 273]],
        [[122, 274]],
        [[122, 277]],
        [[123, 278]],
        [[123, 282]],
        [[124, 283]],
        [[124, 287]],
        [[123, 288]],
        [[123, 292]],
        [[122, 293]],
        [[122, 295]],
        [[123, 295]],
        [[124, 296]],
        [[125, 296]],
        [[126, 297]],
        [[127, 297]],
        [[128, 298]],
        [[130, 298]],
        [[131, 299]],
        [[132, 299]],
        [[133, 300]],
        [[134, 300]],
        [[135, 301]],
        [[137, 301]],
        [[138, 302]],
        [[139, 302]],
        [[140, 303]],
        [[142, 303]],
        [[143, 304]],
        [[144, 304]],
        [[145, 305]],
        [[146, 305]],
        [[147, 306]],
        [[148, 306]],
        [[148, 295]],
        [[147, 294]],
        [[147, 292]],
        [[146, 291]],
        [[146, 290]],
        [[145, 289]],
        [[145, 288]],
        [[142, 285]],
        [[142, 284]],
        [[140, 282]],
        [[140, 281]],
        [[139, 280]],
        [[139, 279]],
        [[138, 278]],
        [[138, 276]],
        [[137, 275]],
        [[137, 274]],
        [[136, 273]],
        [[136, 271]],
        [[135, 270]],
        [[135, 268]],
        [[134, 267]],
        [[134, 263]],
        [[133, 262]],
        [[133, 259]],
        [[132, 258]],
        [[132, 253]],
        [[131, 252]],
        [[131, 244]],
        [[130, 243]],
        [[130, 242]],
        [[131, 241]],
        [[131, 239]],
        [[130, 238]],
        [[130, 236]],
        [[131, 235]],
        [[131, 231]],
        [[132, 230]],
        [[132, 228]],
        [[133, 227]],
        [[133, 223]],
        [[132, 222]],
        [[132, 219]],
        [[130, 217]],
        [[130, 216]],
        [[128, 214]],
        [[128, 213]],
        [[127, 212]],
        [[127, 211]],
        [[126, 210]],
        [[123, 210]],
        [[122, 209]],
        [[121, 209]],
        [[120, 210]],
        [[119, 209]],
        [[117, 209]],
        [[116, 210]]],
        dtype=np.int32
      ),   
      np.array(
        [[[155, 190]],
        [[154, 191]],
        [[150, 191]],
        [[149, 192]],
        [[148, 192]],
        [[146, 194]],
        [[146, 196]],
        [[145, 197]],
        [[145, 200]],
        [[144, 201]],
        [[144, 209]],
        [[146, 211]],
        [[146, 213]],
        [[147, 214]],
        [[147, 215]],
        [[148, 216]],
        [[148, 218]],
        [[149, 219]],
        [[149, 221]],
        [[150, 222]],
        [[150, 225]],
        [[151, 226]],
        [[151, 229]],
        [[152, 230]],
        [[152, 234]],
        [[153, 235]],
        [[153, 239]],
        [[154, 240]],
        [[154, 245]],
        [[155, 246]],
        [[155, 253]],
        [[156, 254]],
        [[156, 280]],
        [[155, 281]],
        [[155, 285]],
        [[154, 286]],
        [[154, 289]],
        [[153, 290]],
        [[153, 297]],
        [[152, 298]],
        [[152, 305]],
        [[151, 306]],
        [[151, 307]],
        [[153, 305]],
        [[154, 305]],
        [[155, 304]],
        [[156, 304]],
        [[157, 303]],
        [[158, 303]],
        [[159, 302]],
        [[161, 302]],
        [[162, 301]],
        [[163, 301]],
        [[164, 300]],
        [[165, 300]],
        [[166, 299]],
        [[167, 299]],
        [[168, 298]],
        [[170, 298]],
        [[171, 297]],
        [[172, 297]],
        [[173, 296]],
        [[174, 296]],
        [[175, 295]],
        [[176, 295]],
        [[177, 294]],
        [[179, 294]],
        [[180, 293]],
        [[181, 293]],
        [[182, 292]],
        [[183, 292]],
        [[184, 291]],
        [[185, 291]],
        [[186, 290]],
        [[187, 290]],
        [[187, 289]],
        [[186, 288]],
        [[186, 287]],
        [[185, 286]],
        [[185, 285]],
        [[182, 282]],
        [[182, 281]],
        [[180, 279]],
        [[180, 278]],
        [[179, 277]],
        [[179, 276]],
        [[178, 275]],
        [[178, 271]],
        [[177, 270]],
        [[177, 267]],
        [[176, 266]],
        [[176, 257]],
        [[175, 256]],
        [[175, 230]],
        [[176, 229]],
        [[176, 223]],
        [[177, 222]],
        [[177, 220]],
        [[178, 219]],
        [[178, 217]],
        [[180, 215]],
        [[180, 212]],
        [[181, 211]],
        [[181, 210]],
        [[180, 209]],
        [[180, 208]],
        [[179, 207]],
        [[180, 206]],
        [[179, 205]],
        [[179, 203]],
        [[178, 202]],
        [[178, 201]],
        [[176, 199]],
        [[176, 198]],
        [[173, 195]],
        [[174, 194]],
        [[172, 192]],
        [[170, 192]],
        [[169, 191]],
        [[166, 191]],
        [[165, 190]]],
        dtype=np.int32
      ),   
      np.array(
        [[[219, 186]],
        [[218, 187]],
        [[213, 187]],
        [[212, 188]],
        [[211, 188]],
        [[210, 189]],
        [[210, 191]],
        [[209, 192]],
        [[209, 194]],
        [[207, 196]],
        [[207, 197]],
        [[206, 198]],
        [[206, 202]],
        [[207, 203]],
        [[207, 208]],
        [[206, 209]],
        [[206, 210]],
        [[207, 211]],
        [[207, 221]],
        [[208, 222]],
        [[208, 228]],
        [[209, 229]],
        [[209, 233]],
        [[208, 234]],
        [[208, 244]],
        [[207, 245]],
        [[207, 249]],
        [[206, 250]],
        [[206, 254]],
        [[205, 255]],
        [[205, 259]],
        [[204, 260]],
        [[204, 263]],
        [[203, 264]],
        [[203, 266]],
        [[202, 267]],
        [[202, 269]],
        [[201, 270]],
        [[201, 272]],
        [[200, 273]],
        [[200, 274]],
        [[199, 275]],
        [[199, 276]],
        [[198, 277]],
        [[198, 278]],
        [[197, 279]],
        [[197, 280]],
        [[196, 281]],
        [[196, 282]],
        [[195, 283]],
        [[195, 284]],
        [[194, 285]],
        [[194, 286]],
        [[190, 290]],
        [[190, 291]],
        [[189, 292]],
        [[188, 292]],
        [[185, 295]],
        [[185, 297]],
        [[184, 298]],
        [[186, 298]],
        [[187, 299]],
        [[190, 299]],
        [[191, 300]],
        [[195, 300]],
        [[196, 301]],
        [[199, 301]],
        [[200, 302]],
        [[203, 302]],
        [[204, 303]],
        [[208, 303]],
        [[209, 304]],
        [[212, 304]],
        [[213, 305]],
        [[217, 305]],
        [[218, 306]],
        [[221, 306]],
        [[222, 307]],
        [[224, 307]],
        [[224, 306]],
        [[225, 305]],
        [[225, 304]],
        [[226, 303]],
        [[226, 302]],
        [[227, 301]],
        [[227, 299]],
        [[226, 298]],
        [[226, 297]],
        [[225, 296]],
        [[225, 295]],
        [[224, 294]],
        [[224, 291]],
        [[223, 290]],
        [[223, 273]],
        [[224, 272]],
        [[224, 267]],
        [[225, 266]],
        [[225, 263]],
        [[226, 262]],
        [[226, 259]],
        [[227, 258]],
        [[227, 254]],
        [[228, 253]],
        [[228, 249]],
        [[229, 248]],
        [[229, 245]],
        [[230, 244]],
        [[230, 241]],
        [[231, 240]],
        [[231, 236]],
        [[232, 235]],
        [[232, 233]],
        [[233, 232]],
        [[233, 229]],
        [[234, 228]],
        [[234, 225]],
        [[235, 224]],
        [[235, 223]],
        [[236, 222]],
        [[236, 220]],
        [[237, 219]],
        [[237, 217]],
        [[238, 216]],
        [[238, 214]],
        [[240, 212]],
        [[240, 211]],
        [[241, 210]],
        [[241, 207]],
        [[242, 206]],
        [[242, 204]],
        [[241, 203]],
        [[241, 199]],
        [[240, 198]],
        [[240, 197]],
        [[239, 196]],
        [[239, 195]],
        [[234, 190]],
        [[233, 190]],
        [[231, 188]],
        [[228, 188]],
        [[227, 187]],
        [[223, 187]],
        [[222, 186]]],
        dtype=np.int32
      ),   
      np.array(
        [[[390, 185]],
        [[389, 186]],
        [[387, 186]],
        [[384, 189]],
        [[383, 189]],
        [[381, 191]],
        [[381, 192]],
        [[378, 195]],
        [[377, 195]],
        [[375, 197]],
        [[374, 197]],
        [[372, 199]],
        [[371, 199]],
        [[370, 200]],
        [[369, 200]],
        [[368, 201]],
        [[366, 201]],
        [[365, 202]],
        [[364, 202]],
        [[363, 203]],
        [[362, 203]],
        [[361, 204]],
        [[358, 204]],
        [[357, 205]],
        [[355, 205]],
        [[354, 206]],
        [[353, 206]],
        [[351, 208]],
        [[351, 209]],
        [[352, 210]],
        [[352, 211]],
        [[355, 211]],
        [[356, 212]],
        [[359, 212]],
        [[360, 213]],
        [[363, 213]],
        [[366, 216]],
        [[366, 217]],
        [[367, 217]],
        [[369, 219]],
        [[371, 219]],
        [[372, 220]],
        [[373, 220]],
        [[375, 222]],
        [[375, 223]],
        [[376, 222]],
        [[378, 222]],
        [[379, 221]],
        [[379, 219]],
        [[380, 218]],
        [[380, 216]],
        [[381, 215]],
        [[381, 213]],
        [[382, 212]],
        [[382, 211]],
        [[384, 209]],
        [[384, 208]],
        [[394, 198]],
        [[395, 198]],
        [[397, 196]],
        [[399, 196]],
        [[403, 192]],
        [[402, 192]],
        [[401, 191]],
        [[401, 188]],
        [[399, 186]],
        [[398, 186]],
        [[397, 185]],
        [[396, 186]],
        [[394, 186]],
        [[393, 185]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 52, 164]],
        [[ 50, 166]],
        [[ 48, 166]],
        [[ 47, 167]],
        [[ 45, 167]],
        [[ 44, 168]],
        [[ 36, 168]],
        [[ 35, 169]],
        [[ 34, 169]],
        [[ 34, 177]],
        [[ 37, 180]],
        [[ 37, 181]],
        [[ 39, 183]],
        [[ 39, 184]],
        [[ 41, 186]],
        [[ 41, 187]],
        [[ 42, 188]],
        [[ 42, 190]],
        [[ 43, 191]],
        [[ 43, 193]],
        [[ 44, 194]],
        [[ 44, 196]],
        [[ 45, 197]],
        [[ 45, 198]],
        [[ 46, 199]],
        [[ 46, 200]],
        [[ 47, 201]],
        [[ 47, 204]],
        [[ 48, 205]],
        [[ 48, 208]],
        [[ 49, 209]],
        [[ 49, 216]],
        [[ 48, 217]],
        [[ 48, 224]],
        [[ 50, 226]],
        [[ 58, 226]],
        [[ 59, 225]],
        [[ 60, 225]],
        [[ 61, 224]],
        [[ 63, 224]],
        [[ 64, 223]],
        [[ 66, 223]],
        [[ 67, 222]],
        [[ 70, 222]],
        [[ 71, 221]],
        [[ 82, 221]],
        [[ 83, 220]],
        [[ 84, 220]],
        [[ 84, 218]],
        [[ 85, 217]],
        [[ 85, 215]],
        [[ 84, 214]],
        [[ 84, 213]],
        [[ 83, 212]],
        [[ 82, 212]],
        [[ 69, 199]],
        [[ 69, 198]],
        [[ 67, 196]],
        [[ 67, 195]],
        [[ 66, 194]],
        [[ 66, 193]],
        [[ 64, 191]],
        [[ 64, 190]],
        [[ 63, 189]],
        [[ 63, 188]],
        [[ 62, 187]],
        [[ 62, 186]],
        [[ 61, 185]],
        [[ 61, 183]],
        [[ 59, 181]],
        [[ 59, 176]],
        [[ 58, 175]],
        [[ 58, 173]],
        [[ 59, 172]],
        [[ 59, 171]],
        [[ 58, 170]],
        [[ 58, 168]],
        [[ 57, 167]],
        [[ 56, 167]],
        [[ 53, 164]]],
        dtype=np.int32
      ),   
      np.array(
        [[[111, 134]],
        [[110, 135]],
        [[ 94, 135]],
        [[ 93, 136]],
        [[ 93, 138]],
        [[ 92, 139]],
        [[ 92, 142]],
        [[ 91, 143]],
        [[ 92, 144]],
        [[ 91, 145]],
        [[ 92, 146]],
        [[ 92, 147]],
        [[ 93, 148]],
        [[ 93, 149]],
        [[ 95, 151]],
        [[ 95, 155]],
        [[ 96, 156]],
        [[ 96, 161]],
        [[ 97, 162]],
        [[ 97, 165]],
        [[ 98, 166]],
        [[ 98, 168]],
        [[ 99, 169]],
        [[ 99, 171]],
        [[100, 172]],
        [[100, 175]],
        [[101, 176]],
        [[101, 192]],
        [[100, 193]],
        [[100, 195]],
        [[ 99, 196]],
        [[ 99, 200]],
        [[ 98, 201]],
        [[ 98, 203]],
        [[ 99, 204]],
        [[ 99, 206]],
        [[100, 207]],
        [[101, 207]],
        [[102, 208]],
        [[105, 208]],
        [[106, 207]],
        [[112, 207]],
        [[113, 206]],
        [[124, 206]],
        [[125, 207]],
        [[129, 207]],
        [[130, 206]],
        [[132, 206]],
        [[134, 204]],
        [[134, 200]],
        [[133, 199]],
        [[133, 197]],
        [[132, 196]],
        [[132, 195]],
        [[130, 193]],
        [[130, 192]],
        [[129, 191]],
        [[129, 190]],
        [[127, 188]],
        [[127, 187]],
        [[126, 186]],
        [[126, 185]],
        [[125, 184]],
        [[125, 182]],
        [[124, 181]],
        [[124, 178]],
        [[123, 177]],
        [[123, 167]],
        [[122, 166]],
        [[122, 156]],
        [[121, 155]],
        [[121, 152]],
        [[120, 151]],
        [[120, 145]],
        [[121, 144]],
        [[121, 142]],
        [[122, 141]],
        [[121, 140]],
        [[121, 139]],
        [[118, 136]],
        [[118, 135]],
        [[117, 134]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 38, 129]],
        [[ 37, 130]],
        [[ 35, 130]],
        [[ 34, 131]],
        [[ 33, 131]],
        [[ 32, 132]],
        [[ 28, 132]],
        [[ 27, 131]],
        [[ 23, 131]],
        [[ 21, 133]],
        [[ 21, 138]],
        [[ 23, 140]],
        [[ 23, 141]],
        [[ 24, 142]],
        [[ 24, 147]],
        [[ 25, 148]],
        [[ 25, 149]],
        [[ 26, 150]],
        [[ 26, 155]],
        [[ 27, 156]],
        [[ 27, 164]],
        [[ 28, 165]],
        [[ 28, 166]],
        [[ 36, 166]],
        [[ 37, 165]],
        [[ 42, 165]],
        [[ 43, 164]],
        [[ 44, 164]],
        [[ 45, 163]],
        [[ 46, 163]],
        [[ 47, 162]],
        [[ 52, 162]],
        [[ 53, 161]],
        [[ 54, 161]],
        [[ 54, 158]],
        [[ 49, 153]],
        [[ 49, 152]],
        [[ 46, 149]],
        [[ 46, 148]],
        [[ 44, 146]],
        [[ 44, 145]],
        [[ 43, 144]],
        [[ 43, 137]],
        [[ 44, 136]],
        [[ 44, 134]],
        [[ 45, 133]],
        [[ 41, 129]]],
        dtype=np.int32
      ),   
      np.array(
        [[[239, 112]],
        [[239, 113]],
        [[237, 115]],
        [[237, 116]],
        [[234, 119]],
        [[234, 121]],
        [[233, 122]],
        [[234, 123]],
        [[234, 128]],
        [[233, 129]],
        [[233, 132]],
        [[232, 133]],
        [[232, 135]],
        [[231, 136]],
        [[231, 137]],
        [[230, 138]],
        [[230, 140]],
        [[229, 141]],
        [[229, 143]],
        [[228, 144]],
        [[228, 146]],
        [[227, 147]],
        [[227, 148]],
        [[226, 149]],
        [[226, 151]],
        [[225, 152]],
        [[225, 153]],
        [[224, 154]],
        [[224, 155]],
        [[223, 156]],
        [[223, 157]],
        [[222, 158]],
        [[222, 159]],
        [[221, 160]],
        [[221, 161]],
        [[219, 163]],
        [[219, 164]],
        [[208, 175]],
        [[208, 176]],
        [[207, 177]],
        [[207, 182]],
        [[208, 183]],
        [[209, 183]],
        [[210, 184]],
        [[214, 184]],
        [[215, 183]],
        [[226, 183]],
        [[227, 184]],
        [[228, 184]],
        [[229, 185]],
        [[232, 185]],
        [[233, 186]],
        [[234, 186]],
        [[235, 187]],
        [[237, 187]],
        [[238, 188]],
        [[248, 188]],
        [[249, 187]],
        [[249, 186]],
        [[250, 185]],
        [[250, 184]],
        [[251, 183]],
        [[251, 182]],
        [[250, 181]],
        [[250, 177]],
        [[249, 176]],
        [[249, 161]],
        [[250, 160]],
        [[250, 157]],
        [[251, 156]],
        [[251, 154]],
        [[252, 153]],
        [[252, 151]],
        [[253, 150]],
        [[253, 148]],
        [[254, 147]],
        [[254, 144]],
        [[255, 143]],
        [[255, 140]],
        [[256, 139]],
        [[256, 138]],
        [[257, 137]],
        [[257, 135]],
        [[259, 133]],
        [[259, 132]],
        [[264, 127]],
        [[264, 120]],
        [[263, 119]],
        [[263, 117]],
        [[261, 115]],
        [[248, 115]],
        [[247, 114]],
        [[245, 114]],
        [[244, 113]],
        [[240, 113]]],
        dtype=np.int32
      ),   
      np.array(
        [[[159, 107]],
        [[158, 108]],
        [[158, 109]],
        [[157, 110]],
        [[157, 111]],
        [[155, 113]],
        [[155, 115]],
        [[154, 116]],
        [[155, 117]],
        [[155, 120]],
        [[156, 121]],
        [[156, 131]],
        [[155, 132]],
        [[155, 156]],
        [[154, 157]],
        [[154, 161]],
        [[153, 162]],
        [[153, 165]],
        [[152, 166]],
        [[152, 167]],
        [[151, 168]],
        [[151, 169]],
        [[150, 170]],
        [[150, 171]],
        [[149, 172]],
        [[149, 173]],
        [[147, 175]],
        [[147, 176]],
        [[146, 177]],
        [[146, 180]],
        [[145, 181]],
        [[145, 186]],
        [[146, 187]],
        [[148, 187]],
        [[149, 188]],
        [[151, 188]],
        [[152, 187]],
        [[161, 187]],
        [[162, 186]],
        [[163, 187]],
        [[168, 187]],
        [[169, 188]],
        [[171, 188]],
        [[172, 189]],
        [[175, 189]],
        [[176, 190]],
        [[181, 190]],
        [[182, 189]],
        [[184, 189]],
        [[185, 188]],
        [[186, 188]],
        [[187, 187]],
        [[187, 183]],
        [[186, 182]],
        [[186, 179]],
        [[185, 178]],
        [[185, 176]],
        [[184, 175]],
        [[184, 174]],
        [[183, 173]],
        [[183, 170]],
        [[182, 169]],
        [[182, 165]],
        [[181, 164]],
        [[181, 150]],
        [[182, 149]],
        [[182, 143]],
        [[183, 142]],
        [[183, 126]],
        [[184, 125]],
        [[184, 124]],
        [[185, 123]],
        [[185, 122]],
        [[187, 120]],
        [[187, 115]],
        [[186, 114]],
        [[186, 112]],
        [[185, 111]],
        [[185, 110]],
        [[182, 107]],
        [[179, 107]],
        [[178, 108]],
        [[162, 108]],
        [[161, 107]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 26,  98]],
        [[ 25,  99]],
        [[ 22,  99]],
        [[ 20, 101]],
        [[ 20, 104]],
        [[ 21, 105]],
        [[ 21, 106]],
        [[ 22, 107]],
        [[ 22, 109]],
        [[ 23, 110]],
        [[ 23, 113]],
        [[ 24, 114]],
        [[ 24, 115]],
        [[ 23, 116]],
        [[ 23, 119]],
        [[ 22, 120]],
        [[ 22, 121]],
        [[ 21, 122]],
        [[ 21, 123]],
        [[ 20, 124]],
        [[ 20, 128]],
        [[ 21, 129]],
        [[ 32, 129]],
        [[ 33, 128]],
        [[ 36, 128]],
        [[ 37, 127]],
        [[ 40, 127]],
        [[ 41, 126]],
        [[ 42, 126]],
        [[ 41, 125]],
        [[ 41, 124]],
        [[ 42, 123]],
        [[ 41, 122]],
        [[ 40, 122]],
        [[ 35, 117]],
        [[ 35, 116]],
        [[ 33, 114]],
        [[ 33, 111]],
        [[ 32, 110]],
        [[ 32, 107]],
        [[ 33, 106]],
        [[ 33, 100]],
        [[ 32,  99]],
        [[ 29,  99]],
        [[ 28,  98]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 90,  83]],
        [[ 89,  84]],
        [[ 89,  85]],
        [[ 87,  87]],
        [[ 87,  92]],
        [[ 90,  95]],
        [[ 90,  97]],
        [[ 91,  98]],
        [[ 91, 113]],
        [[ 90, 114]],
        [[ 90, 119]],
        [[ 89, 120]],
        [[ 89, 123]],
        [[ 88, 124]],
        [[ 88, 125]],
        [[ 87, 126]],
        [[ 87, 130]],
        [[ 89, 132]],
        [[108, 132]],
        [[109, 131]],
        [[112, 131]],
        [[113, 130]],
        [[120, 130]],
        [[120, 127]],
        [[121, 126]],
        [[118, 123]],
        [[118, 122]],
        [[117, 121]],
        [[117, 120]],
        [[115, 118]],
        [[115, 116]],
        [[114, 115]],
        [[114, 111]],
        [[113, 110]],
        [[113, 108]],
        [[112, 107]],
        [[112,  95]],
        [[113,  94]],
        [[113,  93]],
        [[115,  91]],
        [[115,  87]],
        [[111,  83]],
        [[107,  83]],
        [[106,  84]],
        [[ 97,  84]],
        [[ 96,  83]]],
        dtype=np.int32
      ),   
      np.array(
        [[[260,  69]],
        [[259,  70]],
        [[246,  70]],
        [[245,  71]],
        [[245,  72]],
        [[244,  73]],
        [[244,  74]],
        [[243,  75]],
        [[243,  76]],
        [[244,  77]],
        [[244,  81]],
        [[245,  82]],
        [[244,  83]],
        [[244,  88]],
        [[243,  89]],
        [[243,  92]],
        [[242,  93]],
        [[242,  96]],
        [[241,  97]],
        [[241,  98]],
        [[239, 100]],
        [[239, 101]],
        [[238, 102]],
        [[238, 103]],
        [[237, 104]],
        [[237, 105]],
        [[236, 106]],
        [[236, 109]],
        [[237, 110]],
        [[244, 110]],
        [[245, 111]],
        [[248, 111]],
        [[249, 112]],
        [[268, 112]],
        [[269, 111]],
        [[270, 111]],
        [[270, 107]],
        [[269, 106]],
        [[269, 105]],
        [[268, 104]],
        [[268, 101]],
        [[267, 100]],
        [[267,  98]],
        [[266,  97]],
        [[266,  95]],
        [[265,  94]],
        [[265,  91]],
        [[264,  90]],
        [[264,  86]],
        [[265,  85]],
        [[265,  82]],
        [[267,  80]],
        [[267,  79]],
        [[268,  78]],
        [[268,  76]],
        [[269,  75]],
        [[269,  72]],
        [[266,  69]]],
        dtype=np.int32
      ),   
      np.array(
        [[[175,  53]],
        [[174,  54]],
        [[170,  54]],
        [[169,  55]],
        [[157,  55]],
        [[157,  56]],
        [[156,  57]],
        [[156,  58]],
        [[155,  59]],
        [[155,  60]],
        [[154,  61]],
        [[154,  62]],
        [[155,  63]],
        [[155,  65]],
        [[156,  66]],
        [[156,  67]],
        [[157,  68]],
        [[157,  70]],
        [[158,  71]],
        [[158,  86]],
        [[157,  87]],
        [[157,  90]],
        [[156,  91]],
        [[156,  94]],
        [[155,  95]],
        [[155,  97]],
        [[154,  98]],
        [[154, 103]],
        [[156, 105]],
        [[159, 105]],
        [[160, 104]],
        [[165, 104]],
        [[166, 105]],
        [[179, 105]],
        [[180, 104]],
        [[185, 104]],
        [[186, 103]],
        [[189, 103]],
        [[190, 102]],
        [[190,  98]],
        [[189,  97]],
        [[189,  96]],
        [[187,  94]],
        [[187,  92]],
        [[186,  91]],
        [[186,  90]],
        [[185,  89]],
        [[185,  87]],
        [[184,  86]],
        [[184,  84]],
        [[183,  83]],
        [[183,  80]],
        [[182,  79]],
        [[182,  78]],
        [[181,  77]],
        [[181,  75]],
        [[180,  74]],
        [[180,  67]],
        [[181,  66]],
        [[181,  65]],
        [[182,  64]],
        [[182,  61]],
        [[183,  60]],
        [[183,  59]],
        [[182,  58]],
        [[182,  57]],
        [[178,  53]]],
        dtype=np.int32
      ),   
      np.array(
        [[[ 97,  48]],
        [[ 96,  49]],
        [[ 95,  49]],
        [[ 93,  51]],
        [[ 93,  52]],
        [[ 92,  53]],
        [[ 92,  55]],
        [[ 93,  56]],
        [[ 93,  57]],
        [[ 94,  58]],
        [[ 94,  60]],
        [[ 95,  61]],
        [[ 95,  63]],
        [[ 94,  64]],
        [[ 94,  67]],
        [[ 93,  68]],
        [[ 93,  69]],
        [[ 92,  70]],
        [[ 92,  71]],
        [[ 87,  76]],
        [[ 87,  80]],
        [[ 89,  80]],
        [[ 90,  81]],
        [[ 97,  81]],
        [[ 98,  82]],
        [[103,  82]],
        [[104,  81]],
        [[110,  81]],
        [[111,  80]],
        [[114,  80]],
        [[114,  76]],
        [[109,  71]],
        [[109,  70]],
        [[108,  69]],
        [[108,  68]],
        [[107,  67]],
        [[107,  63]],
        [[108,  62]],
        [[108,  59]],
        [[109,  58]],
        [[109,  57]],
        [[110,  56]],
        [[110,  54]],
        [[109,  53]],
        [[109,  50]],
        [[108,  50]],
        [[107,  49]],
        [[105,  49]],
        [[104,  48]]],
        dtype=np.int32
      ),   
      np.array(
        [[[250,  36]],
        [[249,  37]],
        [[246,  37]],
        [[244,  39]],
        [[244,  40]],
        [[243,  41]],
        [[243,  43]],
        [[245,  45]],
        [[245,  46]],
        [[246,  47]],
        [[246,  48]],
        [[247,  49]],
        [[247,  54]],
        [[248,  55]],
        [[247,  56]],
        [[247,  59]],
        [[245,  61]],
        [[245,  62]],
        [[244,  63]],
        [[244,  66]],
        [[245,  67]],
        [[253,  67]],
        [[254,  68]],
        [[255,  68]],
        [[256,  67]],
        [[261,  67]],
        [[262,  66]],
        [[267,  66]],
        [[268,  65]],
        [[268,  64]],
        [[267,  63]],
        [[267,  62]],
        [[260,  55]],
        [[260,  54]],
        [[259,  53]],
        [[259,  52]],
        [[258,  51]],
        [[258,  48]],
        [[257,  47]],
        [[257,  44]],
        [[258,  43]],
        [[258,  40]],
        [[257,  39]],
        [[256,  39]],
        [[254,  37]],
        [[251,  37]]],
        dtype=np.int32
      ),   
      np.array(
        [[[159,  20]],
        [[158,  21]],
        [[158,  22]],
        [[157,  23]],
        [[156,  23]],
        [[154,  21]],
        [[154,  22]],
        [[153,  23]],
        [[153,  25]],
        [[152,  26]],
        [[152,  27]],
        [[153,  28]],
        [[153,  30]],
        [[154,  30]],
        [[155,  31]],
        [[155,  32]],
        [[156,  33]],
        [[156,  34]],
        [[157,  35]],
        [[157,  43]],
        [[156,  44]],
        [[156,  45]],
        [[153,  48]],
        [[153,  51]],
        [[154,  51]],
        [[155,  52]],
        [[171,  52]],
        [[172,  51]],
        [[176,  51]],
        [[177,  50]],
        [[179,  50]],
        [[180,  49]],
        [[181,  49]],
        [[180,  48]],
        [[180,  47]],
        [[177,  44]],
        [[176,  44]],
        [[175,  43]],
        [[175,  42]],
        [[171,  38]],
        [[171,  37]],
        [[170,  36]],
        [[170,  33]],
        [[169,  32]],
        [[169,  29]],
        [[170,  28]],
        [[170,  27]],
        [[169,  26]],
        [[170,  25]],
        [[166,  21]],
        [[163,  21]],
        [[162,  20]]],
        dtype=np.int32
      ),   
      np.array(
        [[[316, 265]],
        [[315, 266]],
        [[313, 266]],
        [[312, 267]],
        [[308, 267]],
        [[308, 268]],
        [[305, 271]],
        [[304, 271]],
        [[302, 273]],
        [[302, 274]],
        [[300, 276]],
        [[298, 276]],
        [[297, 277]],
        [[297, 278]],
        [[291, 284]],
        [[290, 284]],
        [[286, 288]],
        [[285, 288]],
        [[283, 290]],
        [[282, 290]],
        [[279, 293]],
        [[278, 293]],
        [[276, 295]],
        [[275, 295]],
        [[274, 296]],
        [[273, 296]],
        [[272, 297]],
        [[271, 297]],
        [[270, 298]],
        [[269, 298]],
        [[267, 300]],
        [[265, 300]],
        [[264, 301]],
        [[263, 301]],
        [[262, 302]],
        [[260, 302]],
        [[259, 303]],
        [[256, 303]],
        [[255, 304]],
        [[252, 304]],
        [[251, 305]],
        [[246, 305]],
        [[245, 306]],
        [[242, 306]],
        [[241, 307]],
        [[239, 307]],
        [[238, 308]],
        [[235, 308]],
        [[234, 309]],
        [[232, 309]],
        [[229, 312]],
        [[229, 316]],
        [[231, 318]],
        [[231, 319]],
        [[234, 322]],
        [[235, 322]],
        [[236, 323]],
        [[236, 324]],
        [[237, 325]],
        [[237, 328]],
        [[238, 329]],
        [[239, 329]],
        [[241, 331]],
        [[242, 331]],
        [[243, 332]],
        [[249, 332]],
        [[250, 333]],
        [[252, 333]],
        [[253, 332]],
        [[255, 332]],
        [[256, 331]],
        [[257, 331]],
        [[258, 330]],
        [[259, 330]],
        [[260, 329]],
        [[262, 329]],
        [[264, 327]],
        [[265, 327]],
        [[266, 326]],
        [[267, 326]],
        [[270, 323]],
        [[271, 323]],
        [[276, 318]],
        [[277, 318]],
        [[279, 316]],
        [[280, 316]],
        [[282, 314]],
        [[283, 314]],
        [[285, 312]],
        [[286, 312]],
        [[288, 310]],
        [[289, 310]],
        [[291, 308]],
        [[292, 308]],
        [[293, 307]],
        [[294, 307]],
        [[295, 306]],
        [[296, 306]],
        [[298, 304]],
        [[299, 304]],
        [[300, 303]],
        [[301, 303]],
        [[303, 301]],
        [[304, 301]],
        [[305, 300]],
        [[306, 300]],
        [[307, 299]],
        [[308, 299]],
        [[310, 297]],
        [[311, 297]],
        [[313, 295]],
        [[314, 295]],
        [[315, 294]],
        [[316, 294]],
        [[317, 293]],
        [[318, 293]],
        [[320, 291]],
        [[322, 291]],
        [[323, 290]],
        [[324, 290]],
        [[325, 289]],
        [[326, 289]],
        [[327, 288]],
        [[328, 288]],
        [[330, 286]],
        [[331, 286]],
        [[331, 285]],
        [[333, 283]],
        [[333, 282]],
        [[334, 281]],
        [[334, 277]],
        [[333, 276]],
        [[333, 275]],
        [[331, 273]],
        [[330, 273]],
        [[327, 270]],
        [[326, 270]],
        [[325, 269]],
        [[324, 269]],
        [[323, 268]],
        [[322, 268]],
        [[320, 266]],
        [[319, 266]],
        [[318, 265]]],
        dtype=np.int32
      ),
    ]
    expected_contours = [
      ExpectedContourSesamoidMetacarpal(),
      ExpectedContourSesamoid()
    ]
    complete_contours = search_complete_contours(
      contours,
      expected_contours,
      600,
      400,
      400,
    )
    assert len(complete_contours) == 1

    found_contours = complete_contours[0]['contours_committed']

    assert len(found_contours) == 2

    def check_if_contour_included(contour):
      assertion_passed = False
      for found_contour in found_contours:
        try:
          reference_hu_moments = cv.moments(contour)
          reference_hu_moments = cv.HuMoments(reference_hu_moments)
          reference_hu_moments = np.absolute(reference_hu_moments)
          reference_hu_moments_no_zeros = np.where( # to avoid DivideByZero
            reference_hu_moments == 0,
            np.finfo(float).eps,
            reference_hu_moments
          )
          reference_hu_moments = (
            np.log10(reference_hu_moments_no_zeros)
          ).flatten()

          hu_moments = cv.moments(found_contour)
          hu_moments = cv.HuMoments(hu_moments)
          hu_moments = np.absolute(hu_moments)
          hu_moments_no_zeros = np.where( # to avoid DivideByZero
            hu_moments == 0,
            np.finfo(float).eps,
            hu_moments
          )
          hu_moments = (np.log10(hu_moments_no_zeros)).flatten()
          
          difference = np.linalg.norm(hu_moments - reference_hu_moments)
          assert difference < 1e-06

          assertion_passed = True
        except AssertionError:
          pass
      if not assertion_passed:
        pytest.fail('Missing finger contour in the search output.')

    metacarpal = contours[22]
    sesamoid = contours[3]
    check_if_contour_included(metacarpal)
    check_if_contour_included(sesamoid)
