'''
Universidad de La Laguna
Máster en Ingeniería Informática
Trabajo de Final de Máster
Pyimagos development

Show the radiography segments with a text over it indicating the tag of the
segment. For example, for distal phalanx 1 show a text over the distal phalanx
segment annotating it as "distal phalanx 1".
'''

import numpy as np
import cv2 as cv
import matplotlib.pyplot as plt

from src.main_develop_test_distal_phalanx import (
  create_minimal_image_from_contours,
)

from src.radiographies.rad_004 import case_004
from src.radiographies.rad_022 import case_022
from src.radiographies.rad_006 import case_006
from src.radiographies.rad_018 import case_018
from src.radiographies.rad_023 import case_023
from src.radiographies.rad_029 import case_029
from src.radiographies.rad_032 import case_032
from src.radiographies.rad_217 import case_217
from src.radiographies.rad_1622 import case_1622
from src.radiographies.rad_1886 import case_1886
from src.radiographies.rad_010 import case_010
from src.radiographies.rad_013 import case_013
from src.radiographies.rad_016 import case_016
from src.radiographies.rad_019 import case_019
from src.radiographies.rad_030 import case_030
from src.radiographies.rad_031 import case_031
from src.radiographies.rad_084 import case_084
from src.radiographies.rad_1619 import case_1619
from src.radiographies.rad_1779 import case_1779
from src.radiographies.rad_2089 import case_2089

def show_segment_tags(contours, title: str):
  all_points = np.concatenate(contours)
  all_points = np.reshape(all_points, (-1, 2))
  x_values = all_points[:, 0]
  y_values = all_points[:, 1]

  max_x = int(np.max(x_values))
  max_y = int(np.max(y_values))

  blank_image = np.zeros((max_y + 20, max_x + 20), dtype=np.uint8)
  minimal_image, adjusted_contours = create_minimal_image_from_contours(
    blank_image,
    contours,
    padding=60,
  )
  minimal_image = cv.cvtColor(minimal_image, cv.COLOR_GRAY2RGB)
  contours = adjusted_contours

  for i, contour in enumerate(contours):
    color = ((i + 1) * 123 % 256, (i + 1) * 456 % 256, (i + 1) * 789 % 256)
    if len(contour) > 0:
      cv.drawContours(minimal_image, contours, i, color, 1)

    M = cv.moments(contour)
    if M["m00"] != 0: # use centroid
      center_x = int(M["m10"] / M["m00"])
      center_y = int(M["m01"] / M["m00"])
      text_position = (center_x, center_y)
    else: # if too small use bounding box
      x, y, w, h = cv.boundingRect(contour)
      text_position = (x, y - 10)

    cv.putText(
      minimal_image,
      f'{i}',
      text_position,
      cv.FONT_HERSHEY_SIMPLEX,
      fontScale=0.5,
      color=color,
      thickness=1,
      lineType=cv.LINE_AA
    )

  fig = plt.figure()
  plt.imshow(minimal_image)
  plt.title(title)
  plt.axis('off')
  fig.canvas.manager.set_window_title(title)

def visualize_tags_main():
  segments = case_004()
  show_segment_tags(segments, '004 radiography tags.')

  segments = case_022()
  show_segment_tags(segments, '022 radiography tags.')

  segments = case_006()
  show_segment_tags(segments, '006 radiography tags')

  segments = case_018()
  show_segment_tags(segments, '018 radiography tags')

  segments = case_023()
  show_segment_tags(segments, '023 radiography tags')

  segments = case_029()
  show_segment_tags(segments, '029 radiography tags')

  segments = case_032()
  show_segment_tags(segments, '032 radiography tags')

  segments = case_217()
  show_segment_tags(segments, '217 radiography tags')

  segments = case_1622()
  show_segment_tags(segments, '1622 radiography tags')

  segments = case_1886()
  show_segment_tags(segments, '1886 radiography tags')

  segments = case_010() # Cannot estimate, missing distal 4
  show_segment_tags(segments, '010 radiography tags')

  segments = case_013()
  show_segment_tags(segments, '013 radiography tags')

  segments = case_016()
  show_segment_tags(segments, '016 radiography tags')

  segments = case_019()
  show_segment_tags(segments, '019 radiography tags')

  segments = case_030()
  show_segment_tags(segments, '030 radiography tags')

  segments = case_031()
  show_segment_tags(segments, '031 radiography tags')

  segments = case_084()
  show_segment_tags(segments, '084 radiography tags')

  segments = case_1619()
  show_segment_tags(segments, '1619 radiography tags')

  segments = case_1779()
  show_segment_tags(segments, '1779 radiography tags')

  segments = case_2089()
  show_segment_tags(segments, '2089 radiography tags')

  segments = [np.array([[[ 64, 391]],

       [[ 62, 393]],

       [[ 62, 395]],

       [[ 61, 396]],

       [[ 61, 400]],

       [[ 60, 401]],

       [[ 60, 402]],

       [[ 61, 403]],

       [[ 60, 404]],

       [[ 61, 405]],

       [[ 61, 406]],

       [[ 62, 407]],

       [[ 62, 417]],

       [[ 63, 418]],

       [[ 63, 441]],

       [[ 81, 441]],

       [[ 81, 440]],

       [[ 82, 439]],

       [[ 82, 435]],

       [[ 83, 434]],

       [[ 83, 431]],

       [[ 84, 430]],

       [[ 84, 429]],

       [[ 85, 428]],

       [[ 85, 426]],

       [[ 86, 425]],

       [[ 86, 423]],

       [[ 87, 422]],

       [[ 87, 421]],

       [[ 88, 420]],

       [[ 88, 419]],

       [[ 89, 418]],

       [[ 89, 416]],

       [[ 90, 415]],

       [[ 90, 407]],

       [[ 91, 406]],

       [[ 91, 405]],

       [[ 90, 404]],

       [[ 90, 401]],

       [[ 87, 398]],

       [[ 86, 398]],

       [[ 85, 397]],

       [[ 83, 397]],

       [[ 82, 396]],

       [[ 81, 397]],

       [[ 78, 397]],

       [[ 77, 398]],

       [[ 76, 398]],

       [[ 75, 399]],

       [[ 73, 399]],

       [[ 70, 396]],

       [[ 70, 395]],

       [[ 69, 395]],

       [[ 68, 394]],

       [[ 68, 393]],

       [[ 66, 391]]], dtype=np.int32), np.array([[[142, 378]],

       [[141, 379]],

       [[138, 379]],

       [[136, 381]],

       [[135, 381]],

       [[133, 383]],

       [[132, 383]],

       [[131, 384]],

       [[130, 384]],

       [[129, 385]],

       [[127, 385]],

       [[129, 385]],

       [[130, 384]],

       [[132, 384]],

       [[133, 383]],

       [[134, 383]],

       [[136, 381]],

       [[137, 381]],

       [[139, 379]],

       [[141, 379]],

       [[142, 378]],

       [[147, 383]],

       [[147, 395]],

       [[146, 396]],

       [[146, 402]],

       [[145, 403]],

       [[145, 406]],

       [[144, 407]],

       [[143, 407]],

       [[143, 408]],

       [[142, 409]],

       [[143, 410]],

       [[143, 413]],

       [[142, 414]],

       [[142, 417]],

       [[141, 418]],

       [[141, 421]],

       [[140, 422]],

       [[140, 424]],

       [[139, 425]],

       [[139, 428]],

       [[138, 429]],

       [[138, 431]],

       [[137, 432]],

       [[137, 435]],

       [[136, 436]],

       [[136, 438]],

       [[135, 439]],

       [[135, 440]],

       [[134, 441]],

       [[102, 441]],

       [[101, 440]],

       [[101, 434]],

       [[100, 433]],

       [[100, 428]],

       [[ 99, 427]],

       [[ 99, 424]],

       [[ 98, 423]],

       [[ 98, 421]],

       [[ 97, 420]],

       [[ 97, 419]],

       [[ 96, 418]],

       [[ 96, 416]],

       [[ 95, 415]],

       [[ 95, 413]],

       [[ 93, 411]],

       [[ 93, 406]],

       [[ 94, 405]],

       [[ 94, 397]],

       [[ 95, 396]],

       [[ 95, 395]],

       [[ 97, 393]],

       [[ 98, 393]],

       [[ 99, 392]],

       [[100, 392]],

       [[101, 391]],

       [[104, 391]],

       [[105, 390]],

       [[108, 390]],

       [[109, 389]],

       [[116, 389]],

       [[117, 388]],

       [[123, 388]],

       [[124, 387]],

       [[126, 387]],

       [[124, 387]],

       [[123, 388]],

       [[117, 388]],

       [[116, 389]],

       [[109, 389]],

       [[108, 390]],

       [[105, 390]],

       [[104, 391]],

       [[101, 391]],

       [[100, 392]],

       [[ 99, 392]],

       [[ 98, 393]],

       [[ 97, 393]],

       [[ 95, 395]],

       [[ 95, 396]],

       [[ 94, 397]],

       [[ 94, 404]],

       [[ 93, 405]],

       [[ 93, 411]],

       [[ 94, 412]],

       [[ 94, 413]],

       [[ 95, 414]],

       [[ 95, 415]],

       [[ 96, 416]],

       [[ 96, 418]],

       [[ 97, 419]],

       [[ 97, 420]],

       [[ 98, 421]],

       [[ 98, 423]],

       [[ 99, 424]],

       [[ 99, 427]],

       [[100, 428]],

       [[100, 433]],

       [[101, 434]],

       [[101, 441]],

       [[135, 441]],

       [[135, 439]],

       [[136, 438]],

       [[136, 436]],

       [[137, 435]],

       [[137, 432]],

       [[138, 431]],

       [[138, 429]],

       [[139, 428]],

       [[139, 425]],

       [[140, 424]],

       [[140, 422]],

       [[141, 421]],

       [[141, 418]],

       [[142, 417]],

       [[142, 414]],

       [[143, 413]],

       [[143, 410]],

       [[142, 409]],

       [[145, 406]],

       [[145, 403]],

       [[146, 402]],

       [[146, 396]],

       [[147, 395]],

       [[147, 383]],

       [[146, 382]],

       [[146, 381]],

       [[143, 378]]], dtype=np.int32), np.array([[[208, 282]],

       [[207, 283]],

       [[206, 283]],

       [[205, 284]],

       [[204, 284]],

       [[202, 286]],

       [[201, 286]],

       [[199, 288]],

       [[199, 291]],

       [[200, 292]],

       [[200, 295]],

       [[199, 296]],

       [[199, 298]],

       [[198, 299]],

       [[198, 300]],

       [[197, 301]],

       [[197, 302]],

       [[196, 303]],

       [[196, 304]],

       [[195, 305]],

       [[195, 306]],

       [[193, 308]],

       [[193, 309]],

       [[190, 312]],

       [[190, 313]],

       [[187, 316]],

       [[187, 317]],

       [[176, 328]],

       [[175, 328]],

       [[173, 330]],

       [[172, 330]],

       [[170, 332]],

       [[169, 332]],

       [[168, 333]],

       [[167, 333]],

       [[166, 334]],

       [[165, 334]],

       [[164, 335]],

       [[162, 335]],

       [[161, 336]],

       [[159, 336]],

       [[157, 338]],

       [[157, 343]],

       [[158, 344]],

       [[158, 346]],

       [[161, 349]],

       [[161, 350]],

       [[162, 351]],

       [[162, 352]],

       [[163, 353]],

       [[163, 354]],

       [[165, 356]],

       [[166, 356]],

       [[167, 357]],

       [[178, 357]],

       [[181, 354]],

       [[181, 353]],

       [[182, 352]],

       [[182, 351]],

       [[184, 349]],

       [[184, 348]],

       [[186, 346]],

       [[186, 345]],

       [[187, 344]],

       [[187, 343]],

       [[188, 342]],

       [[188, 341]],

       [[190, 339]],

       [[190, 338]],

       [[192, 336]],

       [[192, 335]],

       [[197, 330]],

       [[197, 329]],

       [[201, 325]],

       [[201, 324]],

       [[205, 320]],

       [[205, 319]],

       [[210, 314]],

       [[210, 313]],

       [[224, 299]],

       [[224, 297]],

       [[225, 296]],

       [[225, 293]],

       [[223, 291]],

       [[221, 291]],

       [[219, 289]],

       [[219, 288]],

       [[215, 284]],

       [[214, 284]],

       [[213, 283]],

       [[211, 283]],

       [[210, 282]]], dtype=np.int32), np.array([[[245, 233]],

       [[243, 235]],

       [[242, 235]],

       [[242, 236]],

       [[241, 237]],

       [[241, 244]],

       [[240, 245]],

       [[240, 246]],

       [[239, 247]],

       [[239, 248]],

       [[238, 249]],

       [[238, 250]],

       [[235, 253]],

       [[235, 254]],

       [[231, 258]],

       [[230, 258]],

       [[226, 262]],

       [[225, 262]],

       [[223, 264]],

       [[222, 264]],

       [[220, 266]],

       [[219, 266]],

       [[215, 270]],

       [[214, 269]],

       [[211, 269]],

       [[209, 271]],

       [[209, 277]],

       [[210, 278]],

       [[211, 278]],

       [[212, 279]],

       [[213, 279]],

       [[218, 284]],

       [[219, 284]],

       [[221, 286]],

       [[222, 286]],

       [[225, 289]],

       [[226, 289]],

       [[229, 286]],

       [[229, 284]],

       [[231, 282]],

       [[231, 281]],

       [[232, 280]],

       [[232, 279]],

       [[233, 278]],

       [[233, 277]],

       [[234, 276]],

       [[234, 275]],

       [[236, 273]],

       [[236, 272]],

       [[238, 270]],

       [[238, 269]],

       [[240, 267]],

       [[240, 266]],

       [[243, 263]],

       [[243, 262]],

       [[253, 252]],

       [[253, 251]],

       [[254, 250]],

       [[255, 250]],

       [[258, 247]],

       [[258, 242]],

       [[257, 241]],

       [[257, 240]],

       [[255, 238]],

       [[252, 238]],

       [[251, 237]],

       [[251, 236]],

       [[250, 235]],

       [[249, 235]],

       [[247, 233]]], dtype=np.int32), np.array([[[ 47, 231]],

       [[ 46, 232]],

       [[ 44, 232]],

       [[ 43, 233]],

       [[ 42, 233]],

       [[ 41, 234]],

       [[ 41, 235]],

       [[ 40, 236]],

       [[ 40, 244]],

       [[ 41, 245]],

       [[ 41, 248]],

       [[ 42, 249]],

       [[ 42, 250]],

       [[ 43, 251]],

       [[ 43, 252]],

       [[ 44, 253]],

       [[ 44, 254]],

       [[ 45, 255]],

       [[ 45, 257]],

       [[ 46, 258]],

       [[ 46, 259]],

       [[ 47, 260]],

       [[ 47, 261]],

       [[ 48, 262]],

       [[ 48, 263]],

       [[ 49, 264]],

       [[ 49, 266]],

       [[ 50, 267]],

       [[ 50, 268]],

       [[ 51, 269]],

       [[ 51, 271]],

       [[ 52, 272]],

       [[ 52, 273]],

       [[ 53, 274]],

       [[ 53, 276]],

       [[ 54, 277]],

       [[ 54, 279]],

       [[ 55, 280]],

       [[ 55, 282]],

       [[ 56, 283]],

       [[ 56, 285]],

       [[ 57, 286]],

       [[ 57, 288]],

       [[ 58, 289]],

       [[ 58, 292]],

       [[ 59, 293]],

       [[ 59, 296]],

       [[ 60, 297]],

       [[ 60, 304]],

       [[ 61, 305]],

       [[ 61, 311]],

       [[ 62, 312]],

       [[ 62, 316]],

       [[ 63, 317]],

       [[ 63, 319]],

       [[ 64, 320]],

       [[ 64, 322]],

       [[ 65, 323]],

       [[ 65, 324]],

       [[ 66, 325]],

       [[ 66, 327]],

       [[ 67, 328]],

       [[ 67, 329]],

       [[ 68, 330]],

       [[ 68, 331]],

       [[ 69, 332]],

       [[ 70, 332]],

       [[ 71, 333]],

       [[ 72, 332]],

       [[ 73, 332]],

       [[ 76, 329]],

       [[ 77, 329]],

       [[ 80, 326]],

       [[ 81, 326]],

       [[ 84, 323]],

       [[ 85, 323]],

       [[ 87, 321]],

       [[ 87, 320]],

       [[ 85, 318]],

       [[ 85, 317]],

       [[ 84, 316]],

       [[ 84, 315]],

       [[ 80, 311]],

       [[ 80, 310]],

       [[ 79, 309]],

       [[ 79, 308]],

       [[ 77, 306]],

       [[ 77, 305]],

       [[ 76, 304]],

       [[ 76, 303]],

       [[ 74, 301]],

       [[ 74, 299]],

       [[ 73, 298]],

       [[ 73, 296]],

       [[ 72, 295]],

       [[ 72, 294]],

       [[ 71, 293]],

       [[ 71, 292]],

       [[ 70, 291]],

       [[ 70, 289]],

       [[ 69, 288]],

       [[ 69, 287]],

       [[ 68, 286]],

       [[ 68, 283]],

       [[ 67, 282]],

       [[ 67, 280]],

       [[ 66, 279]],

       [[ 66, 277]],

       [[ 65, 276]],

       [[ 65, 274]],

       [[ 64, 273]],

       [[ 64, 271]],

       [[ 63, 270]],

       [[ 63, 268]],

       [[ 62, 267]],

       [[ 62, 265]],

       [[ 61, 264]],

       [[ 61, 261]],

       [[ 60, 260]],

       [[ 60, 257]],

       [[ 59, 256]],

       [[ 59, 252]],

       [[ 58, 251]],

       [[ 58, 248]],

       [[ 59, 247]],

       [[ 59, 246]],

       [[ 60, 245]],

       [[ 60, 239]],

       [[ 59, 238]],

       [[ 59, 236]],

       [[ 58, 235]],

       [[ 58, 234]],

       [[ 56, 232]],

       [[ 54, 232]],

       [[ 53, 231]]], dtype=np.int32), np.array([[[ 77, 216]],

       [[ 76, 217]],

       [[ 74, 217]],

       [[ 72, 219]],

       [[ 71, 219]],

       [[ 70, 220]],

       [[ 70, 226]],

       [[ 71, 227]],

       [[ 71, 231]],

       [[ 72, 232]],

       [[ 72, 233]],

       [[ 73, 234]],

       [[ 73, 239]],

       [[ 74, 240]],

       [[ 74, 243]],

       [[ 75, 244]],

       [[ 75, 249]],

       [[ 76, 250]],

       [[ 76, 253]],

       [[ 77, 254]],

       [[ 77, 257]],

       [[ 78, 258]],

       [[ 78, 261]],

       [[ 79, 262]],

       [[ 79, 265]],

       [[ 80, 266]],

       [[ 80, 269]],

       [[ 81, 270]],

       [[ 81, 273]],

       [[ 82, 274]],

       [[ 82, 278]],

       [[ 83, 279]],

       [[ 83, 283]],

       [[ 84, 284]],

       [[ 84, 289]],

       [[ 85, 290]],

       [[ 85, 305]],

       [[ 84, 306]],

       [[ 84, 308]],

       [[ 83, 309]],

       [[ 83, 311]],

       [[ 84, 312]],

       [[ 86, 312]],

       [[ 87, 313]],

       [[ 92, 313]],

       [[ 93, 314]],

       [[ 99, 314]],

       [[100, 315]],

       [[103, 315]],

       [[103, 308]],

       [[102, 307]],

       [[102, 303]],

       [[101, 302]],

       [[101, 301]],

       [[100, 300]],

       [[100, 299]],

       [[ 99, 298]],

       [[ 99, 297]],

       [[ 98, 296]],

       [[ 98, 295]],

       [[ 97, 294]],

       [[ 97, 292]],

       [[ 96, 291]],

       [[ 96, 288]],

       [[ 95, 287]],

       [[ 95, 284]],

       [[ 94, 283]],

       [[ 94, 278]],

       [[ 93, 277]],

       [[ 93, 271]],

       [[ 92, 270]],

       [[ 92, 263]],

       [[ 91, 262]],

       [[ 91, 255]],

       [[ 90, 254]],

       [[ 90, 246]],

       [[ 89, 245]],

       [[ 89, 239]],

       [[ 90, 238]],

       [[ 90, 229]],

       [[ 91, 228]],

       [[ 91, 222]],

       [[ 87, 218]],

       [[ 86, 218]],

       [[ 85, 217]],

       [[ 82, 217]],

       [[ 81, 216]]], dtype=np.int32), np.array([[[152, 206]],

       [[151, 207]],

       [[148, 207]],

       [[146, 209]],

       [[146, 211]],

       [[145, 212]],

       [[145, 213]],

       [[144, 214]],

       [[144, 216]],

       [[142, 218]],

       [[142, 220]],

       [[141, 221]],

       [[141, 222]],

       [[142, 223]],

       [[142, 236]],

       [[141, 237]],

       [[141, 248]],

       [[140, 249]],

       [[140, 262]],

       [[139, 263]],

       [[139, 278]],

       [[138, 279]],

       [[138, 291]],

       [[137, 292]],

       [[137, 297]],

       [[136, 298]],

       [[136, 302]],

       [[135, 303]],

       [[135, 305]],

       [[134, 306]],

       [[134, 308]],

       [[133, 309]],

       [[133, 311]],

       [[132, 312]],

       [[132, 313]],

       [[131, 314]],

       [[131, 315]],

       [[130, 316]],

       [[130, 318]],

       [[129, 319]],

       [[129, 321]],

       [[128, 322]],

       [[128, 324]],

       [[129, 324]],

       [[130, 325]],

       [[131, 325]],

       [[132, 326]],

       [[133, 326]],

       [[134, 327]],

       [[136, 327]],

       [[137, 328]],

       [[138, 328]],

       [[139, 329]],

       [[140, 329]],

       [[141, 330]],

       [[143, 330]],

       [[144, 331]],

       [[145, 331]],

       [[146, 332]],

       [[148, 332]],

       [[149, 333]],

       [[150, 333]],

       [[151, 334]],

       [[152, 334]],

       [[153, 335]],

       [[154, 335]],

       [[154, 334]],

       [[153, 333]],

       [[153, 332]],

       [[154, 331]],

       [[154, 327]],

       [[153, 326]],

       [[154, 325]],

       [[154, 322]],

       [[153, 321]],

       [[153, 317]],

       [[152, 316]],

       [[152, 313]],

       [[151, 312]],

       [[151, 288]],

       [[152, 287]],

       [[152, 280]],

       [[153, 279]],

       [[153, 272]],

       [[154, 271]],

       [[154, 267]],

       [[155, 266]],

       [[155, 262]],

       [[156, 261]],

       [[156, 258]],

       [[157, 257]],

       [[157, 254]],

       [[158, 253]],

       [[158, 251]],

       [[159, 250]],

       [[159, 247]],

       [[160, 246]],

       [[160, 244]],

       [[161, 243]],

       [[161, 239]],

       [[162, 238]],

       [[162, 236]],

       [[163, 235]],

       [[163, 234]],

       [[166, 231]],

       [[167, 231]],

       [[168, 230]],

       [[168, 228]],

       [[169, 227]],

       [[169, 222]],

       [[168, 221]],

       [[168, 218]],

       [[167, 217]],

       [[167, 215]],

       [[165, 215]],

       [[164, 214]],

       [[164, 213]],

       [[163, 212]],

       [[163, 210]],

       [[162, 209]],

       [[161, 209]],

       [[160, 208]],

       [[159, 208]],

       [[158, 207]],

       [[155, 207]],

       [[154, 206]]], dtype=np.int32), np.array([[[112, 203]],

       [[111, 204]],

       [[107, 204]],

       [[106, 205]],

       [[105, 205]],

       [[103, 207]],

       [[103, 219]],

       [[102, 220]],

       [[102, 227]],

       [[103, 228]],

       [[103, 234]],

       [[104, 235]],

       [[104, 249]],

       [[105, 250]],

       [[105, 258]],

       [[106, 259]],

       [[106, 265]],

       [[107, 266]],

       [[107, 273]],

       [[108, 274]],

       [[108, 289]],

       [[109, 290]],

       [[109, 293]],

       [[108, 294]],

       [[108, 302]],

       [[107, 303]],

       [[107, 307]],

       [[109, 309]],

       [[110, 309]],

       [[113, 312]],

       [[114, 312]],

       [[118, 316]],

       [[119, 316]],

       [[122, 319]],

       [[123, 319]],

       [[125, 321]],

       [[125, 315]],

       [[126, 314]],

       [[126, 305]],

       [[125, 304]],

       [[125, 299]],

       [[124, 298]],

       [[124, 294]],

       [[123, 293]],

       [[123, 289]],

       [[122, 288]],

       [[122, 278]],

       [[121, 277]],

       [[121, 253]],

       [[122, 252]],

       [[122, 240]],

       [[123, 239]],

       [[123, 234]],

       [[124, 233]],

       [[124, 230]],

       [[125, 229]],

       [[125, 228]],

       [[126, 227]],

       [[126, 226]],

       [[128, 224]],

       [[129, 224]],

       [[129, 217]],

       [[128, 216]],

       [[128, 214]],

       [[127, 213]],

       [[127, 211]],

       [[122, 206]],

       [[121, 206]],

       [[120, 205]],

       [[118, 205]],

       [[117, 204]],

       [[113, 204]]], dtype=np.int32), np.array([[[275, 194]],

       [[274, 195]],

       [[273, 195]],

       [[272, 196]],

       [[271, 196]],

       [[269, 198]],

       [[269, 199]],

       [[268, 200]],

       [[268, 201]],

       [[267, 202]],

       [[267, 203]],

       [[266, 204]],

       [[266, 205]],

       [[263, 208]],

       [[263, 209]],

       [[261, 211]],

       [[261, 212]],

       [[258, 215]],

       [[258, 216]],

       [[256, 218]],

       [[256, 219]],

       [[254, 221]],

       [[253, 221]],

       [[252, 222]],

       [[251, 222]],

       [[249, 224]],

       [[248, 224]],

       [[248, 225]],

       [[247, 226]],

       [[247, 229]],

       [[248, 230]],

       [[248, 231]],

       [[250, 233]],

       [[251, 233]],

       [[254, 236]],

       [[257, 236]],

       [[258, 237]],

       [[262, 237]],

       [[262, 232]],

       [[263, 231]],

       [[263, 227]],

       [[264, 226]],

       [[264, 224]],

       [[265, 223]],

       [[265, 221]],

       [[267, 219]],

       [[267, 218]],

       [[268, 217]],

       [[268, 215]],

       [[270, 213]],

       [[270, 212]],

       [[271, 211]],

       [[271, 210]],

       [[272, 209]],

       [[272, 208]],

       [[274, 206]],

       [[274, 205]],

       [[276, 203]],

       [[276, 202]],

       [[280, 198]],

       [[280, 195]],

       [[279, 194]]], dtype=np.int32), np.array([[[ 39, 165]],

       [[ 38, 166]],

       [[ 37, 166]],

       [[ 36, 167]],

       [[ 34, 167]],

       [[ 33, 168]],

       [[ 30, 168]],

       [[ 30, 169]],

       [[ 29, 170]],

       [[ 29, 173]],

       [[ 30, 174]],

       [[ 30, 176]],

       [[ 31, 177]],

       [[ 31, 179]],

       [[ 32, 180]],

       [[ 32, 181]],

       [[ 33, 182]],

       [[ 33, 184]],

       [[ 34, 185]],

       [[ 34, 190]],

       [[ 35, 191]],

       [[ 35, 197]],

       [[ 36, 198]],

       [[ 36, 207]],

       [[ 37, 208]],

       [[ 37, 215]],

       [[ 36, 216]],

       [[ 36, 221]],

       [[ 35, 222]],

       [[ 35, 225]],

       [[ 34, 226]],

       [[ 34, 228]],

       [[ 35, 229]],

       [[ 35, 230]],

       [[ 36, 231]],

       [[ 41, 231]],

       [[ 42, 230]],

       [[ 43, 230]],

       [[ 44, 229]],

       [[ 47, 229]],

       [[ 48, 228]],

       [[ 57, 228]],

       [[ 58, 227]],

       [[ 58, 222]],

       [[ 57, 221]],

       [[ 57, 220]],

       [[ 56, 219]],

       [[ 56, 218]],

       [[ 54, 216]],

       [[ 54, 215]],

       [[ 53, 214]],

       [[ 53, 213]],

       [[ 51, 211]],

       [[ 51, 210]],

       [[ 50, 209]],

       [[ 50, 207]],

       [[ 49, 206]],

       [[ 49, 204]],

       [[ 48, 203]],

       [[ 48, 201]],

       [[ 47, 200]],

       [[ 47, 197]],

       [[ 46, 196]],

       [[ 46, 193]],

       [[ 45, 192]],

       [[ 45, 188]],

       [[ 44, 187]],

       [[ 44, 181]],

       [[ 43, 180]],

       [[ 43, 177]],

       [[ 44, 176]],

       [[ 44, 171]],

       [[ 43, 170]],

       [[ 43, 167]],

       [[ 41, 165]]], dtype=np.int32), np.array([[[ 77, 132]],

       [[ 76, 133]],

       [[ 67, 133]],

       [[ 66, 134]],

       [[ 66, 145]],

       [[ 67, 146]],

       [[ 67, 147]],

       [[ 68, 148]],

       [[ 68, 151]],

       [[ 69, 152]],

       [[ 69, 172]],

       [[ 70, 173]],

       [[ 70, 185]],

       [[ 71, 186]],

       [[ 71, 192]],

       [[ 70, 193]],

       [[ 70, 199]],

       [[ 69, 200]],

       [[ 69, 203]],

       [[ 68, 204]],

       [[ 68, 206]],

       [[ 67, 207]],

       [[ 67, 209]],

       [[ 66, 210]],

       [[ 66, 211]],

       [[ 67, 212]],

       [[ 67, 213]],

       [[ 68, 214]],

       [[ 68, 215]],

       [[ 72, 215]],

       [[ 73, 214]],

       [[ 76, 214]],

       [[ 77, 213]],

       [[ 82, 213]],

       [[ 83, 214]],

       [[ 89, 214]],

       [[ 90, 213]],

       [[ 90, 212]],

       [[ 91, 211]],

       [[ 91, 206]],

       [[ 90, 205]],

       [[ 90, 204]],

       [[ 89, 203]],

       [[ 89, 201]],

       [[ 88, 200]],

       [[ 88, 198]],

       [[ 87, 197]],

       [[ 87, 196]],

       [[ 86, 195]],

       [[ 86, 192]],

       [[ 85, 191]],

       [[ 85, 187]],

       [[ 84, 186]],

       [[ 84, 177]],

       [[ 83, 176]],

       [[ 83, 164]],

       [[ 82, 163]],

       [[ 82, 144]],

       [[ 83, 143]],

       [[ 83, 142]],

       [[ 82, 141]],

       [[ 83, 140]],

       [[ 82, 139]],

       [[ 82, 134]],

       [[ 80, 132]]], dtype=np.int32), np.array([[[ 32, 129]],

       [[ 31, 130]],

       [[ 28, 130]],

       [[ 27, 131]],

       [[ 21, 131]],

       [[ 21, 137]],

       [[ 22, 138]],

       [[ 22, 139]],

       [[ 24, 141]],

       [[ 24, 142]],

       [[ 25, 143]],

       [[ 25, 150]],

       [[ 26, 151]],

       [[ 26, 166]],

       [[ 32, 166]],

       [[ 33, 165]],

       [[ 35, 165]],

       [[ 36, 164]],

       [[ 37, 164]],

       [[ 38, 163]],

       [[ 41, 163]],

       [[ 42, 162]],

       [[ 42, 159]],

       [[ 40, 157]],

       [[ 40, 156]],

       [[ 38, 154]],

       [[ 38, 153]],

       [[ 36, 151]],

       [[ 36, 150]],

       [[ 35, 149]],

       [[ 35, 146]],

       [[ 34, 145]],

       [[ 34, 130]],

       [[ 33, 129]]], dtype=np.int32), np.array([[[147, 123]],

       [[146, 124]],

       [[137, 124]],

       [[136, 125]],

       [[136, 136]],

       [[137, 137]],

       [[137, 139]],

       [[138, 140]],

       [[138, 145]],

       [[139, 146]],

       [[139, 158]],

       [[140, 159]],

       [[140, 166]],

       [[141, 167]],

       [[141, 179]],

       [[142, 180]],

       [[142, 187]],

       [[141, 188]],

       [[141, 194]],

       [[140, 195]],

       [[140, 198]],

       [[139, 199]],

       [[140, 200]],

       [[139, 201]],

       [[140, 202]],

       [[140, 205]],

       [[141, 205]],

       [[142, 206]],

       [[143, 206]],

       [[144, 205]],

       [[146, 205]],

       [[147, 204]],

       [[148, 204]],

       [[149, 203]],

       [[158, 203]],

       [[159, 204]],

       [[162, 204]],

       [[163, 203]],

       [[165, 203]],

       [[166, 202]],

       [[167, 202]],

       [[167, 200]],

       [[168, 199]],

       [[168, 197]],

       [[167, 196]],

       [[167, 194]],

       [[164, 191]],

       [[164, 190]],

       [[163, 189]],

       [[163, 188]],

       [[162, 187]],

       [[162, 185]],

       [[160, 183]],

       [[160, 181]],

       [[159, 180]],

       [[159, 178]],

       [[158, 177]],

       [[158, 174]],

       [[157, 173]],

       [[157, 169]],

       [[156, 168]],

       [[156, 164]],

       [[155, 163]],

       [[155, 158]],

       [[154, 157]],

       [[154, 155]],

       [[153, 154]],

       [[153, 138]],

       [[154, 137]],

       [[154, 127]],

       [[152, 125]],

       [[152, 124]],

       [[149, 124]],

       [[148, 123]]], dtype=np.int32), np.array([[[112, 111]],

       [[111, 112]],

       [[109, 112]],

       [[107, 114]],

       [[104, 114]],

       [[103, 113]],

       [[ 98, 113]],

       [[ 98, 120]],

       [[ 97, 121]],

       [[ 97, 122]],

       [[ 98, 123]],

       [[ 98, 127]],

       [[ 99, 128]],

       [[ 99, 133]],

       [[100, 134]],

       [[100, 156]],

       [[101, 157]],

       [[101, 172]],

       [[102, 173]],

       [[102, 179]],

       [[101, 180]],

       [[101, 188]],

       [[100, 189]],

       [[100, 191]],

       [[ 99, 192]],

       [[ 99, 194]],

       [[ 98, 195]],

       [[ 98, 196]],

       [[ 99, 197]],

       [[ 98, 198]],

       [[ 98, 199]],

       [[ 99, 200]],

       [[ 99, 201]],

       [[100, 202]],

       [[105, 202]],

       [[106, 201]],

       [[110, 201]],

       [[111, 200]],

       [[113, 200]],

       [[114, 201]],

       [[124, 201]],

       [[126, 199]],

       [[126, 192]],

       [[124, 190]],

       [[124, 188]],

       [[123, 187]],

       [[123, 186]],

       [[121, 184]],

       [[121, 182]],

       [[120, 181]],

       [[120, 179]],

       [[119, 178]],

       [[119, 176]],

       [[118, 175]],

       [[118, 171]],

       [[117, 170]],

       [[117, 163]],

       [[116, 162]],

       [[116, 153]],

       [[115, 152]],

       [[115, 142]],

       [[114, 141]],

       [[114, 127]],

       [[116, 125]],

       [[116, 119]],

       [[115, 118]],

       [[115, 115]],

       [[114, 114]],

       [[114, 113]]], dtype=np.int32), np.array([[[ 23,  96]],

       [[ 22,  97]],

       [[ 21,  97]],

       [[ 20,  98]],

       [[ 20, 104]],

       [[ 21, 105]],

       [[ 21, 110]],

       [[ 22, 111]],

       [[ 22, 120]],

       [[ 21, 121]],

       [[ 21, 122]],

       [[ 20, 123]],

       [[ 20, 128]],

       [[ 21, 129]],

       [[ 26, 129]],

       [[ 27, 128]],

       [[ 30, 128]],

       [[ 31, 127]],

       [[ 32, 127]],

       [[ 33, 126]],

       [[ 33, 125]],

       [[ 34, 124]],

       [[ 33, 123]],

       [[ 33, 122]],

       [[ 30, 119]],

       [[ 30, 117]],

       [[ 28, 115]],

       [[ 28, 112]],

       [[ 27, 111]],

       [[ 27, 104]],

       [[ 28, 103]],

       [[ 28, 100]],

       [[ 27,  99]],

       [[ 27,  98]],

       [[ 25,  96]]], dtype=np.int32), np.array([[[ 66,  81]],

       [[ 65,  82]],

       [[ 64,  82]],

       [[ 64,  84]],

       [[ 63,  85]],

       [[ 63,  89]],

       [[ 64,  90]],

       [[ 64,  92]],

       [[ 65,  93]],

       [[ 65,  97]],

       [[ 66,  98]],

       [[ 66, 104]],

       [[ 65, 105]],

       [[ 65, 114]],

       [[ 64, 115]],

       [[ 64, 125]],

       [[ 63, 126]],

       [[ 63, 130]],

       [[ 64, 131]],

       [[ 66, 131]],

       [[ 67, 130]],

       [[ 71, 130]],

       [[ 72, 131]],

       [[ 73, 130]],

       [[ 77, 130]],

       [[ 78, 129]],

       [[ 82, 129]],

       [[ 82, 124]],

       [[ 81, 123]],

       [[ 81, 120]],

       [[ 80, 119]],

       [[ 80, 115]],

       [[ 79, 114]],

       [[ 79, 110]],

       [[ 78, 109]],

       [[ 78, 105]],

       [[ 77, 104]],

       [[ 77,  93]],

       [[ 78,  92]],

       [[ 78,  91]],

       [[ 79,  90]],

       [[ 79,  85]],

       [[ 78,  84]],

       [[ 78,  82]],

       [[ 77,  81]],

       [[ 72,  81]],

       [[ 71,  82]],

       [[ 68,  82]],

       [[ 67,  81]]], dtype=np.int32), np.array([[[141,  77]],

       [[140,  78]],

       [[138,  78]],

       [[137,  79]],

       [[133,  79]],

       [[133,  81]],

       [[132,  82]],

       [[132,  84]],

       [[133,  85]],

       [[133,  88]],

       [[134,  89]],

       [[134,  91]],

       [[135,  92]],

       [[135, 114]],

       [[134, 115]],

       [[134, 122]],

       [[135, 122]],

       [[136, 121]],

       [[140, 121]],

       [[141, 122]],

       [[144, 122]],

       [[145, 121]],

       [[147, 121]],

       [[148, 120]],

       [[150, 120]],

       [[151, 121]],

       [[152, 121]],

       [[154, 119]],

       [[154, 116]],

       [[153, 115]],

       [[153, 114]],

       [[152, 113]],

       [[152, 112]],

       [[151, 111]],

       [[151, 107]],

       [[150, 106]],

       [[150, 105]],

       [[149, 104]],

       [[149, 102]],

       [[147, 100]],

       [[147,  96]],

       [[146,  95]],

       [[146,  87]],

       [[147,  86]],

       [[147,  79]],

       [[146,  78]],

       [[146,  77]]], dtype=np.int32), np.array([[[102,  56]],

       [[101,  57]],

       [[ 96,  57]],

       [[ 95,  58]],

       [[ 95,  61]],

       [[ 94,  62]],

       [[ 94,  66]],

       [[ 95,  67]],

       [[ 95,  70]],

       [[ 96,  71]],

       [[ 96,  76]],

       [[ 97,  77]],

       [[ 97,  80]],

       [[ 96,  81]],

       [[ 96,  99]],

       [[ 95, 100]],

       [[ 95, 105]],

       [[ 94, 106]],

       [[ 94, 108]],

       [[ 95, 109]],

       [[ 95, 110]],

       [[107, 110]],

       [[108, 109]],

       [[115, 109]],

       [[116, 108]],

       [[116, 106]],

       [[117, 105]],

       [[116, 104]],

       [[116, 103]],

       [[114, 101]],

       [[114,  96]],

       [[113,  95]],

       [[113,  93]],

       [[112,  92]],

       [[112,  90]],

       [[111,  89]],

       [[111,  86]],

       [[110,  85]],

       [[110,  83]],

       [[109,  82]],

       [[109,  78]],

       [[108,  77]],

       [[108,  70]],

       [[109,  69]],

       [[109,  67]],

       [[110,  66]],

       [[110,  65]],

       [[111,  64]],

       [[111,  61]],

       [[110,  60]],

       [[110,  59]],

       [[109,  58]],

       [[109,  57]],

       [[108,  56]]], dtype=np.int32), np.array([[[129,  44]],

       [[129,  45]],

       [[127,  47]],

       [[127,  51]],

       [[128,  52]],

       [[128,  54]],

       [[129,  55]],

       [[129,  57]],

       [[130,  58]],

       [[130,  61]],

       [[131,  62]],

       [[131,  69]],

       [[130,  70]],

       [[130,  73]],

       [[131,  74]],

       [[131,  76]],

       [[132,  76]],

       [[133,  77]],

       [[134,  76]],

       [[138,  76]],

       [[139,  75]],

       [[140,  75]],

       [[141,  74]],

       [[144,  74]],

       [[145,  73]],

       [[145,  70]],

       [[144,  69]],

       [[144,  68]],

       [[143,  67]],

       [[143,  66]],

       [[140,  63]],

       [[140,  62]],

       [[139,  61]],

       [[139,  60]],

       [[138,  59]],

       [[138,  58]],

       [[137,  57]],

       [[137,  54]],

       [[136,  53]],

       [[136,  48]],

       [[135,  47]],

       [[135,  46]],

       [[133,  44]]], dtype=np.int32), np.array([[[69, 44]],

       [[68, 45]],

       [[67, 45]],

       [[65, 47]],

       [[65, 48]],

       [[64, 49]],

       [[64, 52]],

       [[65, 53]],

       [[65, 56]],

       [[66, 57]],

       [[66, 60]],

       [[67, 61]],

       [[67, 64]],

       [[66, 65]],

       [[66, 68]],

       [[65, 69]],

       [[65, 71]],

       [[64, 72]],

       [[64, 73]],

       [[63, 74]],

       [[63, 76]],

       [[64, 77]],

       [[63, 78]],

       [[64, 79]],

       [[76, 79]],

       [[77, 78]],

       [[79, 78]],

       [[79, 74]],

       [[78, 73]],

       [[78, 72]],

       [[76, 70]],

       [[76, 68]],

       [[75, 67]],

       [[75, 64]],

       [[74, 63]],

       [[74, 55]],

       [[75, 54]],

       [[75, 49]],

       [[74, 48]],

       [[74, 46]],

       [[73, 45]],

       [[70, 45]]], dtype=np.int32), np.array([[[ 95,  20]],

       [[ 92,  23]],

       [[ 92,  27]],

       [[ 94,  29]],

       [[ 94,  35]],

       [[ 95,  36]],

       [[ 95,  44]],

       [[ 94,  45]],

       [[ 94,  47]],

       [[ 93,  48]],

       [[ 93,  54]],

       [[ 94,  54]],

       [[ 95,  55]],

       [[ 97,  55]],

       [[ 98,  54]],

       [[103,  54]],

       [[104,  53]],

       [[107,  53]],

       [[108,  52]],

       [[109,  52]],

       [[109,  48]],

       [[107,  46]],

       [[107,  45]],

       [[106,  44]],

       [[106,  43]],

       [[105,  42]],

       [[105,  41]],

       [[104,  40]],

       [[104,  38]],

       [[103,  37]],

       [[103,  32]],

       [[102,  31]],

       [[103,  30]],

       [[103,  25]],

       [[102,  24]],

       [[102,  22]],

       [[101,  21]],

       [[100,  21]],

       [[ 99,  20]]], dtype=np.int32)]
  
  
  show_segment_tags(segments, 'bug radiography')
  plt.show()
