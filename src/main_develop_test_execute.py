'''
Universidad de La Laguna
Máster en Ingeniería Informática
Trabajo de Final de Máster
Pyimagos development

Visualization of the search execution test
'''

import numpy as np
import cv2 as cv
import matplotlib.pyplot as plt

from src.expected_contours.expected_contour_of_branch import (
  ExpectedContourOfBranch
)
from src.main_develop_test_distal_phalanx import (
  create_minimal_image_from_contours,
)
from src.expected_contours.distal_phalanx import ExpectedContourDistalPhalanx
from src.expected_contours.medial_phalanx import ExpectedContourMedialPhalanx
from src.expected_contours.proximal_phalanx import ExpectedContourProximalPhalanx
from src.expected_contours.metacarpal import ExpectedContourMetacarpal
from src.expected_contours.ulna import ExpectedContourUlna
from src.expected_contours.radius import ExpectedContourRadius
from src.expected_contours.sesamoid import ExpectedContourSesamoid
from src.expected_contours.metacarpal_sesamoid import (
  ExpectedContourSesamoidMetacarpal
)

def show_contours_position_restrictions(
    expected_contours: list, 
    contour_map: list,
    contours: list,
    padding=5,
    title='Position restrictions visualization',
    minimize_image: bool = True,
    show_position_restrictions: bool = True,
    contour_map_mask: list = None,
):
  all_points = np.concatenate(contours)
  all_points = np.reshape(all_points, (-1, 2))
  x_values = all_points[:, 0]
  y_values = all_points[:, 1]

  max_x = int(np.max(x_values))
  max_y = int(np.max(y_values))

  blank_image = np.zeros((max_y + 300, max_x + 25), dtype=np.uint8)

  if minimize_image:
    minimal_image, adjusted_contours = create_minimal_image_from_contours(
      blank_image,
      contours,
      padding
    )
    minimal_image = cv.cvtColor(minimal_image, cv.COLOR_GRAY2RGB)
    contours = adjusted_contours
  else:
    minimal_image = cv.cvtColor(blank_image, cv.COLOR_GRAY2RGB)

  for i, contour in enumerate(contours):
    color = ((i + 1) * 123 % 256, (i + 1) * 456 % 256, (i + 1) * 789 % 256)
    if len(contour) > 0:
      cv.drawContours(minimal_image, contours, i, color, 1)

  if show_position_restrictions:
    for i, expected_contour in enumerate(expected_contours):
      contour_index = contour_map[i]
      if (contour_map_mask is None or
          (contour_map_mask is not None and contour_index in contour_map_mask)):
        expected_contour.prepare(
          contours[contour_index],
          minimal_image.shape[1],
          minimal_image.shape[0]
        )
        color = (
          (contour_index + 1) * 123 % 256,
          (contour_index + 1) * 456 % 256,
          (contour_index + 1) * 789 % 256
        )
        
        if (isinstance(expected_contour, ExpectedContourOfBranch) and
            expected_contour.ends_branchs_sequence):
            try:
              position_restrictions = (
                expected_contour
                .first_in_branch
                .branch_start_position_restrictions()
              )
            except TypeError:
              print('Error: First in branch expected contour not prepared for ' \
                    f'contour index {contour_index} at "{title}" case.')
              position_restrictions = []
        else:
          position_restrictions = expected_contour.next_contour_restrictions()

        for position_restriction in position_restrictions:
          point_a = position_restriction[0]
          point_b = position_restriction[1]
          direction = point_b - point_a
          direction = direction / np.linalg.norm(direction)
          point_a = (point_a - direction * minimal_image.shape[1]).astype(int)
          point_b = (point_b + direction * minimal_image.shape[1]).astype(int)
          cv.line(
            minimal_image,
            point_a,
            point_b,
            color,
            1
          )

        color_rect = (
          max(0, ((contour_index + 1) * 123 % 256) - 50),
          max(0, ((contour_index + 1) * 456 % 256) - 50),
          max(0, ((contour_index + 1) * 789 % 256) - 50),
        )
        rect = cv.minAreaRect(contours[contour_index])
        bounding_rect_contour = cv.boxPoints(rect)
        bounding_rect_contour = np.int32(bounding_rect_contour) # to int
        cv.drawContours(minimal_image, [bounding_rect_contour], 0, color_rect,
                        1)

  fig = plt.figure()
  plt.imshow(minimal_image)
  plt.title(title)
  plt.axis('off')
  fig.canvas.manager.set_window_title(title)

def visualize_execute_tests():
  contours = [
    np.array([[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    ),
    np.array([[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
  ]
  expected_contours = [
    ExpectedContourMedialPhalanx(1),
    ExpectedContourDistalPhalanx(1)
  ]
  contour_map = [0, 1]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Composition.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    ),
    np.array([[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    ),
    np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]],
      dtype=np.int32
    )
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    1,
    0,
    2,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Composition with jump.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]],
          dtype=np.int32
    ),     
    np.array([[[76, 89]],
          [[76, 91]],
          [[75, 92]],
          [[75, 95]],
          [[74, 96]],
          [[74, 97]],
          [[79, 97]],
          [[80, 96]],
          [[85, 96]],
          [[83, 94]],
          [[82, 94]],
          [[79, 91]],
          [[78, 91]]],
          dtype=np.int32
    ),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]],
          dtype=np.int32
    ),
    np.array([[[55, 72]],
          [[54, 73]],
          [[50, 73]],
          [[49, 74]],
          [[47, 74]],
          [[49, 76]],
          [[49, 77]],
          [[52, 80]],
          [[52, 81]],
          [[54, 83]],
          [[57, 83]],
          [[58, 82]],
          [[61, 82]],
          [[61, 81]],
          [[60, 80]],
          [[60, 79]],
          [[59, 78]],
          [[59, 76]],
          [[58, 75]],
          [[58, 74]],
          [[57, 73]],
          [[57, 72]]],
          dtype=np.int32
    ),
    np.array([[[74, 70]],
          [[73, 71]],
          [[72, 71]],
          [[71, 72]],
          [[70, 72]],
          [[70, 76]],
          [[71, 77]],
          [[71, 81]],
          [[78, 81]],
          [[78, 77]],
          [[79, 76]],
          [[79, 74]],
          [[76, 71]],
          [[75, 71]]],
          dtype=np.int32
    ),
    np.array([[[130,  54]],
          [[130,  56]],
          [[131,  57]],
          [[131,  61]],
          [[132,  62]],
          [[132,  64]],
          [[133,  64]],
          [[134,  63]],
          [[137,  63]],
          [[138,  62]],
          [[141,  62]],
          [[142,  61]],
          [[145,  61]],
          [[146,  60]],
          [[147,  60]],
          [[146,  60]],
          [[145,  59]],
          [[143,  59]],
          [[142,  58]],
          [[140,  58]],
          [[139,  57]],
          [[138,  57]],
          [[137,  56]],
          [[135,  56]],
          [[134,  55]],
          [[132,  55]],
          [[131,  54]]],
          dtype=np.int32
    ),
    np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]],
      dtype=np.int32
    ),
    np.array([[[34, 11]],
          [[33, 12]],
          [[33, 13]],
          [[31, 15]],
          [[31, 16]],
          [[29, 18]],
          [[29, 19]],
          [[26, 22]],
          [[26, 23]],
          [[24, 25]],
          [[24, 26]],
          [[23, 27]],
          [[26, 27]],
          [[27, 26]],
          [[33, 26]],
          [[34, 25]],
          [[41, 25]],
          [[42, 24]],
          [[48, 24]],
          [[49, 23]],
          [[52, 23]],
          [[51, 22]],
          [[50, 22]],
          [[48, 20]],
          [[47, 20]],
          [[45, 18]],
          [[44, 18]],
          [[42, 16]],
          [[41, 16]],
          [[39, 14]],
          [[38, 14]],
          [[36, 12]],
          [[35, 12]]],
          dtype=np.int32
    ),
  ]
  contour_map = [
    2,
    0,
    6,
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    distal_phalanx_2,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Noisy with jump.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 39, 116]],
       [[ 38, 117]],
       [[ 36, 117]],
       [[ 35, 118]],
       [[ 34, 118]],
       [[ 33, 119]],
       [[ 29, 119]],
       [[ 28, 118]],
       [[ 24, 118]],
       [[ 22, 120]],
       [[ 22, 125]],
       [[ 24, 127]],
       [[ 24, 128]],
       [[ 25, 129]],
       [[ 25, 134]],
       [[ 26, 135]],
       [[ 26, 136]],
       [[ 27, 137]],
       [[ 27, 142]],
       [[ 28, 143]],
       [[ 28, 151]],
       [[ 29, 152]],
       [[ 29, 153]],
       [[ 37, 153]],
       [[ 38, 152]],
       [[ 43, 152]],
       [[ 44, 151]],
       [[ 45, 151]],
       [[ 46, 150]],
       [[ 47, 150]],
       [[ 48, 149]],
       [[ 53, 149]],
       [[ 54, 148]],
       [[ 55, 148]],
       [[ 55, 145]],
       [[ 50, 140]],
       [[ 50, 139]],
       [[ 47, 136]],
       [[ 47, 135]],
       [[ 45, 133]],
       [[ 45, 132]],
       [[ 44, 131]],
       [[ 44, 124]],
       [[ 45, 123]],
       [[ 45, 121]],
       [[ 46, 120]],
       [[ 42, 116]]],
       dtype=np.int32
    ),
    np.array([[[76, 89]],
       [[76, 91]],
       [[75, 92]],
       [[75, 95]],
       [[74, 96]],
       [[74, 97]],
       [[79, 97]],
       [[80, 96]],
       [[85, 96]],
       [[83, 94]],
       [[82, 94]],
       [[79, 91]],
       [[78, 91]]],
       dtype=np.int32
    ),
    np.array([[[ 27,  85]],
       [[ 26,  86]],
       [[ 23,  86]],
       [[ 21,  88]],
       [[ 21,  91]],
       [[ 22,  92]],
       [[ 22,  93]],
       [[ 23,  94]],
       [[ 23,  96]],
       [[ 24,  97]],
       [[ 24, 100]],
       [[ 25, 101]],
       [[ 25, 102]],
       [[ 24, 103]],
       [[ 24, 106]],
       [[ 23, 107]],
       [[ 23, 108]],
       [[ 22, 109]],
       [[ 22, 110]],
       [[ 21, 111]],
       [[ 21, 115]],
       [[ 22, 116]],
       [[ 33, 116]],
       [[ 34, 115]],
       [[ 37, 115]],
       [[ 38, 114]],
       [[ 41, 114]],
       [[ 42, 113]],
       [[ 43, 113]],
       [[ 42, 112]],
       [[ 42, 111]],
       [[ 43, 110]],
       [[ 42, 109]],
       [[ 41, 109]],
       [[ 36, 104]],
       [[ 36, 103]],
       [[ 34, 101]],
       [[ 34,  98]],
       [[ 33,  97]],
       [[ 33,  94]],
       [[ 34,  93]],
       [[ 34,  87]],
       [[ 33,  86]],
       [[ 30,  86]],
       [[ 29,  85]]],
       dtype=np.int32
    ),
    np.array([[[55, 72]],
       [[54, 73]],
       [[50, 73]],
       [[49, 74]],
       [[47, 74]],
       [[49, 76]],
       [[49, 77]],
       [[52, 80]],
       [[52, 81]],
       [[54, 83]],
       [[57, 83]],
       [[58, 82]],
       [[61, 82]],
       [[61, 81]],
       [[60, 80]],
       [[60, 79]],
       [[59, 78]],
       [[59, 76]],
       [[58, 75]],
       [[58, 74]],
       [[57, 73]],
       [[57, 72]]],
       dtype=np.int32
    ),
    np.array([[[74, 70]],
       [[73, 71]],
       [[72, 71]],
       [[71, 72]],
       [[70, 72]],
       [[70, 76]],
       [[71, 77]],
       [[71, 81]],
       [[78, 81]],
       [[78, 77]],
       [[79, 76]],
       [[79, 74]],
       [[76, 71]],
       [[75, 71]]],
       dtype=np.int32
    ),
    np.array([[[130,  54]],
       [[130,  56]],
       [[131,  57]],
       [[131,  61]],
       [[132,  62]],
       [[132,  64]],
       [[133,  64]],
       [[134,  63]],
       [[137,  63]],
       [[138,  62]],
       [[141,  62]],
       [[142,  61]],
       [[145,  61]],
       [[146,  60]],
       [[147,  60]],
       [[146,  60]],
       [[145,  59]],
       [[143,  59]],
       [[142,  58]],
       [[140,  58]],
       [[139,  57]],
       [[138,  57]],
       [[137,  56]],
       [[135,  56]],
       [[134,  55]],
       [[132,  55]],
       [[131,  54]]],
       dtype=np.int32),
    np.array([[[34, 11]],
       [[33, 12]],
       [[33, 13]],
       [[31, 15]],
       [[31, 16]],
       [[29, 18]],
       [[29, 19]],
       [[26, 22]],
       [[26, 23]],
       [[24, 25]],
       [[24, 26]],
       [[23, 27]],
       [[26, 27]],
       [[27, 26]],
       [[33, 26]],
       [[34, 25]],
       [[41, 25]],
       [[42, 24]],
       [[48, 24]],
       [[49, 23]],
       [[52, 23]],
       [[51, 22]],
       [[50, 22]],
       [[48, 20]],
       [[47, 20]],
       [[45, 18]],
       [[44, 18]],
       [[42, 16]],
       [[41, 16]],
       [[39, 14]],
       [[38, 14]],
       [[36, 12]],
       [[35, 12]]],
       dtype=np.int32
      )
  ]
  expected_contours = [
    ExpectedContourDistalPhalanx(1),
    ExpectedContourMedialPhalanx(1),
  ]
  contour_map = [
    2,
    0,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='All invalid shape after first two ideal.',
    minimize_image=False
  )

  ideal_medial_phalanx = np.array(
    [[[ 37,  97]],
    [[ 36,  98]],
    [[ 34,  98]],
    [[ 33,  99]],
    [[ 32,  99]],
    [[ 31, 100]],
    [[ 27, 100]],
    [[ 26,  99]],
    [[ 22,  99]],
    [[ 20, 101]],
    [[ 20, 106]],
    [[ 22, 108]],
    [[ 22, 109]],
    [[ 23, 110]],
    [[ 23, 115]],
    [[ 24, 116]],
    [[ 24, 117]],
    [[ 25, 118]],
    [[ 25, 123]],
    [[ 26, 124]],
    [[ 26, 132]],
    [[ 27, 133]],
    [[ 27, 134]],
    [[ 35, 134]],
    [[ 36, 133]],
    [[ 41, 133]],
    [[ 42, 132]],
    [[ 43, 132]],
    [[ 44, 131]],
    [[ 45, 131]],
    [[ 46, 130]],
    [[ 51, 130]],
    [[ 52, 129]],
    [[ 53, 129]],
    [[ 53, 126]],
    [[ 48, 121]],
    [[ 48, 120]],
    [[ 45, 117]],
    [[ 45, 116]],
    [[ 43, 114]],
    [[ 43, 113]],
    [[ 42, 112]],
    [[ 42, 105]],
    [[ 43, 104]],
    [[ 43, 102]],
    [[ 44, 101]],
    [[ 40,  97]]],
    dtype=np.int32
  )
  ideal_distal_phalanx = np.array(
    [[[25, 66]],
    [[24, 67]],
    [[21, 67]],
    [[19, 69]],
    [[19, 72]],
    [[20, 73]],
    [[20, 74]],
    [[21, 75]],
    [[21, 77]],
    [[22, 78]],
    [[22, 81]],
    [[23, 82]],
    [[23, 83]],
    [[22, 84]],
    [[22, 87]],
    [[21, 88]],
    [[21, 89]],
    [[20, 90]],
    [[20, 91]],
    [[19, 92]],
    [[19, 96]],
    [[20, 97]],
    [[31, 97]],
    [[32, 96]],
    [[35, 96]],
    [[36, 95]],
    [[39, 95]],
    [[40, 94]],
    [[41, 94]],
    [[40, 93]],
    [[40, 92]],
    [[41, 91]],
    [[40, 90]],
    [[39, 90]],
    [[34, 85]],
    [[34, 84]],
    [[32, 82]],
    [[32, 79]],
    [[31, 78]],
    [[31, 75]],
    [[32, 74]],
    [[32, 68]],
    [[31, 67]],
    [[28, 67]],
    [[27, 66]]],
    dtype=np.int32
  )
  contours = [
    ideal_distal_phalanx,
    ideal_medial_phalanx,
  ]
  expected_contours = [
    ExpectedContourDistalPhalanx(1),
    ExpectedContourMedialPhalanx(1),
  ]
  contour_map = [0, 1]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Not enough candidate contours after first two ideal.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 53, 151]],
          [[ 51, 153]],
          [[ 49, 153]],
          [[ 48, 154]],
          [[ 46, 154]],
          [[ 45, 155]],
          [[ 37, 155]],
          [[ 36, 156]],
          [[ 35, 156]],
          [[ 35, 164]],
          [[ 38, 167]],
          [[ 38, 168]],
          [[ 40, 170]],
          [[ 40, 171]],
          [[ 42, 173]],
          [[ 42, 174]],
          [[ 43, 175]],
          [[ 43, 177]],
          [[ 44, 178]],
          [[ 44, 180]],
          [[ 45, 181]],
          [[ 45, 183]],
          [[ 46, 184]],
          [[ 46, 185]],
          [[ 47, 186]],
          [[ 47, 187]],
          [[ 48, 188]],
          [[ 48, 191]],
          [[ 49, 192]],
          [[ 49, 195]],
          [[ 50, 196]],
          [[ 50, 203]],
          [[ 49, 204]],
          [[ 49, 211]],
          [[ 51, 213]],
          [[ 59, 213]],
          [[ 60, 212]],
          [[ 61, 212]],
          [[ 62, 211]],
          [[ 64, 211]],
          [[ 65, 210]],
          [[ 67, 210]],
          [[ 68, 209]],
          [[ 71, 209]],
          [[ 72, 208]],
          [[ 83, 208]],
          [[ 84, 207]],
          [[ 85, 207]],
          [[ 85, 205]],
          [[ 86, 204]],
          [[ 86, 202]],
          [[ 85, 201]],
          [[ 85, 200]],
          [[ 84, 199]],
          [[ 83, 199]],
          [[ 70, 186]],
          [[ 70, 185]],
          [[ 68, 183]],
          [[ 68, 182]],
          [[ 67, 181]],
          [[ 67, 180]],
          [[ 65, 178]],
          [[ 65, 177]],
          [[ 64, 176]],
          [[ 64, 175]],
          [[ 63, 174]],
          [[ 63, 173]],
          [[ 62, 172]],
          [[ 62, 170]],
          [[ 60, 168]],
          [[ 60, 163]],
          [[ 59, 162]],
          [[ 59, 160]],
          [[ 60, 159]],
          [[ 60, 158]],
          [[ 59, 157]],
          [[ 59, 155]],
          [[ 58, 154]],
          [[ 57, 154]],
          [[ 54, 151]]], 
          dtype=np.int32
    ),
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]],
          dtype=np.int32
    ),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]], 
          dtype=np.int32
    ),
    np.array( [[[ 98,  35]],
            [[ 97,  36]],
            [[ 96,  36]],
            [[ 94,  38]],
            [[ 94,  39]],
            [[ 93,  40]],
            [[ 93,  42]],
            [[ 94,  43]],
            [[ 94,  44]],
            [[ 95,  45]],
            [[ 95,  47]],
            [[ 96,  48]],
            [[ 96,  50]],
            [[ 95,  51]],
            [[ 95,  54]],
            [[ 94,  55]],
            [[ 94,  56]],
            [[ 93,  57]],
            [[ 93,  58]],
            [[ 88,  63]],
            [[ 88,  67]],
            [[ 90,  67]],
            [[ 91,  68]],
            [[ 98,  68]],
            [[ 99,  69]],
            [[104,  69]],
            [[105,  68]],
            [[111,  68]],
            [[112,  67]],
            [[115,  67]],
            [[115,  63]],
            [[110,  58]],
            [[110,  57]],
            [[109,  56]],
            [[109,  55]],
            [[108,  54]],
            [[108,  50]],
            [[109,  49]],
            [[109,  46]],
            [[110,  45]],
            [[110,  44]],
            [[111,  43]],
            [[111,  41]],
            [[110,  40]],
            [[110,  37]],
            [[109,  37]],
            [[108,  36]],
            [[106,  36]],
            [[105,  35]]], 
            dtype=np.int32
      )
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(1)
  proximal_phalanx_1 = ExpectedContourProximalPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    proximal_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    2,
    1,
    0,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Proximal phalanx with jump.',
    minimize_image=False
  )

  contours = [
    np.array([[[ 73, 211]],
      [[ 72, 212]],
      [[ 68, 212]],
      [[ 67, 213]],
      [[ 65, 213]],
      [[ 64, 214]],
      [[ 63, 214]],
      [[ 62, 215]],
      [[ 61, 215]],
      [[ 59, 217]],
      [[ 59, 218]],
      [[ 58, 219]],
      [[ 58, 220]],
      [[ 59, 221]],
      [[ 59, 225]],
      [[ 58, 226]],
      [[ 58, 229]],
      [[ 62, 233]],
      [[ 62, 234]],
      [[ 65, 237]],
      [[ 65, 238]],
      [[ 67, 240]],
      [[ 67, 241]],
      [[ 70, 244]],
      [[ 70, 245]],
      [[ 72, 247]],
      [[ 72, 248]],
      [[ 73, 249]],
      [[ 73, 250]],
      [[ 74, 251]],
      [[ 74, 252]],
      [[ 75, 253]],
      [[ 75, 254]],
      [[ 77, 256]],
      [[ 77, 257]],
      [[ 78, 258]],
      [[ 78, 259]],
      [[ 79, 260]],
      [[ 79, 261]],
      [[ 80, 262]],
      [[ 80, 263]],
      [[ 81, 264]],
      [[ 81, 265]],
      [[ 82, 266]],
      [[ 82, 267]],
      [[ 83, 268]],
      [[ 83, 269]],
      [[ 84, 270]],
      [[ 84, 271]],
      [[ 85, 272]],
      [[ 85, 273]],
      [[ 86, 274]],
      [[ 86, 276]],
      [[ 87, 277]],
      [[ 87, 280]],
      [[ 88, 281]],
      [[ 88, 285]],
      [[ 89, 286]],
      [[ 89, 295]],
      [[ 90, 296]],
      [[ 90, 298]],
      [[ 91, 299]],
      [[ 91, 300]],
      [[ 94, 303]],
      [[ 96, 303]],
      [[ 97, 304]],
      [[100, 304]],
      [[101, 305]],
      [[103, 305]],
      [[104, 304]],
      [[105, 304]],
      [[106, 303]],
      [[106, 302]],
      [[108, 300]],
      [[108, 299]],
      [[110, 297]],
      [[110, 296]],
      [[113, 293]],
      [[113, 292]],
      [[115, 290]],
      [[115, 289]],
      [[117, 287]],
      [[117, 286]],
      [[118, 285]],
      [[116, 283]],
      [[116, 282]],
      [[115, 282]],
      [[106, 273]],
      [[106, 272]],
      [[104, 270]],
      [[104, 269]],
      [[102, 267]],
      [[102, 266]],
      [[100, 264]],
      [[100, 263]],
      [[ 99, 262]],
      [[ 99, 261]],
      [[ 98, 260]],
      [[ 98, 259]],
      [[ 97, 258]],
      [[ 97, 257]],
      [[ 96, 256]],
      [[ 96, 255]],
      [[ 95, 254]],
      [[ 95, 253]],
      [[ 94, 252]],
      [[ 94, 250]],
      [[ 93, 249]],
      [[ 93, 248]],
      [[ 92, 247]],
      [[ 92, 246]],
      [[ 91, 245]],
      [[ 91, 243]],
      [[ 90, 242]],
      [[ 90, 240]],
      [[ 89, 239]],
      [[ 89, 237]],
      [[ 88, 236]],
      [[ 88, 227]],
      [[ 87, 226]],
      [[ 87, 223]],
      [[ 86, 222]],
      [[ 86, 220]],
      [[ 78, 212]],
      [[ 76, 212]],
      [[ 75, 211]]], 
      dtype=np.int32),
    np.array([[[ 53, 151]],
          [[ 51, 153]],
          [[ 49, 153]],
          [[ 48, 154]],
          [[ 46, 154]],
          [[ 45, 155]],
          [[ 37, 155]],
          [[ 36, 156]],
          [[ 35, 156]],
          [[ 35, 164]],
          [[ 38, 167]],
          [[ 38, 168]],
          [[ 40, 170]],
          [[ 40, 171]],
          [[ 42, 173]],
          [[ 42, 174]],
          [[ 43, 175]],
          [[ 43, 177]],
          [[ 44, 178]],
          [[ 44, 180]],
          [[ 45, 181]],
          [[ 45, 183]],
          [[ 46, 184]],
          [[ 46, 185]],
          [[ 47, 186]],
          [[ 47, 187]],
          [[ 48, 188]],
          [[ 48, 191]],
          [[ 49, 192]],
          [[ 49, 195]],
          [[ 50, 196]],
          [[ 50, 203]],
          [[ 49, 204]],
          [[ 49, 211]],
          [[ 51, 213]],
          [[ 59, 213]],
          [[ 60, 212]],
          [[ 61, 212]],
          [[ 62, 211]],
          [[ 64, 211]],
          [[ 65, 210]],
          [[ 67, 210]],
          [[ 68, 209]],
          [[ 71, 209]],
          [[ 72, 208]],
          [[ 83, 208]],
          [[ 84, 207]],
          [[ 85, 207]],
          [[ 85, 205]],
          [[ 86, 204]],
          [[ 86, 202]],
          [[ 85, 201]],
          [[ 85, 200]],
          [[ 84, 199]],
          [[ 83, 199]],
          [[ 70, 186]],
          [[ 70, 185]],
          [[ 68, 183]],
          [[ 68, 182]],
          [[ 67, 181]],
          [[ 67, 180]],
          [[ 65, 178]],
          [[ 65, 177]],
          [[ 64, 176]],
          [[ 64, 175]],
          [[ 63, 174]],
          [[ 63, 173]],
          [[ 62, 172]],
          [[ 62, 170]],
          [[ 60, 168]],
          [[ 60, 163]],
          [[ 59, 162]],
          [[ 59, 160]],
          [[ 60, 159]],
          [[ 60, 158]],
          [[ 59, 157]],
          [[ 59, 155]],
          [[ 58, 154]],
          [[ 57, 154]],
          [[ 54, 151]]], 
          dtype=np.int32),
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]], 
          dtype=np.int32),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]], 
          dtype=np.int32),
    np.array([[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 99,  68]],
      [[100,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]], 
      dtype=np.int32)
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(1)
  proximal_phalanx_1 = ExpectedContourProximalPhalanx(1)
  metacarpal_phalanx_1 = ExpectedContourMetacarpal(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    proximal_phalanx_1,
    metacarpal_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    3,
    2,
    1,
    0,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Metacarpal with jump',
    minimize_image=False,
  )

  contours = [
      np.array([[[317, 252]],
      [[316, 253]],
      [[314, 253]],
      [[313, 254]],
      [[309, 254]],
      [[309, 255]],
      [[306, 258]],
      [[305, 258]],
      [[303, 260]],
      [[303, 261]],
      [[301, 263]],
      [[299, 263]],
      [[298, 264]],
      [[298, 265]],
      [[292, 271]],
      [[291, 271]],
      [[287, 275]],
      [[286, 275]],
      [[284, 277]],
      [[283, 277]],
      [[280, 280]],
      [[279, 280]],
      [[277, 282]],
      [[276, 282]],
      [[275, 283]],
      [[274, 283]],
      [[273, 284]],
      [[272, 284]],
      [[271, 285]],
      [[270, 285]],
      [[268, 287]],
      [[266, 287]],
      [[265, 288]],
      [[264, 288]],
      [[263, 289]],
      [[261, 289]],
      [[260, 290]],
      [[257, 290]],
      [[256, 291]],
      [[253, 291]],
      [[252, 292]],
      [[247, 292]],
      [[246, 293]],
      [[243, 293]],
      [[242, 294]],
      [[240, 294]],
      [[239, 295]],
      [[236, 295]],
      [[235, 296]],
      [[233, 296]],
      [[230, 299]],
      [[230, 303]],
      [[232, 305]],
      [[232, 306]],
      [[235, 309]],
      [[236, 309]],
      [[238, 311]],
      [[238, 315]],
      [[239, 316]],
      [[240, 316]],
      [[242, 318]],
      [[243, 318]],
      [[244, 319]],
      [[250, 319]],
      [[251, 320]],
      [[253, 320]],
      [[254, 319]],
      [[256, 319]],
      [[257, 318]],
      [[258, 318]],
      [[259, 317]],
      [[260, 317]],
      [[261, 316]],
      [[263, 316]],
      [[265, 314]],
      [[266, 314]],
      [[267, 313]],
      [[268, 313]],
      [[271, 310]],
      [[272, 310]],
      [[277, 305]],
      [[278, 305]],
      [[280, 303]],
      [[281, 303]],
      [[283, 301]],
      [[284, 301]],
      [[286, 299]],
      [[287, 299]],
      [[289, 297]],
      [[290, 297]],
      [[292, 295]],
      [[293, 295]],
      [[294, 294]],
      [[295, 294]],
      [[296, 293]],
      [[297, 293]],
      [[299, 291]],
      [[300, 291]],
      [[301, 290]],
      [[302, 290]],
      [[304, 288]],
      [[305, 288]],
      [[306, 287]],
      [[307, 287]],
      [[308, 286]],
      [[309, 286]],
      [[311, 284]],
      [[312, 284]],
      [[314, 282]],
      [[315, 282]],
      [[316, 281]],
      [[317, 281]],
      [[318, 280]],
      [[319, 280]],
      [[321, 278]],
      [[323, 278]],
      [[324, 277]],
      [[325, 277]],
      [[326, 276]],
      [[327, 276]],
      [[328, 275]],
      [[329, 275]],
      [[331, 273]],
      [[332, 273]],
      [[332, 272]],
      [[334, 270]],
      [[334, 269]],
      [[335, 268]],
      [[335, 264]],
      [[334, 263]],
      [[334, 262]],
      [[332, 260]],
      [[331, 260]],
      [[328, 257]],
      [[327, 257]],
      [[326, 256]],
      [[325, 256]],
      [[324, 255]],
      [[323, 255]],
      [[321, 253]],
      [[320, 253]],
      [[319, 252]]]), # checked
      np.array([[[73, 211]],
      [[ 72, 212]],
      [[ 68, 212]],
      [[ 67, 213]],
      [[ 65, 213]],
      [[ 64, 214]],
      [[ 63, 214]],
      [[ 62, 215]],
      [[ 61, 215]],
      [[ 59, 217]],
      [[ 59, 218]],
      [[ 58, 219]],
      [[ 58, 220]],
      [[ 59, 221]],
      [[ 59, 225]],
      [[ 58, 226]],
      [[ 58, 229]],
      [[ 62, 233]],
      [[ 62, 234]],
      [[ 65, 237]],
      [[ 65, 238]],
      [[ 67, 240]],
      [[ 67, 241]],
      [[ 70, 244]],
      [[ 70, 245]],
      [[ 72, 247]],
      [[ 72, 248]],
      [[ 73, 249]],
      [[ 73, 250]],
      [[ 74, 251]],
      [[ 74, 252]],
      [[ 75, 253]],
      [[ 75, 254]],
      [[ 77, 256]],
      [[ 77, 257]],
      [[ 78, 258]],
      [[ 78, 259]],
      [[ 79, 260]],
      [[ 79, 261]],
      [[ 80, 262]],
      [[ 80, 263]],
      [[ 81, 264]],
      [[ 81, 265]],
      [[ 82, 266]],
      [[ 82, 267]],
      [[ 83, 268]],
      [[ 83, 269]],
      [[ 84, 270]],
      [[ 84, 271]],
      [[ 85, 272]],
      [[ 85, 273]],
      [[ 86, 274]],
      [[ 86, 276]],
      [[ 87, 277]],
      [[ 87, 280]],
      [[ 88, 281]],
      [[ 88, 285]],
      [[ 89, 286]],
      [[ 89, 295]],
      [[ 90, 296]],
      [[ 90, 298]],
      [[ 91, 299]],
      [[ 91, 300]],
      [[ 94, 303]],
      [[ 96, 303]],
      [[ 97, 304]],
      [[100, 304]],
      [[101, 305]],
      [[103, 305]],
      [[104, 304]],
      [[105, 304]],
      [[106, 303]],
      [[106, 302]],
      [[108, 300]],
      [[108, 299]],
      [[110, 297]],
      [[110, 296]],
      [[113, 293]],
      [[113, 292]],
      [[115, 290]],
      [[115, 289]],
      [[117, 287]],
      [[117, 286]],
      [[118, 285]],
      [[116, 283]],
      [[116, 282]],
      [[115, 282]],
      [[106, 273]],
      [[106, 272]],
      [[104, 270]],
      [[104, 269]],
      [[102, 267]],
      [[102, 266]],
      [[100, 264]],
      [[100, 263]],
      [[ 99, 262]],
      [[ 99, 261]],
      [[ 98, 260]],
      [[ 98, 259]],
      [[ 97, 258]],
      [[ 97, 257]],
      [[ 96, 256]],
      [[ 96, 255]],
      [[ 95, 254]],
      [[ 95, 253]],
      [[ 94, 252]],
      [[ 94, 250]],
      [[ 93, 249]],
      [[ 93, 248]],
      [[ 92, 247]],
      [[ 92, 246]],
      [[ 91, 245]],
      [[ 91, 243]],
      [[ 90, 242]],
      [[ 90, 240]],
      [[ 89, 239]],
      [[ 89, 237]],
      [[ 88, 236]],
      [[ 88, 227]],
      [[ 87, 226]],
      [[ 87, 223]],
      [[ 86, 222]],
      [[ 86, 220]],
      [[ 78, 212]],
      [[ 76, 212]],
      [[ 75, 211]]]), # checked
      np.array(
      [[[356, 201]],
      [[355, 202]],
      [[350, 202]],
      [[349, 203]],
      [[348, 203]],
      [[347, 204]],
      [[346, 204]],
      [[345, 205]],
      [[344, 205]],
      [[343, 206]],
      [[343, 210]],
      [[344, 211]],
      [[344, 215]],
      [[343, 216]],
      [[343, 217]],
      [[341, 219]],
      [[341, 220]],
      [[335, 226]],
      [[334, 226]],
      [[331, 229]],
      [[330, 229]],
      [[328, 231]],
      [[327, 231]],
      [[326, 232]],
      [[325, 232]],
      [[324, 233]],
      [[323, 233]],
      [[322, 234]],
      [[321, 234]],
      [[320, 235]],
      [[319, 235]],
      [[318, 236]],
      [[317, 236]],
      [[316, 237]],
      [[315, 237]],
      [[314, 238]],
      [[312, 238]],
      [[311, 239]],
      [[310, 239]],
      [[307, 242]],
      [[307, 247]],
      [[309, 249]],
      [[316, 249]],
      [[317, 250]],
      [[320, 250]],
      [[321, 251]],
      [[322, 251]],
      [[323, 252]],
      [[324, 252]],
      [[325, 253]],
      [[327, 253]],
      [[328, 254]],
      [[329, 254]],
      [[332, 257]],
      [[332, 258]],
      [[335, 258]],
      [[336, 259]],
      [[339, 259]],
      [[340, 258]],
      [[343, 258]],
      [[344, 257]],
      [[344, 255]],
      [[345, 254]],
      [[345, 252]],
      [[346, 251]],
      [[346, 250]],
      [[347, 249]],
      [[347, 247]],
      [[348, 246]],
      [[348, 245]],
      [[349, 244]],
      [[349, 243]],
      [[351, 241]],
      [[351, 240]],
      [[354, 237]],
      [[354, 236]],
      [[359, 231]],
      [[359, 230]],
      [[367, 222]],
      [[368, 222]],
      [[374, 216]],
      [[374, 215]],
      [[376, 213]],
      [[373, 210]],
      [[372, 210]],
      [[371, 209]],
      [[370, 209]],
      [[367, 206]],
      [[366, 206]],
      [[363, 203]],
      [[362, 203]],
      [[361, 202]],
      [[360, 202]],
      [[359, 201]]]), # checked
      np.array(
      [[[116, 196]],
      [[115, 197]],
      [[110, 197]],
      [[109, 198]],
      [[106, 198]],
      [[105, 199]],
      [[104, 199]],
      [[102, 201]],
      [[102, 204]],
      [[103, 205]],
      [[103, 212]],
      [[104, 213]],
      [[104, 214]],
      [[107, 217]],
      [[107, 218]],
      [[109, 220]],
      [[109, 221]],
      [[110, 222]],
      [[110, 224]],
      [[111, 225]],
      [[111, 226]],
      [[112, 227]],
      [[112, 229]],
      [[113, 230]],
      [[113, 232]],
      [[114, 233]],
      [[114, 235]],
      [[115, 236]],
      [[115, 238]],
      [[116, 239]],
      [[116, 240]],
      [[117, 241]],
      [[117, 243]],
      [[118, 244]],
      [[118, 247]],
      [[119, 248]],
      [[119, 250]],
      [[120, 251]],
      [[120, 253]],
      [[121, 254]],
      [[121, 257]],
      [[122, 258]],
      [[122, 260]],
      [[123, 261]],
      [[123, 264]],
      [[124, 265]],
      [[124, 269]],
      [[125, 270]],
      [[125, 274]],
      [[124, 275]],
      [[124, 279]],
      [[123, 280]],
      [[123, 282]],
      [[124, 282]],
      [[125, 283]],
      [[126, 283]],
      [[127, 284]],
      [[128, 284]],
      [[129, 285]],
      [[131, 285]],
      [[132, 286]],
      [[133, 286]],
      [[134, 287]],
      [[135, 287]],
      [[136, 288]],
      [[138, 288]],
      [[139, 289]],
      [[140, 289]],
      [[141, 290]],
      [[143, 290]],
      [[144, 291]],
      [[145, 291]],
      [[146, 292]],
      [[147, 292]],
      [[148, 293]],
      [[149, 293]],
      [[149, 282]],
      [[148, 281]],
      [[148, 279]],
      [[147, 278]],
      [[147, 277]],
      [[146, 276]],
      [[146, 275]],
      [[143, 272]],
      [[143, 271]],
      [[141, 269]],
      [[141, 268]],
      [[140, 267]],
      [[140, 266]],
      [[139, 265]],
      [[139, 263]],
      [[138, 262]],
      [[138, 261]],
      [[137, 260]],
      [[137, 258]],
      [[136, 257]],
      [[136, 255]],
      [[135, 254]],
      [[135, 250]],
      [[134, 249]],
      [[134, 246]],
      [[133, 245]],
      [[133, 240]],
      [[132, 239]],
      [[132, 231]],
      [[131, 230]],
      [[131, 229]],
      [[132, 228]],
      [[132, 226]],
      [[131, 225]],
      [[131, 223]],
      [[132, 222]],
      [[132, 218]],
      [[133, 217]],
      [[133, 215]],
      [[134, 214]],
      [[134, 210]],
      [[133, 209]],
      [[133, 206]],
      [[131, 204]],
      [[131, 203]],
      [[129, 201]],
      [[129, 200]],
      [[128, 199]],
      [[128, 198]],
      [[127, 197]],
      [[124, 197]],
      [[123, 196]],
      [[122, 196]],
      [[121, 197]],
      [[120, 196]],
      [[118, 196]],
      [[117, 197]]]), # checked
      np.array(
      [[[156, 177]],
      [[155, 178]],
      [[151, 178]],
      [[150, 179]],
      [[149, 179]],
      [[147, 181]],
      [[147, 183]],
      [[146, 184]],
      [[146, 187]],
      [[145, 188]],
      [[145, 196]],
      [[147, 198]],
      [[147, 200]],
      [[148, 201]],
      [[148, 202]],
      [[149, 203]],
      [[149, 205]],
      [[150, 206]],
      [[150, 208]],
      [[151, 209]],
      [[151, 212]],
      [[152, 213]],
      [[152, 216]],
      [[153, 217]],
      [[153, 221]],
      [[154, 222]],
      [[154, 226]],
      [[155, 227]],
      [[155, 232]],
      [[156, 233]],
      [[156, 240]],
      [[157, 241]],
      [[157, 267]],
      [[156, 268]],
      [[156, 272]],
      [[155, 273]],
      [[155, 276]],
      [[154, 277]],
      [[154, 284]],
      [[153, 285]],
      [[153, 292]],
      [[152, 293]],
      [[152, 294]],
      [[153, 294]],
      [[154, 293]],
      [[155, 293]],
      [[156, 292]],
      [[157, 292]],
      [[158, 291]],
      [[159, 291]],
      [[160, 290]],
      [[161, 290]],
      [[162, 289]],
      [[163, 289]],
      [[164, 288]],
      [[165, 288]],
      [[166, 287]],
      [[167, 287]],
      [[168, 286]],
      [[170, 286]],
      [[171, 285]],
      [[172, 285]],
      [[173, 284]],
      [[174, 284]],
      [[175, 283]],
      [[176, 283]],
      [[177, 282]],
      [[178, 282]],
      [[179, 281]],
      [[180, 281]],
      [[181, 280]],
      [[182, 280]],
      [[183, 279]],
      [[184, 279]],
      [[185, 278]],
      [[186, 278]],
      [[187, 277]],
      [[188, 277]],
      [[188, 276]],
      [[187, 275]],
      [[187, 274]],
      [[186, 273]],
      [[186, 272]],
      [[183, 269]],
      [[183, 268]],
      [[181, 266]],
      [[181, 265]],
      [[180, 264]],
      [[180, 263]],
      [[179, 262]],
      [[179, 258]],
      [[178, 257]],
      [[178, 254]],
      [[177, 253]],
      [[177, 244]],
      [[176, 243]],
      [[176, 217]],
      [[177, 216]],
      [[177, 210]],
      [[178, 209]],
      [[178, 207]],
      [[179, 206]],
      [[179, 204]],
      [[181, 202]],
      [[181, 199]],
      [[182, 198]],
      [[182, 197]],
      [[181, 196]],
      [[181, 195]],
      [[180, 194]],
      [[181, 193]],
      [[180, 192]],
      [[180, 190]],
      [[179, 189]],
      [[179, 188]],
      [[177, 186]],
      [[177, 185]],
      [[174, 182]],
      [[175, 181]],
      [[173, 179]],
      [[171, 179]],
      [[170, 178]],
      [[167, 178]],
      [[166, 177]]]), # checked
      np.array(
      [[[220, 173]],
      [[219, 174]],
      [[214, 174]],
      [[213, 175]],
      [[212, 175]],
      [[211, 176]],
      [[211, 178]],
      [[210, 179]],
      [[210, 181]],
      [[208, 183]],
      [[208, 184]],
      [[207, 185]],
      [[207, 189]],
      [[208, 190]],
      [[208, 195]],
      [[207, 196]],
      [[207, 197]],
      [[208, 198]],
      [[208, 208]],
      [[209, 209]],
      [[209, 215]],
      [[210, 216]],
      [[210, 220]],
      [[209, 221]],
      [[209, 231]],
      [[208, 232]],
      [[208, 236]],
      [[207, 237]],
      [[207, 241]],
      [[206, 242]],
      [[206, 246]],
      [[205, 247]],
      [[205, 250]],
      [[204, 251]],
      [[204, 253]],
      [[203, 254]],
      [[203, 256]],
      [[202, 257]],
      [[202, 259]],
      [[201, 260]],
      [[201, 261]],
      [[200, 262]],
      [[200, 263]],
      [[199, 264]],
      [[199, 265]],
      [[198, 266]],
      [[198, 267]],
      [[197, 268]],
      [[197, 269]],
      [[196, 270]],
      [[196, 271]],
      [[195, 272]],
      [[195, 273]],
      [[191, 277]],
      [[191, 278]],
      [[190, 279]],
      [[189, 279]],
      [[186, 282]],
      [[186, 284]],
      [[185, 285]],
      [[187, 285]],
      [[188, 286]],
      [[191, 286]],
      [[192, 287]],
      [[196, 287]],
      [[197, 288]],
      [[200, 288]],
      [[201, 289]],
      [[204, 289]],
      [[205, 290]],
      [[209, 290]],
      [[210, 291]],
      [[213, 291]],
      [[214, 292]],
      [[218, 292]],
      [[219, 293]],
      [[222, 293]],
      [[223, 294]],
      [[225, 294]],
      [[225, 293]],
      [[226, 292]],
      [[226, 291]],
      [[227, 290]],
      [[227, 289]],
      [[228, 288]],
      [[228, 286]],
      [[227, 285]],
      [[227, 284]],
      [[226, 283]],
      [[226, 282]],
      [[225, 281]],
      [[225, 278]],
      [[224, 277]],
      [[224, 260]],
      [[225, 259]],
      [[225, 254]],
      [[226, 253]],
      [[226, 250]],
      [[227, 249]],
      [[227, 246]],
      [[228, 245]],
      [[228, 241]],
      [[229, 240]],
      [[229, 236]],
      [[230, 235]],
      [[230, 232]],
      [[231, 231]],
      [[231, 228]],
      [[232, 227]],
      [[232, 223]],
      [[233, 222]],
      [[233, 220]],
      [[234, 219]],
      [[234, 216]],
      [[235, 215]],
      [[235, 212]],
      [[236, 211]],
      [[236, 210]],
      [[237, 209]],
      [[237, 207]],
      [[238, 206]],
      [[238, 204]],
      [[239, 203]],
      [[239, 201]],
      [[241, 199]],
      [[241, 198]],
      [[242, 197]],
      [[242, 194]],
      [[243, 193]],
      [[243, 191]],
      [[242, 190]],
      [[242, 186]],
      [[241, 185]],
      [[241, 184]],
      [[240, 183]],
      [[240, 182]],
      [[235, 177]],
      [[234, 177]],
      [[232, 175]],
      [[229, 175]],
      [[228, 174]],
      [[224, 174]],
      [[223, 173]]]), # checked
      np.array(
      [[[391, 172]],
      [[390, 173]],
      [[388, 173]],
      [[385, 176]],
      [[384, 176]],
      [[382, 178]],
      [[382, 179]],
      [[379, 182]],
      [[378, 182]],
      [[376, 184]],
      [[375, 184]],
      [[373, 186]],
      [[372, 186]],
      [[371, 187]],
      [[370, 187]],
      [[369, 188]],
      [[367, 188]],
      [[366, 189]],
      [[365, 189]],
      [[364, 190]],
      [[363, 190]],
      [[362, 191]],
      [[359, 191]],
      [[358, 192]],
      [[356, 192]],
      [[355, 193]],
      [[354, 193]],
      [[352, 195]],
      [[352, 196]],
      [[353, 197]],
      [[353, 198]],
      [[356, 198]],
      [[357, 199]],
      [[360, 199]],
      [[361, 200]],
      [[364, 200]],
      [[367, 203]],
      [[367, 204]],
      [[368, 204]],
      [[370, 206]],
      [[372, 206]],
      [[373, 207]],
      [[374, 207]],
      [[376, 209]],
      [[376, 210]],
      [[377, 209]],
      [[379, 209]],
      [[380, 208]],
      [[380, 206]],
      [[381, 205]],
      [[381, 203]],
      [[382, 202]],
      [[382, 200]],
      [[383, 199]],
      [[383, 198]],
      [[385, 196]],
      [[385, 195]],
      [[395, 185]],
      [[396, 185]],
      [[398, 183]],
      [[400, 183]],
      [[404, 179]],
      [[403, 179]],
      [[402, 178]],
      [[402, 175]],
      [[400, 173]],
      [[399, 173]],
      [[398, 172]],
      [[397, 173]],
      [[395, 173]],
      [[394, 172]]]), # checked
      np.array(
      [[[ 53, 151]],
      [[ 51, 153]],
      [[ 49, 153]],
      [[ 48, 154]],
      [[ 46, 154]],
      [[ 45, 155]],
      [[ 37, 155]],
      [[ 36, 156]],
      [[ 35, 156]],
      [[ 35, 164]],
      [[ 38, 167]],
      [[ 38, 168]],
      [[ 40, 170]],
      [[ 40, 171]],
      [[ 42, 173]],
      [[ 42, 174]],
      [[ 43, 175]],
      [[ 43, 177]],
      [[ 44, 178]],
      [[ 44, 180]],
      [[ 45, 181]],
      [[ 45, 183]],
      [[ 46, 184]],
      [[ 46, 185]],
      [[ 47, 186]],
      [[ 47, 187]],
      [[ 48, 188]],
      [[ 48, 191]],
      [[ 49, 192]],
      [[ 49, 195]],
      [[ 50, 196]],
      [[ 50, 203]],
      [[ 49, 204]],
      [[ 49, 211]],
      [[ 51, 213]],
      [[ 59, 213]],
      [[ 60, 212]],
      [[ 61, 212]],
      [[ 62, 211]],
      [[ 64, 211]],
      [[ 65, 210]],
      [[ 67, 210]],
      [[ 68, 209]],
      [[ 71, 209]],
      [[ 72, 208]],
      [[ 83, 208]],
      [[ 84, 207]],
      [[ 85, 207]],
      [[ 85, 205]],
      [[ 86, 204]],
      [[ 86, 202]],
      [[ 85, 201]],
      [[ 85, 200]],
      [[ 84, 199]],
      [[ 83, 199]],
      [[ 70, 186]],
      [[ 70, 185]],
      [[ 68, 183]],
      [[ 68, 182]],
      [[ 67, 181]],
      [[ 67, 180]],
      [[ 65, 178]],
      [[ 65, 177]],
      [[ 64, 176]],
      [[ 64, 175]],
      [[ 63, 174]],
      [[ 63, 173]],
      [[ 62, 172]],
      [[ 62, 170]],
      [[ 60, 168]],
      [[ 60, 163]],
      [[ 59, 162]],
      [[ 59, 160]],
      [[ 60, 159]],
      [[ 60, 158]],
      [[ 59, 157]],
      [[ 59, 155]],
      [[ 58, 154]],
      [[ 57, 154]],
      [[ 54, 151]]]), # checked
      np.array(
      [[[112, 121]],
      [[111, 122]],
      [[ 95, 122]],
      [[ 94, 123]],
      [[ 94, 125]],
      [[ 93, 126]],
      [[ 93, 129]],
      [[ 92, 130]],
      [[ 93, 131]],
      [[ 92, 132]],
      [[ 93, 133]],
      [[ 93, 134]],
      [[ 94, 135]],
      [[ 94, 136]],
      [[ 96, 138]],
      [[ 96, 142]],
      [[ 97, 143]],
      [[ 97, 148]],
      [[ 98, 149]],
      [[ 98, 152]],
      [[ 99, 153]],
      [[ 99, 155]],
      [[100, 156]],
      [[100, 158]],
      [[101, 159]],
      [[101, 162]],
      [[102, 163]],
      [[102, 179]],
      [[101, 180]],
      [[101, 182]],
      [[100, 183]],
      [[100, 187]],
      [[ 99, 188]],
      [[ 99, 190]],
      [[100, 191]],
      [[100, 193]],
      [[101, 194]],
      [[102, 194]],
      [[103, 195]],
      [[106, 195]],
      [[107, 194]],
      [[113, 194]],
      [[114, 193]],
      [[125, 193]],
      [[126, 194]],
      [[130, 194]],
      [[131, 193]],
      [[133, 193]],
      [[135, 191]],
      [[135, 187]],
      [[134, 186]],
      [[134, 184]],
      [[133, 183]],
      [[133, 182]],
      [[131, 180]],
      [[131, 179]],
      [[130, 178]],
      [[130, 177]],
      [[128, 175]],
      [[128, 174]],
      [[127, 173]],
      [[127, 172]],
      [[126, 171]],
      [[126, 169]],
      [[125, 168]],
      [[125, 165]],
      [[124, 164]],
      [[124, 154]],
      [[123, 153]],
      [[123, 143]],
      [[122, 142]],
      [[122, 139]],
      [[121, 138]],
      [[121, 132]],
      [[122, 131]],
      [[122, 129]],
      [[123, 128]],
      [[122, 127]],
      [[122, 126]],
      [[119, 123]],
      [[119, 122]],
      [[118, 121]]]), # checked
      np.array(
      [[[ 39, 116]],
      [[ 38, 117]],
      [[ 36, 117]],
      [[ 35, 118]],
      [[ 34, 118]],
      [[ 33, 119]],
      [[ 29, 119]],
      [[ 28, 118]],
      [[ 24, 118]],
      [[ 22, 120]],
      [[ 22, 125]],
      [[ 24, 127]],
      [[ 24, 128]],
      [[ 25, 129]],
      [[ 25, 134]],
      [[ 26, 135]],
      [[ 26, 136]],
      [[ 27, 137]],
      [[ 27, 142]],
      [[ 28, 143]],
      [[ 28, 151]],
      [[ 29, 152]],
      [[ 29, 153]],
      [[ 37, 153]],
      [[ 38, 152]],
      [[ 43, 152]],
      [[ 44, 151]],
      [[ 45, 151]],
      [[ 46, 150]],
      [[ 47, 150]],
      [[ 48, 149]],
      [[ 53, 149]],
      [[ 54, 148]],
      [[ 55, 148]],
      [[ 55, 145]],
      [[ 50, 140]],
      [[ 50, 139]],
      [[ 47, 136]],
      [[ 47, 135]],
      [[ 45, 133]],
      [[ 45, 132]],
      [[ 44, 131]],
      [[ 44, 124]],
      [[ 45, 123]],
      [[ 45, 121]],
      [[ 46, 120]],
      [[ 42, 116]]]), # checked
      np.array(
      [[[240,  99]],
      [[240, 100]],
      [[238, 102]],
      [[238, 103]],
      [[235, 106]],
      [[235, 108]],
      [[234, 109]],
      [[235, 110]],
      [[235, 115]],
      [[234, 116]],
      [[234, 119]],
      [[233, 120]],
      [[233, 122]],
      [[232, 123]],
      [[232, 124]],
      [[231, 125]],
      [[231, 127]],
      [[230, 128]],
      [[230, 130]],
      [[229, 131]],
      [[229, 133]],
      [[228, 134]],
      [[228, 135]],
      [[227, 136]],
      [[227, 138]],
      [[226, 139]],
      [[226, 140]],
      [[225, 141]],
      [[225, 142]],
      [[224, 143]],
      [[224, 144]],
      [[223, 145]],
      [[223, 146]],
      [[222, 147]],
      [[222, 148]],
      [[220, 150]],
      [[220, 151]],
      [[209, 162]],
      [[209, 163]],
      [[208, 164]],
      [[208, 169]],
      [[209, 170]],
      [[210, 170]],
      [[211, 171]],
      [[215, 171]],
      [[216, 170]],
      [[227, 170]],
      [[228, 171]],
      [[229, 171]],
      [[230, 172]],
      [[233, 172]],
      [[234, 173]],
      [[235, 173]],
      [[236, 174]],
      [[238, 174]],
      [[239, 175]],
      [[249, 175]],
      [[250, 174]],
      [[250, 173]],
      [[251, 172]],
      [[251, 171]],
      [[252, 170]],
      [[252, 169]],
      [[251, 168]],
      [[251, 164]],
      [[250, 163]],
      [[250, 148]],
      [[251, 147]],
      [[251, 144]],
      [[252, 143]],
      [[252, 141]],
      [[253, 140]],
      [[253, 138]],
      [[254, 137]],
      [[254, 135]],
      [[255, 134]],
      [[255, 131]],
      [[256, 130]],
      [[256, 127]],
      [[257, 126]],
      [[257, 125]],
      [[258, 124]],
      [[258, 122]],
      [[260, 120]],
      [[260, 119]],
      [[265, 114]],
      [[265, 107]],
      [[264, 106]],
      [[264, 104]],
      [[262, 102]],
      [[249, 102]],
      [[248, 101]],
      [[246, 101]],
      [[245, 100]],
      [[241, 100]]]), # checked
      np.array(
      [[[160,  94]],
      [[159,  95]],
      [[159,  96]],
      [[158,  97]],
      [[158,  98]],
      [[156, 100]],
      [[156, 102]],
      [[155, 103]],
      [[156, 104]],
      [[156, 107]],
      [[157, 108]],
      [[157, 118]],
      [[156, 119]],
      [[156, 143]],
      [[155, 144]],
      [[155, 148]],
      [[154, 149]],
      [[154, 152]],
      [[153, 153]],
      [[153, 154]],
      [[152, 155]],
      [[152, 156]],
      [[151, 157]],
      [[151, 158]],
      [[150, 159]],
      [[150, 160]],
      [[148, 162]],
      [[148, 163]],
      [[147, 164]],
      [[147, 167]],
      [[146, 168]],
      [[146, 173]],
      [[147, 174]],
      [[149, 174]],
      [[150, 175]],
      [[152, 175]],
      [[153, 174]],
      [[162, 174]],
      [[163, 173]],
      [[164, 174]],
      [[169, 174]],
      [[170, 175]],
      [[172, 175]],
      [[173, 176]],
      [[176, 176]],
      [[177, 177]],
      [[182, 177]],
      [[183, 176]],
      [[185, 176]],
      [[186, 175]],
      [[187, 175]],
      [[188, 174]],
      [[188, 170]],
      [[187, 169]],
      [[187, 166]],
      [[186, 165]],
      [[186, 163]],
      [[185, 162]],
      [[185, 161]],
      [[184, 160]],
      [[184, 157]],
      [[183, 156]],
      [[183, 152]],
      [[182, 151]],
      [[182, 137]],
      [[183, 136]],
      [[183, 130]],
      [[184, 129]],
      [[184, 113]],
      [[185, 112]],
      [[185, 111]],
      [[186, 110]],
      [[186, 109]],
      [[188, 107]],
      [[188, 102]],
      [[187, 101]],
      [[187,  99]],
      [[186,  98]],
      [[186,  97]],
      [[183,  94]],
      [[180,  94]],
      [[179,  95]],
      [[163,  95]],
      [[162,  94]]]), # checked
      np.array(
      [[[ 27,  85]],
      [[ 26,  86]],
      [[ 23,  86]],
      [[ 21,  88]],
      [[ 21,  91]],
      [[ 22,  92]],
      [[ 22,  93]],
      [[ 23,  94]],
      [[ 23,  96]],
      [[ 24,  97]],
      [[ 24, 100]],
      [[ 25, 101]],
      [[ 25, 102]],
      [[ 24, 103]],
      [[ 24, 106]],
      [[ 23, 107]],
      [[ 23, 108]],
      [[ 22, 109]],
      [[ 22, 110]],
      [[ 21, 111]],
      [[ 21, 115]],
      [[ 22, 116]],
      [[ 33, 116]],
      [[ 34, 115]],
      [[ 37, 115]],
      [[ 38, 114]],
      [[ 41, 114]],
      [[ 42, 113]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 111]],
      [[ 43, 110]],
      [[ 42, 109]],
      [[ 41, 109]],
      [[ 36, 104]],
      [[ 36, 103]],
      [[ 34, 101]],
      [[ 34,  98]],
      [[ 33,  97]],
      [[ 33,  94]],
      [[ 34,  93]],
      [[ 34,  87]],
      [[ 33,  86]],
      [[ 30,  86]],
      [[ 29,  85]]]), # checked
      np.array(
      [[[ 91,  70]],
      [[ 90,  71]],
      [[ 90,  72]],
      [[ 88,  74]],
      [[ 88,  79]],
      [[ 91,  82]],
      [[ 91,  84]],
      [[ 92,  85]],
      [[ 92, 100]],
      [[ 91, 101]],
      [[ 91, 106]],
      [[ 90, 107]],
      [[ 90, 110]],
      [[ 89, 111]],
      [[ 89, 112]],
      [[ 88, 113]],
      [[ 88, 117]],
      [[ 90, 119]],
      [[109, 119]],
      [[110, 118]],
      [[113, 118]],
      [[114, 117]],
      [[121, 117]],
      [[121, 114]],
      [[122, 113]],
      [[119, 110]],
      [[119, 109]],
      [[118, 108]],
      [[118, 107]],
      [[116, 105]],
      [[116, 103]],
      [[115, 102]],
      [[115,  98]],
      [[114,  97]],
      [[114,  95]],
      [[113,  94]],
      [[113,  82]],
      [[114,  81]],
      [[114,  80]],
      [[116,  78]],
      [[116,  74]],
      [[112,  70]],
      [[108,  70]],
      [[107,  71]],
      [[ 98,  71]],
      [[ 97,  70]]]), # checked
      np.array(
      [[[261,  56]],
      [[260,  57]],
      [[247,  57]],
      [[246,  58]],
      [[246,  59]],
      [[245,  60]],
      [[245,  61]],
      [[244,  62]],
      [[244,  63]],
      [[245,  64]],
      [[245,  68]],
      [[246,  69]],
      [[245,  70]],
      [[245,  75]],
      [[244,  76]],
      [[244,  79]],
      [[243,  80]],
      [[243,  83]],
      [[242,  84]],
      [[242,  85]],
      [[240,  87]],
      [[240,  88]],
      [[239,  89]],
      [[239,  90]],
      [[238,  91]],
      [[238,  92]],
      [[237,  93]],
      [[237,  96]],
      [[238,  97]],
      [[245,  97]],
      [[246,  98]],
      [[249,  98]],
      [[250,  99]],
      [[269,  99]],
      [[270,  98]],
      [[271,  98]],
      [[271,  94]],
      [[270,  93]],
      [[270,  92]],
      [[269,  91]],
      [[269,  88]],
      [[268,  87]],
      [[268,  85]],
      [[267,  84]],
      [[267,  82]],
      [[266,  81]],
      [[266,  78]],
      [[265,  77]],
      [[265,  73]],
      [[266,  72]],
      [[266,  69]],
      [[268,  67]],
      [[268,  66]],
      [[269,  65]],
      [[269,  63]],
      [[270,  62]],
      [[270,  59]],
      [[267,  56]]]), # checked
      np.array(
      [[[176,  40]],
      [[175,  41]],
      [[171,  41]],
      [[170,  42]],
      [[158,  42]],
      [[158,  43]],
      [[157,  44]],
      [[157,  45]],
      [[156,  46]],
      [[156,  47]],
      [[155,  48]],
      [[155,  49]],
      [[156,  50]],
      [[156,  52]],
      [[157,  53]],
      [[157,  54]],
      [[158,  55]],
      [[158,  57]],
      [[159,  58]],
      [[159,  73]],
      [[158,  74]],
      [[158,  77]],
      [[157,  78]],
      [[157,  81]],
      [[156,  82]],
      [[156,  84]],
      [[155,  85]],
      [[155,  90]],
      [[157,  92]],
      [[160,  92]],
      [[161,  91]],
      [[166,  91]],
      [[167,  92]],
      [[180,  92]],
      [[181,  91]],
      [[186,  91]],
      [[187,  90]],
      [[190,  90]],
      [[191,  89]],
      [[191,  85]],
      [[190,  84]],
      [[190,  83]],
      [[188,  81]],
      [[188,  79]],
      [[187,  78]],
      [[187,  77]],
      [[186,  76]],
      [[186,  74]],
      [[185,  73]],
      [[185,  71]],
      [[184,  70]],
      [[184,  67]],
      [[183,  66]],
      [[183,  65]],
      [[182,  64]],
      [[182,  62]],
      [[181,  61]],
      [[181,  54]],
      [[182,  53]],
      [[182,  52]],
      [[183,  51]],
      [[183,  48]],
      [[184,  47]],
      [[184,  46]],
      [[183,  45]],
      [[183,  44]],
      [[179,  40]]]), # checked
      np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]]), # checked
      np.array([[[251,  23]],
      [[250,  24]],
      [[247,  24]],
      [[245,  26]],
      [[245,  27]],
      [[244,  28]],
      [[244,  30]],
      [[246,  32]],
      [[246,  33]],
      [[247,  34]],
      [[247,  35]],
      [[248,  36]],
      [[248,  41]],
      [[249,  42]],
      [[248,  43]],
      [[248,  46]],
      [[246,  48]],
      [[246,  49]],
      [[245,  50]],
      [[245,  53]],
      [[246,  54]],
      [[254,  54]],
      [[255,  55]],
      [[256,  55]],
      [[257,  54]],
      [[262,  54]],
      [[263,  53]],
      [[268,  53]],
      [[269,  52]],
      [[269,  51]],
      [[268,  50]],
      [[268,  49]],
      [[261,  42]],
      [[261,  41]],
      [[260,  40]],
      [[260,  39]],
      [[259,  38]],
      [[259,  35]],
      [[258,  34]],
      [[258,  31]],
      [[259,  30]],
      [[259,  27]],
      [[258,  26]],
      [[257,  26]],
      [[255,  24]],
      [[252,  24]]]), # checked
      np.array(
      [[[160,   7]],
      [[159,   8]],
      [[159,   9]],
      [[158,  10]],
      [[157,  10]],
      [[155,   8]],
      [[155,   9]],
      [[154,  10]],
      [[154,  12]],
      [[153,  13]],
      [[153,  14]],
      [[154,  15]],
      [[154,  17]],
      [[155,  17]],
      [[156,  18]],
      [[156,  19]],
      [[157,  20]],
      [[157,  21]],
      [[158,  22]],
      [[158,  30]],
      [[157,  31]],
      [[157,  32]],
      [[154,  35]],
      [[154,  38]],
      [[155,  38]],
      [[156,  39]],
      [[172,  39]],
      [[173,  38]],
      [[177,  38]],
      [[178,  37]],
      [[180,  37]],
      [[181,  36]],
      [[182,  36]],
      [[181,  35]],
      [[181,  34]],
      [[178,  31]],
      [[177,  31]],
      [[176,  30]],
      [[176,  29]],
      [[172,  25]],
      [[172,  24]],
      [[171,  23]],
      [[171,  20]],
      [[170,  19]],
      [[170,  16]],
      [[171,  15]],
      [[171,  14]],
      [[170,  13]],
      [[171,  12]],
      [[167,   8]],
      [[164,   8]],
      [[163,   7]]]), # checked
      np.array(
        [[[ 87, 342]],
        [[ 86, 343]],
        [[ 85, 343]],
        [[ 80, 348]],
        [[ 80, 349]],
        [[ 79, 350]],
        [[ 78, 350]],
        [[ 77, 351]],
        [[ 77, 356]],
        [[ 73, 360]],
        [[ 73, 361]],
        [[ 72, 362]],
        [[ 72, 364]],
        [[ 71, 365]],
        [[ 71, 366]],
        [[ 70, 367]],
        [[ 70, 369]],
        [[ 69, 370]],
        [[ 69, 371]],
        [[ 68, 372]],
        [[ 68, 374]],
        [[ 67, 375]],
        [[ 67, 376]],
        [[ 66, 377]],
        [[ 66, 378]],
        [[ 65, 379]],
        [[ 65, 380]],
        [[ 64, 381]],
        [[ 64, 382]],
        [[ 63, 383]],
        [[ 63, 384]],
        [[ 62, 385]],
        [[ 62, 386]],
        [[ 61, 387]],
        [[ 61, 388]],
        [[ 59, 390]],
        [[ 59, 391]],
        [[ 58, 392]],
        [[ 58, 393]],
        [[ 57, 394]],
        [[ 57, 395]],
        [[ 55, 397]],
        [[ 55, 398]],
        [[ 53, 400]],
        [[ 53, 401]],
        [[ 52, 402]],
        [[ 52, 403]],
        [[ 50, 405]],
        [[ 50, 406]],
        [[ 48, 408]],
        [[ 48, 409]],
        [[ 46, 411]],
        [[ 46, 412]],
        [[ 45, 413]],
        [[ 45, 414]],
        [[ 43, 416]],
        [[ 43, 417]],
        [[ 41, 419]],
        [[ 41, 420]],
        [[ 40, 421]],
        [[ 40, 422]],
        [[ 37, 425]],
        [[ 37, 426]],
        [[ 36, 427]],
        [[ 36, 428]],
        [[ 35, 429]],
        [[ 35, 430]],
        [[ 33, 432]],
        [[ 33, 433]],
        [[ 31, 435]],
        [[ 31, 436]],
        [[ 30, 437]],
        [[ 30, 438]],
        [[ 29, 439]],
        [[ 29, 440]],
        [[ 27, 442]],
        [[ 27, 444]],
        [[ 59, 444]],
        [[ 59, 443]],
        [[ 62, 440]],
        [[ 62, 439]],
        [[ 64, 437]],
        [[ 64, 435]],
        [[ 65, 434]],
        [[ 65, 433]],
        [[ 66, 432]],
        [[ 66, 431]],
        [[ 68, 429]],
        [[ 68, 428]],
        [[ 69, 427]],
        [[ 69, 426]],
        [[ 70, 425]],
        [[ 70, 424]],
        [[ 71, 423]],
        [[ 71, 421]],
        [[ 72, 420]],
        [[ 72, 419]],
        [[ 73, 418]],
        [[ 73, 415]],
        [[ 75, 413]],
        [[ 75, 411]],
        [[ 76, 410]],
        [[ 76, 409]],
        [[ 78, 407]],
        [[ 78, 406]],
        [[ 79, 405]],
        [[ 79, 404]],
        [[ 81, 402]],
        [[ 81, 401]],
        [[ 83, 399]],
        [[ 83, 398]],
        [[ 95, 386]],
        [[ 96, 386]],
        [[ 99, 383]],
        [[100, 383]],
        [[102, 381]],
        [[103, 381]],
        [[104, 380]],
        [[105, 380]],
        [[107, 378]],
        [[108, 378]],
        [[109, 377]],
        [[110, 377]],
        [[112, 375]],
        [[112, 371]],
        [[114, 369]],
        [[114, 368]],
        [[115, 367]],
        [[116, 367]],
        [[117, 366]],
        [[117, 361]],
        [[116, 360]],
        [[116, 359]],
        [[115, 358]],
        [[113, 358]],
        [[112, 357]],
        [[109, 357]],
        [[108, 356]],
        [[105, 356]],
        [[104, 355]],
        [[100, 355]],
        [[ 99, 354]],
        [[ 98, 354]],
        [[ 96, 352]],
        [[ 96, 351]],
        [[ 95, 350]],
        [[ 95, 343]],
        [[ 94, 342]]],
        dtype=np.int32
      ),
      np.array(
        [[[200, 351]],
        [[199, 352]],
        [[197, 352]],
        [[196, 353]],
        [[194, 353]],
        [[193, 354]],
        [[191, 354]],
        [[190, 355]],
        [[187, 355]],
        [[186, 356]],
        [[182, 356]],
        [[181, 357]],
        [[177, 357]],
        [[176, 358]],
        [[155, 358]],
        [[154, 359]],
        [[151, 359]],
        [[150, 358]],
        [[149, 359]],
        [[138, 359]],
        [[137, 358]],
        [[132, 358]],
        [[131, 359]],
        [[129, 359]],
        [[127, 361]],
        [[127, 364]],
        [[126, 365]],
        [[126, 366]],
        [[129, 369]],
        [[128, 370]],
        [[126, 370]],
        [[125, 371]],
        [[125, 374]],
        [[124, 375]],
        [[124, 377]],
        [[122, 379]],
        [[122, 380]],
        [[123, 381]],
        [[123, 383]],
        [[124, 384]],
        [[124, 400]],
        [[123, 401]],
        [[123, 407]],
        [[122, 408]],
        [[122, 411]],
        [[121, 412]],
        [[121, 415]],
        [[120, 416]],
        [[120, 418]],
        [[119, 419]],
        [[119, 422]],
        [[117, 424]],
        [[117, 428]],
        [[116, 429]],
        [[116, 430]],
        [[114, 432]],
        [[114, 434]],
        [[113, 435]],
        [[113, 436]],
        [[112, 437]],
        [[112, 439]],
        [[111, 440]],
        [[111, 444]],
        [[130, 444]],
        [[131, 443]],
        [[151, 443]],
        [[152, 442]],
        [[153, 442]],
        [[155, 440]],
        [[155, 439]],
        [[156, 438]],
        [[156, 437]],
        [[158, 435]],
        [[158, 434]],
        [[159, 433]],
        [[159, 432]],
        [[161, 430]],
        [[161, 429]],
        [[162, 428]],
        [[162, 427]],
        [[163, 426]],
        [[163, 425]],
        [[165, 423]],
        [[165, 422]],
        [[166, 421]],
        [[166, 420]],
        [[168, 418]],
        [[168, 417]],
        [[170, 415]],
        [[170, 414]],
        [[173, 411]],
        [[173, 410]],
        [[176, 407]],
        [[176, 406]],
        [[188, 394]],
        [[188, 393]],
        [[192, 389]],
        [[192, 388]],
        [[194, 386]],
        [[194, 384]],
        [[195, 383]],
        [[195, 379]],
        [[196, 378]],
        [[197, 378]],
        [[198, 377]],
        [[199, 377]],
        [[203, 373]],
        [[203, 372]],
        [[205, 370]],
        [[205, 369]],
        [[206, 368]],
        [[206, 367]],
        [[208, 365]],
        [[208, 364]],
        [[209, 363]],
        [[209, 361]],
        [[210, 360]],
        [[210, 358]],
        [[211, 357]],
        [[211, 356]],
        [[210, 355]],
        [[210, 353]],
        [[209, 352]],
        [[208, 352]],
        [[207, 351]]],
        dtype=np.int32
      )
    ]

  expected_contours = np.empty(21, dtype=object)
  expected_contours[0] = ExpectedContourDistalPhalanx(1)
  expected_contours[1] = ExpectedContourMedialPhalanx(1)
  expected_contours[2] = ExpectedContourProximalPhalanx(1)
  expected_contours[3] = ExpectedContourMetacarpal(
    1,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[0]
  )
  expected_contours[4] = ExpectedContourDistalPhalanx(
    2,
    first_encounter=expected_contours[0]
  )
  expected_contours[5] = ExpectedContourMedialPhalanx(
    2,
    first_encounter=expected_contours[1]
  )
  expected_contours[6] = ExpectedContourProximalPhalanx(
    2,
    first_encounter=expected_contours[2]
  )
  expected_contours[7] = ExpectedContourMetacarpal(
    2,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[4],
    first_encounter=expected_contours[3]
  )
  expected_contours[8] = ExpectedContourDistalPhalanx(
    3,
    first_encounter=expected_contours[0]
  )
  expected_contours[9] = ExpectedContourMedialPhalanx(
    3,
    first_encounter=expected_contours[1]
  )
  expected_contours[10] = ExpectedContourProximalPhalanx(
    3,
    first_encounter=expected_contours[2]
  )
  expected_contours[11] = ExpectedContourMetacarpal(
    3,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[8],
    first_encounter=expected_contours[3]
  )
  expected_contours[12] = ExpectedContourDistalPhalanx(
    4,
    first_encounter=expected_contours[0]
  )
  expected_contours[13] = ExpectedContourMedialPhalanx(
    4,
    first_encounter=expected_contours[1]
  )
  expected_contours[14] = ExpectedContourProximalPhalanx(
    4,
    first_encounter=expected_contours[2]
  )
  expected_contours[15] = ExpectedContourMetacarpal(
    4,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[12],
    first_encounter=expected_contours[3]
  )
  expected_contours[16] = ExpectedContourDistalPhalanx(
    5,
    first_encounter=expected_contours[0]
  )
  expected_contours[17] = ExpectedContourProximalPhalanx(
    5,
    first_encounter=expected_contours[2]
  )
  expected_contours[18] = ExpectedContourMetacarpal(
    5,
    first_encounter=expected_contours[3]
  )
  expected_contours[19] = ExpectedContourUlna()
  expected_contours[20] = ExpectedContourRadius()

  contour_map = [
    12,
    9,
    7,
    1,
    16,
    13,
    8,
    3,
    18,
    15,
    11,
    4,
    17,
    14,
    10,
    5,
    6,
    2,
    0,
    19,
    20,
  ]

  contour_map_mask = [
    12,
    9,
    7,
    1,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. First finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    16,
    13,
    8,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Second finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    18,
    15,
    11,
    4,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Third finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    17,
    14,
    10,
    5,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Fourth finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    6,
    2,
    0,
    # 19,
    # 20
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Fifth finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contours = [
    np.array(
      [[[317, 252]],
      [[316, 253]],
      [[314, 253]],
      [[313, 254]],
      [[309, 254]],
      [[309, 255]],
      [[306, 258]],
      [[305, 258]],
      [[303, 260]],
      [[303, 261]],
      [[301, 263]],
      [[299, 263]],
      [[298, 264]],
      [[298, 265]],
      [[292, 271]],
      [[291, 271]],
      [[287, 275]],
      [[286, 275]],
      [[284, 277]],
      [[283, 277]],
      [[280, 280]],
      [[279, 280]],
      [[277, 282]],
      [[276, 282]],
      [[275, 283]],
      [[274, 283]],
      [[273, 284]],
      [[272, 284]],
      [[271, 285]],
      [[270, 285]],
      [[268, 287]],
      [[266, 287]],
      [[265, 288]],
      [[264, 288]],
      [[263, 289]],
      [[261, 289]],
      [[260, 290]],
      [[257, 290]],
      [[256, 291]],
      [[253, 291]],
      [[252, 292]],
      [[247, 292]],
      [[246, 293]],
      [[243, 293]],
      [[242, 294]],
      [[240, 294]],
      [[239, 295]],
      [[236, 295]],
      [[235, 296]],
      [[233, 296]],
      [[230, 299]],
      [[230, 303]],
      [[232, 305]],
      [[232, 306]],
      [[235, 309]],
      [[236, 309]],
      [[237, 310]],
      [[237, 311]],
      [[238, 312]],
      [[238, 315]],
      [[239, 316]],
      [[240, 316]],
      [[242, 318]],
      [[243, 318]],
      [[244, 319]],
      [[250, 319]],
      [[251, 320]],
      [[253, 320]],
      [[254, 319]],
      [[256, 319]],
      [[257, 318]],
      [[258, 318]],
      [[259, 317]],
      [[260, 317]],
      [[261, 316]],
      [[263, 316]],
      [[265, 314]],
      [[266, 314]],
      [[267, 313]],
      [[268, 313]],
      [[271, 310]],
      [[272, 310]],
      [[277, 305]],
      [[278, 305]],
      [[280, 303]],
      [[281, 303]],
      [[283, 301]],
      [[284, 301]],
      [[286, 299]],
      [[287, 299]],
      [[289, 297]],
      [[290, 297]],
      [[292, 295]],
      [[293, 295]],
      [[294, 294]],
      [[295, 294]],
      [[296, 293]],
      [[297, 293]],
      [[299, 291]],
      [[300, 291]],
      [[301, 290]],
      [[302, 290]],
      [[304, 288]],
      [[305, 288]],
      [[306, 287]],
      [[307, 287]],
      [[308, 286]],
      [[309, 286]],
      [[311, 284]],
      [[312, 284]],
      [[314, 282]],
      [[315, 282]],
      [[316, 281]],
      [[317, 281]],
      [[318, 280]],
      [[319, 280]],
      [[321, 278]],
      [[323, 278]],
      [[324, 277]],
      [[325, 277]],
      [[326, 276]],
      [[327, 276]],
      [[328, 275]],
      [[329, 275]],
      [[331, 273]],
      [[332, 273]],
      [[332, 272]],
      [[334, 270]],
      [[334, 269]],
      [[335, 268]],
      [[335, 264]],
      [[334, 263]],
      [[334, 262]],
      [[332, 260]],
      [[331, 260]],
      [[328, 257]],
      [[327, 257]],
      [[326, 256]],
      [[325, 256]],
      [[324, 255]],
      [[323, 255]],
      [[321, 253]],
      [[320, 253]],
      [[319, 252]]],
      dtype=np.int32
    ),
    np.array(
      [[[294, 250]],
      [[293, 251]],
      [[293, 255]],
      [[294, 256]],
      [[299, 256]],
      [[300, 255]],
      [[301, 255]],
      [[302, 256]],
      [[304, 256]],
      [[305, 255]],
      [[305, 252]],
      [[304, 251]],
      [[303, 251]],
      [[302, 250]]],
      dtype=np.int32
    )
  ]
  expected_contours = [
    ExpectedContourSesamoidMetacarpal(),
    ExpectedContourSesamoid()
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map=[0, 1],
    contours=contours,
    padding=5,
    title='Fifth metacarpal and sesamoid.',
    minimize_image=False,
    show_position_restrictions=True
  )
  
  

  plt.show()
