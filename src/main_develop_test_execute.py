'''
Universidad de La Laguna
Máster en Ingeniería Informática
Trabajo de Final de Máster
Pyimagos development

Visualization of the search execution test
'''

import numpy as np
import cv2 as cv
import matplotlib.pyplot as plt

from src.expected_contours.expected_contour_of_branch import (
  ExpectedContourOfBranch
)
from src.main_develop_test_distal_phalanx import (
  create_minimal_image_from_contours,
)
from src.expected_contours.distal_phalanx import ExpectedContourDistalPhalanx
from src.expected_contours.medial_phalanx import ExpectedContourMedialPhalanx
from src.expected_contours.proximal_phalanx import ExpectedContourProximalPhalanx
from src.expected_contours.metacarpal import ExpectedContourMetacarpal
from src.expected_contours.ulna import ExpectedContourUlna
from src.expected_contours.radius import ExpectedContourRadius
from src.expected_contours.sesamoid import ExpectedContourSesamoid
from src.expected_contours.metacarpal_sesamoid import (
  ExpectedContourSesamoidMetacarpal
)

def show_contours_position_restrictions(
    expected_contours: list, 
    contour_map: list,
    contours: list,
    padding=5,
    title='Position restrictions visualization',
    minimize_image: bool = True,
    show_position_restrictions: bool = True,
    contour_map_mask: list = None,
):
  all_points = np.concatenate(contours)
  all_points = np.reshape(all_points, (-1, 2))
  x_values = all_points[:, 0]
  y_values = all_points[:, 1]

  max_x = int(np.max(x_values))
  max_y = int(np.max(y_values))

  blank_image = np.zeros((max_y + 300, max_x + 25), dtype=np.uint8)

  if minimize_image:
    minimal_image, adjusted_contours = create_minimal_image_from_contours(
      blank_image,
      contours,
      padding
    )
    minimal_image = cv.cvtColor(minimal_image, cv.COLOR_GRAY2RGB)
    contours = adjusted_contours
  else:
    minimal_image = cv.cvtColor(blank_image, cv.COLOR_GRAY2RGB)

  for i, contour in enumerate(contours):
    color = ((i + 1) * 123 % 256, (i + 1) * 456 % 256, (i + 1) * 789 % 256)
    if len(contour) > 0:
      cv.drawContours(minimal_image, contours, i, color, 1)

  if show_position_restrictions:
    for i, expected_contour in enumerate(expected_contours):
      contour_index = contour_map[i]
      if (contour_map_mask is None or
          (contour_map_mask is not None and contour_index in contour_map_mask)):
        expected_contour.prepare(
          contours[contour_index],
          minimal_image.shape[1],
          minimal_image.shape[0]
        )
        color = (
          (contour_index + 1) * 123 % 256,
          (contour_index + 1) * 456 % 256,
          (contour_index + 1) * 789 % 256
        )
        
        if (isinstance(expected_contour, ExpectedContourOfBranch) and
            expected_contour.ends_branchs_sequence):
            try:
              position_restrictions = (
                expected_contour
                .first_in_branch
                .branch_start_position_restrictions()
              )
            except TypeError:
              print('Error: First in branch expected contour not prepared for ' \
                    f'contour index {contour_index} at "{title}" case.')
              position_restrictions = []
        else:
          position_restrictions = expected_contour.next_contour_restrictions()

        for position_restriction in position_restrictions:
          point_a = position_restriction[0]
          point_b = position_restriction[1]
          direction = point_b - point_a
          direction = direction / np.linalg.norm(direction)
          point_a = (point_a - direction * minimal_image.shape[1]).astype(int)
          point_b = (point_b + direction * minimal_image.shape[1]).astype(int)
          cv.line(
            minimal_image,
            point_a,
            point_b,
            color,
            1
          )

        color_rect = (
          max(0, ((contour_index + 1) * 123 % 256) - 50),
          max(0, ((contour_index + 1) * 456 % 256) - 50),
          max(0, ((contour_index + 1) * 789 % 256) - 50),
        )
        rect = cv.minAreaRect(contours[contour_index])
        bounding_rect_contour = cv.boxPoints(rect)
        bounding_rect_contour = np.int32(bounding_rect_contour) # to int
        cv.drawContours(minimal_image, [bounding_rect_contour], 0, color_rect,
                        1)

  fig = plt.figure()
  plt.imshow(minimal_image)
  plt.title(title)
  plt.axis('off')
  fig.canvas.manager.set_window_title(title)

def canonical_hand_case():
  contours = [
    np.array([[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    ),
    np.array([[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    )
  ]
  expected_contours = [
    ExpectedContourMedialPhalanx(1),
    ExpectedContourDistalPhalanx(1)
  ]
  contour_map = [0, 1]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Composition.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 37,  97]],
      [[ 36,  98]],
      [[ 34,  98]],
      [[ 33,  99]],
      [[ 32,  99]],
      [[ 31, 100]],
      [[ 27, 100]],
      [[ 26,  99]],
      [[ 22,  99]],
      [[ 20, 101]],
      [[ 20, 106]],
      [[ 22, 108]],
      [[ 22, 109]],
      [[ 23, 110]],
      [[ 23, 115]],
      [[ 24, 116]],
      [[ 24, 117]],
      [[ 25, 118]],
      [[ 25, 123]],
      [[ 26, 124]],
      [[ 26, 132]],
      [[ 27, 133]],
      [[ 27, 134]],
      [[ 35, 134]],
      [[ 36, 133]],
      [[ 41, 133]],
      [[ 42, 132]],
      [[ 43, 132]],
      [[ 44, 131]],
      [[ 45, 131]],
      [[ 46, 130]],
      [[ 51, 130]],
      [[ 52, 129]],
      [[ 53, 129]],
      [[ 53, 126]],
      [[ 48, 121]],
      [[ 48, 120]],
      [[ 45, 117]],
      [[ 45, 116]],
      [[ 43, 114]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 105]],
      [[ 43, 104]],
      [[ 43, 102]],
      [[ 44, 101]],
      [[ 40,  97]]],
      dtype=np.int32
    ),
    np.array([[[25, 66]],
      [[24, 67]],
      [[21, 67]],
      [[19, 69]],
      [[19, 72]],
      [[20, 73]],
      [[20, 74]],
      [[21, 75]],
      [[21, 77]],
      [[22, 78]],
      [[22, 81]],
      [[23, 82]],
      [[23, 83]],
      [[22, 84]],
      [[22, 87]],
      [[21, 88]],
      [[21, 89]],
      [[20, 90]],
      [[20, 91]],
      [[19, 92]],
      [[19, 96]],
      [[20, 97]],
      [[31, 97]],
      [[32, 96]],
      [[35, 96]],
      [[36, 95]],
      [[39, 95]],
      [[40, 94]],
      [[41, 94]],
      [[40, 93]],
      [[40, 92]],
      [[41, 91]],
      [[40, 90]],
      [[39, 90]],
      [[34, 85]],
      [[34, 84]],
      [[32, 82]],
      [[32, 79]],
      [[31, 78]],
      [[31, 75]],
      [[32, 74]],
      [[32, 68]],
      [[31, 67]],
      [[28, 67]],
      [[27, 66]]],
      dtype=np.int32
    ),
    np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]],
      dtype=np.int32
    )
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    1,
    0,
    2,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Composition with jump.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]],
          dtype=np.int32
    ),     
    np.array([[[76, 89]],
          [[76, 91]],
          [[75, 92]],
          [[75, 95]],
          [[74, 96]],
          [[74, 97]],
          [[79, 97]],
          [[80, 96]],
          [[85, 96]],
          [[83, 94]],
          [[82, 94]],
          [[79, 91]],
          [[78, 91]]],
          dtype=np.int32
    ),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]],
          dtype=np.int32
    ),
    np.array([[[55, 72]],
          [[54, 73]],
          [[50, 73]],
          [[49, 74]],
          [[47, 74]],
          [[49, 76]],
          [[49, 77]],
          [[52, 80]],
          [[52, 81]],
          [[54, 83]],
          [[57, 83]],
          [[58, 82]],
          [[61, 82]],
          [[61, 81]],
          [[60, 80]],
          [[60, 79]],
          [[59, 78]],
          [[59, 76]],
          [[58, 75]],
          [[58, 74]],
          [[57, 73]],
          [[57, 72]]],
          dtype=np.int32
    ),
    np.array([[[74, 70]],
          [[73, 71]],
          [[72, 71]],
          [[71, 72]],
          [[70, 72]],
          [[70, 76]],
          [[71, 77]],
          [[71, 81]],
          [[78, 81]],
          [[78, 77]],
          [[79, 76]],
          [[79, 74]],
          [[76, 71]],
          [[75, 71]]],
          dtype=np.int32
    ),
    np.array([[[130,  54]],
          [[130,  56]],
          [[131,  57]],
          [[131,  61]],
          [[132,  62]],
          [[132,  64]],
          [[133,  64]],
          [[134,  63]],
          [[137,  63]],
          [[138,  62]],
          [[141,  62]],
          [[142,  61]],
          [[145,  61]],
          [[146,  60]],
          [[147,  60]],
          [[146,  60]],
          [[145,  59]],
          [[143,  59]],
          [[142,  58]],
          [[140,  58]],
          [[139,  57]],
          [[138,  57]],
          [[137,  56]],
          [[135,  56]],
          [[134,  55]],
          [[132,  55]],
          [[131,  54]]],
          dtype=np.int32
    ),
    np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]],
      dtype=np.int32
    ),
    np.array([[[34, 11]],
          [[33, 12]],
          [[33, 13]],
          [[31, 15]],
          [[31, 16]],
          [[29, 18]],
          [[29, 19]],
          [[26, 22]],
          [[26, 23]],
          [[24, 25]],
          [[24, 26]],
          [[23, 27]],
          [[26, 27]],
          [[27, 26]],
          [[33, 26]],
          [[34, 25]],
          [[41, 25]],
          [[42, 24]],
          [[48, 24]],
          [[49, 23]],
          [[52, 23]],
          [[51, 22]],
          [[50, 22]],
          [[48, 20]],
          [[47, 20]],
          [[45, 18]],
          [[44, 18]],
          [[42, 16]],
          [[41, 16]],
          [[39, 14]],
          [[38, 14]],
          [[36, 12]],
          [[35, 12]]],
          dtype=np.int32
    ),
  ]
  contour_map = [
    2,
    0,
    6,
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    distal_phalanx_2,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Noisy with jump.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 39, 116]],
       [[ 38, 117]],
       [[ 36, 117]],
       [[ 35, 118]],
       [[ 34, 118]],
       [[ 33, 119]],
       [[ 29, 119]],
       [[ 28, 118]],
       [[ 24, 118]],
       [[ 22, 120]],
       [[ 22, 125]],
       [[ 24, 127]],
       [[ 24, 128]],
       [[ 25, 129]],
       [[ 25, 134]],
       [[ 26, 135]],
       [[ 26, 136]],
       [[ 27, 137]],
       [[ 27, 142]],
       [[ 28, 143]],
       [[ 28, 151]],
       [[ 29, 152]],
       [[ 29, 153]],
       [[ 37, 153]],
       [[ 38, 152]],
       [[ 43, 152]],
       [[ 44, 151]],
       [[ 45, 151]],
       [[ 46, 150]],
       [[ 47, 150]],
       [[ 48, 149]],
       [[ 53, 149]],
       [[ 54, 148]],
       [[ 55, 148]],
       [[ 55, 145]],
       [[ 50, 140]],
       [[ 50, 139]],
       [[ 47, 136]],
       [[ 47, 135]],
       [[ 45, 133]],
       [[ 45, 132]],
       [[ 44, 131]],
       [[ 44, 124]],
       [[ 45, 123]],
       [[ 45, 121]],
       [[ 46, 120]],
       [[ 42, 116]]],
       dtype=np.int32
    ),
    np.array([[[76, 89]],
       [[76, 91]],
       [[75, 92]],
       [[75, 95]],
       [[74, 96]],
       [[74, 97]],
       [[79, 97]],
       [[80, 96]],
       [[85, 96]],
       [[83, 94]],
       [[82, 94]],
       [[79, 91]],
       [[78, 91]]],
       dtype=np.int32
    ),
    np.array([[[ 27,  85]],
       [[ 26,  86]],
       [[ 23,  86]],
       [[ 21,  88]],
       [[ 21,  91]],
       [[ 22,  92]],
       [[ 22,  93]],
       [[ 23,  94]],
       [[ 23,  96]],
       [[ 24,  97]],
       [[ 24, 100]],
       [[ 25, 101]],
       [[ 25, 102]],
       [[ 24, 103]],
       [[ 24, 106]],
       [[ 23, 107]],
       [[ 23, 108]],
       [[ 22, 109]],
       [[ 22, 110]],
       [[ 21, 111]],
       [[ 21, 115]],
       [[ 22, 116]],
       [[ 33, 116]],
       [[ 34, 115]],
       [[ 37, 115]],
       [[ 38, 114]],
       [[ 41, 114]],
       [[ 42, 113]],
       [[ 43, 113]],
       [[ 42, 112]],
       [[ 42, 111]],
       [[ 43, 110]],
       [[ 42, 109]],
       [[ 41, 109]],
       [[ 36, 104]],
       [[ 36, 103]],
       [[ 34, 101]],
       [[ 34,  98]],
       [[ 33,  97]],
       [[ 33,  94]],
       [[ 34,  93]],
       [[ 34,  87]],
       [[ 33,  86]],
       [[ 30,  86]],
       [[ 29,  85]]],
       dtype=np.int32
    ),
    np.array([[[55, 72]],
       [[54, 73]],
       [[50, 73]],
       [[49, 74]],
       [[47, 74]],
       [[49, 76]],
       [[49, 77]],
       [[52, 80]],
       [[52, 81]],
       [[54, 83]],
       [[57, 83]],
       [[58, 82]],
       [[61, 82]],
       [[61, 81]],
       [[60, 80]],
       [[60, 79]],
       [[59, 78]],
       [[59, 76]],
       [[58, 75]],
       [[58, 74]],
       [[57, 73]],
       [[57, 72]]],
       dtype=np.int32
    ),
    np.array([[[74, 70]],
       [[73, 71]],
       [[72, 71]],
       [[71, 72]],
       [[70, 72]],
       [[70, 76]],
       [[71, 77]],
       [[71, 81]],
       [[78, 81]],
       [[78, 77]],
       [[79, 76]],
       [[79, 74]],
       [[76, 71]],
       [[75, 71]]],
       dtype=np.int32
    ),
    np.array([[[130,  54]],
       [[130,  56]],
       [[131,  57]],
       [[131,  61]],
       [[132,  62]],
       [[132,  64]],
       [[133,  64]],
       [[134,  63]],
       [[137,  63]],
       [[138,  62]],
       [[141,  62]],
       [[142,  61]],
       [[145,  61]],
       [[146,  60]],
       [[147,  60]],
       [[146,  60]],
       [[145,  59]],
       [[143,  59]],
       [[142,  58]],
       [[140,  58]],
       [[139,  57]],
       [[138,  57]],
       [[137,  56]],
       [[135,  56]],
       [[134,  55]],
       [[132,  55]],
       [[131,  54]]],
       dtype=np.int32),
    np.array([[[34, 11]],
       [[33, 12]],
       [[33, 13]],
       [[31, 15]],
       [[31, 16]],
       [[29, 18]],
       [[29, 19]],
       [[26, 22]],
       [[26, 23]],
       [[24, 25]],
       [[24, 26]],
       [[23, 27]],
       [[26, 27]],
       [[27, 26]],
       [[33, 26]],
       [[34, 25]],
       [[41, 25]],
       [[42, 24]],
       [[48, 24]],
       [[49, 23]],
       [[52, 23]],
       [[51, 22]],
       [[50, 22]],
       [[48, 20]],
       [[47, 20]],
       [[45, 18]],
       [[44, 18]],
       [[42, 16]],
       [[41, 16]],
       [[39, 14]],
       [[38, 14]],
       [[36, 12]],
       [[35, 12]]],
       dtype=np.int32
      )
  ]
  expected_contours = [
    ExpectedContourDistalPhalanx(1),
    ExpectedContourMedialPhalanx(1),
  ]
  contour_map = [
    2,
    0,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='All invalid shape after first two ideal.',
    minimize_image=False
  )

  ideal_medial_phalanx = np.array(
    [[[ 37,  97]],
    [[ 36,  98]],
    [[ 34,  98]],
    [[ 33,  99]],
    [[ 32,  99]],
    [[ 31, 100]],
    [[ 27, 100]],
    [[ 26,  99]],
    [[ 22,  99]],
    [[ 20, 101]],
    [[ 20, 106]],
    [[ 22, 108]],
    [[ 22, 109]],
    [[ 23, 110]],
    [[ 23, 115]],
    [[ 24, 116]],
    [[ 24, 117]],
    [[ 25, 118]],
    [[ 25, 123]],
    [[ 26, 124]],
    [[ 26, 132]],
    [[ 27, 133]],
    [[ 27, 134]],
    [[ 35, 134]],
    [[ 36, 133]],
    [[ 41, 133]],
    [[ 42, 132]],
    [[ 43, 132]],
    [[ 44, 131]],
    [[ 45, 131]],
    [[ 46, 130]],
    [[ 51, 130]],
    [[ 52, 129]],
    [[ 53, 129]],
    [[ 53, 126]],
    [[ 48, 121]],
    [[ 48, 120]],
    [[ 45, 117]],
    [[ 45, 116]],
    [[ 43, 114]],
    [[ 43, 113]],
    [[ 42, 112]],
    [[ 42, 105]],
    [[ 43, 104]],
    [[ 43, 102]],
    [[ 44, 101]],
    [[ 40,  97]]],
    dtype=np.int32
  )
  ideal_distal_phalanx = np.array(
    [[[25, 66]],
    [[24, 67]],
    [[21, 67]],
    [[19, 69]],
    [[19, 72]],
    [[20, 73]],
    [[20, 74]],
    [[21, 75]],
    [[21, 77]],
    [[22, 78]],
    [[22, 81]],
    [[23, 82]],
    [[23, 83]],
    [[22, 84]],
    [[22, 87]],
    [[21, 88]],
    [[21, 89]],
    [[20, 90]],
    [[20, 91]],
    [[19, 92]],
    [[19, 96]],
    [[20, 97]],
    [[31, 97]],
    [[32, 96]],
    [[35, 96]],
    [[36, 95]],
    [[39, 95]],
    [[40, 94]],
    [[41, 94]],
    [[40, 93]],
    [[40, 92]],
    [[41, 91]],
    [[40, 90]],
    [[39, 90]],
    [[34, 85]],
    [[34, 84]],
    [[32, 82]],
    [[32, 79]],
    [[31, 78]],
    [[31, 75]],
    [[32, 74]],
    [[32, 68]],
    [[31, 67]],
    [[28, 67]],
    [[27, 66]]],
    dtype=np.int32
  )
  contours = [
    ideal_distal_phalanx,
    ideal_medial_phalanx,
  ]
  expected_contours = [
    ExpectedContourDistalPhalanx(1),
    ExpectedContourMedialPhalanx(1),
  ]
  contour_map = [0, 1]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Not enough candidate contours after first two ideal.',
    minimize_image=False,
  )

  contours = [
    np.array([[[ 53, 151]],
          [[ 51, 153]],
          [[ 49, 153]],
          [[ 48, 154]],
          [[ 46, 154]],
          [[ 45, 155]],
          [[ 37, 155]],
          [[ 36, 156]],
          [[ 35, 156]],
          [[ 35, 164]],
          [[ 38, 167]],
          [[ 38, 168]],
          [[ 40, 170]],
          [[ 40, 171]],
          [[ 42, 173]],
          [[ 42, 174]],
          [[ 43, 175]],
          [[ 43, 177]],
          [[ 44, 178]],
          [[ 44, 180]],
          [[ 45, 181]],
          [[ 45, 183]],
          [[ 46, 184]],
          [[ 46, 185]],
          [[ 47, 186]],
          [[ 47, 187]],
          [[ 48, 188]],
          [[ 48, 191]],
          [[ 49, 192]],
          [[ 49, 195]],
          [[ 50, 196]],
          [[ 50, 203]],
          [[ 49, 204]],
          [[ 49, 211]],
          [[ 51, 213]],
          [[ 59, 213]],
          [[ 60, 212]],
          [[ 61, 212]],
          [[ 62, 211]],
          [[ 64, 211]],
          [[ 65, 210]],
          [[ 67, 210]],
          [[ 68, 209]],
          [[ 71, 209]],
          [[ 72, 208]],
          [[ 83, 208]],
          [[ 84, 207]],
          [[ 85, 207]],
          [[ 85, 205]],
          [[ 86, 204]],
          [[ 86, 202]],
          [[ 85, 201]],
          [[ 85, 200]],
          [[ 84, 199]],
          [[ 83, 199]],
          [[ 70, 186]],
          [[ 70, 185]],
          [[ 68, 183]],
          [[ 68, 182]],
          [[ 67, 181]],
          [[ 67, 180]],
          [[ 65, 178]],
          [[ 65, 177]],
          [[ 64, 176]],
          [[ 64, 175]],
          [[ 63, 174]],
          [[ 63, 173]],
          [[ 62, 172]],
          [[ 62, 170]],
          [[ 60, 168]],
          [[ 60, 163]],
          [[ 59, 162]],
          [[ 59, 160]],
          [[ 60, 159]],
          [[ 60, 158]],
          [[ 59, 157]],
          [[ 59, 155]],
          [[ 58, 154]],
          [[ 57, 154]],
          [[ 54, 151]]], 
          dtype=np.int32
    ),
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]],
          dtype=np.int32
    ),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]], 
          dtype=np.int32
    ),
    np.array( [[[ 98,  35]],
            [[ 97,  36]],
            [[ 96,  36]],
            [[ 94,  38]],
            [[ 94,  39]],
            [[ 93,  40]],
            [[ 93,  42]],
            [[ 94,  43]],
            [[ 94,  44]],
            [[ 95,  45]],
            [[ 95,  47]],
            [[ 96,  48]],
            [[ 96,  50]],
            [[ 95,  51]],
            [[ 95,  54]],
            [[ 94,  55]],
            [[ 94,  56]],
            [[ 93,  57]],
            [[ 93,  58]],
            [[ 88,  63]],
            [[ 88,  67]],
            [[ 90,  67]],
            [[ 91,  68]],
            [[ 98,  68]],
            [[ 99,  69]],
            [[104,  69]],
            [[105,  68]],
            [[111,  68]],
            [[112,  67]],
            [[115,  67]],
            [[115,  63]],
            [[110,  58]],
            [[110,  57]],
            [[109,  56]],
            [[109,  55]],
            [[108,  54]],
            [[108,  50]],
            [[109,  49]],
            [[109,  46]],
            [[110,  45]],
            [[110,  44]],
            [[111,  43]],
            [[111,  41]],
            [[110,  40]],
            [[110,  37]],
            [[109,  37]],
            [[108,  36]],
            [[106,  36]],
            [[105,  35]]], 
            dtype=np.int32
      )
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(1)
  proximal_phalanx_1 = ExpectedContourProximalPhalanx(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    proximal_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    2,
    1,
    0,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Proximal phalanx with jump.',
    minimize_image=False
  )

  contours = [
    np.array([[[ 73, 211]],
      [[ 72, 212]],
      [[ 68, 212]],
      [[ 67, 213]],
      [[ 65, 213]],
      [[ 64, 214]],
      [[ 63, 214]],
      [[ 62, 215]],
      [[ 61, 215]],
      [[ 59, 217]],
      [[ 59, 218]],
      [[ 58, 219]],
      [[ 58, 220]],
      [[ 59, 221]],
      [[ 59, 225]],
      [[ 58, 226]],
      [[ 58, 229]],
      [[ 62, 233]],
      [[ 62, 234]],
      [[ 65, 237]],
      [[ 65, 238]],
      [[ 67, 240]],
      [[ 67, 241]],
      [[ 70, 244]],
      [[ 70, 245]],
      [[ 72, 247]],
      [[ 72, 248]],
      [[ 73, 249]],
      [[ 73, 250]],
      [[ 74, 251]],
      [[ 74, 252]],
      [[ 75, 253]],
      [[ 75, 254]],
      [[ 77, 256]],
      [[ 77, 257]],
      [[ 78, 258]],
      [[ 78, 259]],
      [[ 79, 260]],
      [[ 79, 261]],
      [[ 80, 262]],
      [[ 80, 263]],
      [[ 81, 264]],
      [[ 81, 265]],
      [[ 82, 266]],
      [[ 82, 267]],
      [[ 83, 268]],
      [[ 83, 269]],
      [[ 84, 270]],
      [[ 84, 271]],
      [[ 85, 272]],
      [[ 85, 273]],
      [[ 86, 274]],
      [[ 86, 276]],
      [[ 87, 277]],
      [[ 87, 280]],
      [[ 88, 281]],
      [[ 88, 285]],
      [[ 89, 286]],
      [[ 89, 295]],
      [[ 90, 296]],
      [[ 90, 298]],
      [[ 91, 299]],
      [[ 91, 300]],
      [[ 94, 303]],
      [[ 96, 303]],
      [[ 97, 304]],
      [[100, 304]],
      [[101, 305]],
      [[103, 305]],
      [[104, 304]],
      [[105, 304]],
      [[106, 303]],
      [[106, 302]],
      [[108, 300]],
      [[108, 299]],
      [[110, 297]],
      [[110, 296]],
      [[113, 293]],
      [[113, 292]],
      [[115, 290]],
      [[115, 289]],
      [[117, 287]],
      [[117, 286]],
      [[118, 285]],
      [[116, 283]],
      [[116, 282]],
      [[115, 282]],
      [[106, 273]],
      [[106, 272]],
      [[104, 270]],
      [[104, 269]],
      [[102, 267]],
      [[102, 266]],
      [[100, 264]],
      [[100, 263]],
      [[ 99, 262]],
      [[ 99, 261]],
      [[ 98, 260]],
      [[ 98, 259]],
      [[ 97, 258]],
      [[ 97, 257]],
      [[ 96, 256]],
      [[ 96, 255]],
      [[ 95, 254]],
      [[ 95, 253]],
      [[ 94, 252]],
      [[ 94, 250]],
      [[ 93, 249]],
      [[ 93, 248]],
      [[ 92, 247]],
      [[ 92, 246]],
      [[ 91, 245]],
      [[ 91, 243]],
      [[ 90, 242]],
      [[ 90, 240]],
      [[ 89, 239]],
      [[ 89, 237]],
      [[ 88, 236]],
      [[ 88, 227]],
      [[ 87, 226]],
      [[ 87, 223]],
      [[ 86, 222]],
      [[ 86, 220]],
      [[ 78, 212]],
      [[ 76, 212]],
      [[ 75, 211]]], 
      dtype=np.int32),
    np.array([[[ 53, 151]],
          [[ 51, 153]],
          [[ 49, 153]],
          [[ 48, 154]],
          [[ 46, 154]],
          [[ 45, 155]],
          [[ 37, 155]],
          [[ 36, 156]],
          [[ 35, 156]],
          [[ 35, 164]],
          [[ 38, 167]],
          [[ 38, 168]],
          [[ 40, 170]],
          [[ 40, 171]],
          [[ 42, 173]],
          [[ 42, 174]],
          [[ 43, 175]],
          [[ 43, 177]],
          [[ 44, 178]],
          [[ 44, 180]],
          [[ 45, 181]],
          [[ 45, 183]],
          [[ 46, 184]],
          [[ 46, 185]],
          [[ 47, 186]],
          [[ 47, 187]],
          [[ 48, 188]],
          [[ 48, 191]],
          [[ 49, 192]],
          [[ 49, 195]],
          [[ 50, 196]],
          [[ 50, 203]],
          [[ 49, 204]],
          [[ 49, 211]],
          [[ 51, 213]],
          [[ 59, 213]],
          [[ 60, 212]],
          [[ 61, 212]],
          [[ 62, 211]],
          [[ 64, 211]],
          [[ 65, 210]],
          [[ 67, 210]],
          [[ 68, 209]],
          [[ 71, 209]],
          [[ 72, 208]],
          [[ 83, 208]],
          [[ 84, 207]],
          [[ 85, 207]],
          [[ 85, 205]],
          [[ 86, 204]],
          [[ 86, 202]],
          [[ 85, 201]],
          [[ 85, 200]],
          [[ 84, 199]],
          [[ 83, 199]],
          [[ 70, 186]],
          [[ 70, 185]],
          [[ 68, 183]],
          [[ 68, 182]],
          [[ 67, 181]],
          [[ 67, 180]],
          [[ 65, 178]],
          [[ 65, 177]],
          [[ 64, 176]],
          [[ 64, 175]],
          [[ 63, 174]],
          [[ 63, 173]],
          [[ 62, 172]],
          [[ 62, 170]],
          [[ 60, 168]],
          [[ 60, 163]],
          [[ 59, 162]],
          [[ 59, 160]],
          [[ 60, 159]],
          [[ 60, 158]],
          [[ 59, 157]],
          [[ 59, 155]],
          [[ 58, 154]],
          [[ 57, 154]],
          [[ 54, 151]]], 
          dtype=np.int32),
    np.array([[[ 39, 116]],
          [[ 38, 117]],
          [[ 36, 117]],
          [[ 35, 118]],
          [[ 34, 118]],
          [[ 33, 119]],
          [[ 29, 119]],
          [[ 28, 118]],
          [[ 24, 118]],
          [[ 22, 120]],
          [[ 22, 125]],
          [[ 24, 127]],
          [[ 24, 128]],
          [[ 25, 129]],
          [[ 25, 134]],
          [[ 26, 135]],
          [[ 26, 136]],
          [[ 27, 137]],
          [[ 27, 142]],
          [[ 28, 143]],
          [[ 28, 151]],
          [[ 29, 152]],
          [[ 29, 153]],
          [[ 37, 153]],
          [[ 38, 152]],
          [[ 43, 152]],
          [[ 44, 151]],
          [[ 45, 151]],
          [[ 46, 150]],
          [[ 47, 150]],
          [[ 48, 149]],
          [[ 53, 149]],
          [[ 54, 148]],
          [[ 55, 148]],
          [[ 55, 145]],
          [[ 50, 140]],
          [[ 50, 139]],
          [[ 47, 136]],
          [[ 47, 135]],
          [[ 45, 133]],
          [[ 45, 132]],
          [[ 44, 131]],
          [[ 44, 124]],
          [[ 45, 123]],
          [[ 45, 121]],
          [[ 46, 120]],
          [[ 42, 116]]], 
          dtype=np.int32),
    np.array([[[ 27,  85]],
          [[ 26,  86]],
          [[ 23,  86]],
          [[ 21,  88]],
          [[ 21,  91]],
          [[ 22,  92]],
          [[ 22,  93]],
          [[ 23,  94]],
          [[ 23,  96]],
          [[ 24,  97]],
          [[ 24, 100]],
          [[ 25, 101]],
          [[ 25, 102]],
          [[ 24, 103]],
          [[ 24, 106]],
          [[ 23, 107]],
          [[ 23, 108]],
          [[ 22, 109]],
          [[ 22, 110]],
          [[ 21, 111]],
          [[ 21, 115]],
          [[ 22, 116]],
          [[ 33, 116]],
          [[ 34, 115]],
          [[ 37, 115]],
          [[ 38, 114]],
          [[ 41, 114]],
          [[ 42, 113]],
          [[ 43, 113]],
          [[ 42, 112]],
          [[ 42, 111]],
          [[ 43, 110]],
          [[ 42, 109]],
          [[ 41, 109]],
          [[ 36, 104]],
          [[ 36, 103]],
          [[ 34, 101]],
          [[ 34,  98]],
          [[ 33,  97]],
          [[ 33,  94]],
          [[ 34,  93]],
          [[ 34,  87]],
          [[ 33,  86]],
          [[ 30,  86]],
          [[ 29,  85]]], 
          dtype=np.int32),
    np.array([[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 99,  68]],
      [[100,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]], 
      dtype=np.int32)
  ]
  distal_phalanx_1 = ExpectedContourDistalPhalanx(1)
  medial_phalanx_1 = ExpectedContourMedialPhalanx(1)
  proximal_phalanx_1 = ExpectedContourProximalPhalanx(1)
  metacarpal_phalanx_1 = ExpectedContourMetacarpal(
    1,
    first_in_branch=distal_phalanx_1,
    ends_branchs_sequence=True
  )
  distal_phalanx_2 = ExpectedContourDistalPhalanx(2)
  expected_contours = [
    distal_phalanx_1,
    medial_phalanx_1,
    proximal_phalanx_1,
    metacarpal_phalanx_1,
    distal_phalanx_2,
  ]
  contour_map = [
    3,
    2,
    1,
    0,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Metacarpal with jump',
    minimize_image=False,
  )

  contours = [
      np.array([[[317, 252]],
      [[316, 253]],
      [[314, 253]],
      [[313, 254]],
      [[309, 254]],
      [[309, 255]],
      [[306, 258]],
      [[305, 258]],
      [[303, 260]],
      [[303, 261]],
      [[301, 263]],
      [[299, 263]],
      [[298, 264]],
      [[298, 265]],
      [[292, 271]],
      [[291, 271]],
      [[287, 275]],
      [[286, 275]],
      [[284, 277]],
      [[283, 277]],
      [[280, 280]],
      [[279, 280]],
      [[277, 282]],
      [[276, 282]],
      [[275, 283]],
      [[274, 283]],
      [[273, 284]],
      [[272, 284]],
      [[271, 285]],
      [[270, 285]],
      [[268, 287]],
      [[266, 287]],
      [[265, 288]],
      [[264, 288]],
      [[263, 289]],
      [[261, 289]],
      [[260, 290]],
      [[257, 290]],
      [[256, 291]],
      [[253, 291]],
      [[252, 292]],
      [[247, 292]],
      [[246, 293]],
      [[243, 293]],
      [[242, 294]],
      [[240, 294]],
      [[239, 295]],
      [[236, 295]],
      [[235, 296]],
      [[233, 296]],
      [[230, 299]],
      [[230, 303]],
      [[232, 305]],
      [[232, 306]],
      [[235, 309]],
      [[236, 309]],
      [[238, 311]],
      [[238, 315]],
      [[239, 316]],
      [[240, 316]],
      [[242, 318]],
      [[243, 318]],
      [[244, 319]],
      [[250, 319]],
      [[251, 320]],
      [[253, 320]],
      [[254, 319]],
      [[256, 319]],
      [[257, 318]],
      [[258, 318]],
      [[259, 317]],
      [[260, 317]],
      [[261, 316]],
      [[263, 316]],
      [[265, 314]],
      [[266, 314]],
      [[267, 313]],
      [[268, 313]],
      [[271, 310]],
      [[272, 310]],
      [[277, 305]],
      [[278, 305]],
      [[280, 303]],
      [[281, 303]],
      [[283, 301]],
      [[284, 301]],
      [[286, 299]],
      [[287, 299]],
      [[289, 297]],
      [[290, 297]],
      [[292, 295]],
      [[293, 295]],
      [[294, 294]],
      [[295, 294]],
      [[296, 293]],
      [[297, 293]],
      [[299, 291]],
      [[300, 291]],
      [[301, 290]],
      [[302, 290]],
      [[304, 288]],
      [[305, 288]],
      [[306, 287]],
      [[307, 287]],
      [[308, 286]],
      [[309, 286]],
      [[311, 284]],
      [[312, 284]],
      [[314, 282]],
      [[315, 282]],
      [[316, 281]],
      [[317, 281]],
      [[318, 280]],
      [[319, 280]],
      [[321, 278]],
      [[323, 278]],
      [[324, 277]],
      [[325, 277]],
      [[326, 276]],
      [[327, 276]],
      [[328, 275]],
      [[329, 275]],
      [[331, 273]],
      [[332, 273]],
      [[332, 272]],
      [[334, 270]],
      [[334, 269]],
      [[335, 268]],
      [[335, 264]],
      [[334, 263]],
      [[334, 262]],
      [[332, 260]],
      [[331, 260]],
      [[328, 257]],
      [[327, 257]],
      [[326, 256]],
      [[325, 256]],
      [[324, 255]],
      [[323, 255]],
      [[321, 253]],
      [[320, 253]],
      [[319, 252]]]), # checked
      np.array([[[73, 211]],
      [[ 72, 212]],
      [[ 68, 212]],
      [[ 67, 213]],
      [[ 65, 213]],
      [[ 64, 214]],
      [[ 63, 214]],
      [[ 62, 215]],
      [[ 61, 215]],
      [[ 59, 217]],
      [[ 59, 218]],
      [[ 58, 219]],
      [[ 58, 220]],
      [[ 59, 221]],
      [[ 59, 225]],
      [[ 58, 226]],
      [[ 58, 229]],
      [[ 62, 233]],
      [[ 62, 234]],
      [[ 65, 237]],
      [[ 65, 238]],
      [[ 67, 240]],
      [[ 67, 241]],
      [[ 70, 244]],
      [[ 70, 245]],
      [[ 72, 247]],
      [[ 72, 248]],
      [[ 73, 249]],
      [[ 73, 250]],
      [[ 74, 251]],
      [[ 74, 252]],
      [[ 75, 253]],
      [[ 75, 254]],
      [[ 77, 256]],
      [[ 77, 257]],
      [[ 78, 258]],
      [[ 78, 259]],
      [[ 79, 260]],
      [[ 79, 261]],
      [[ 80, 262]],
      [[ 80, 263]],
      [[ 81, 264]],
      [[ 81, 265]],
      [[ 82, 266]],
      [[ 82, 267]],
      [[ 83, 268]],
      [[ 83, 269]],
      [[ 84, 270]],
      [[ 84, 271]],
      [[ 85, 272]],
      [[ 85, 273]],
      [[ 86, 274]],
      [[ 86, 276]],
      [[ 87, 277]],
      [[ 87, 280]],
      [[ 88, 281]],
      [[ 88, 285]],
      [[ 89, 286]],
      [[ 89, 295]],
      [[ 90, 296]],
      [[ 90, 298]],
      [[ 91, 299]],
      [[ 91, 300]],
      [[ 94, 303]],
      [[ 96, 303]],
      [[ 97, 304]],
      [[100, 304]],
      [[101, 305]],
      [[103, 305]],
      [[104, 304]],
      [[105, 304]],
      [[106, 303]],
      [[106, 302]],
      [[108, 300]],
      [[108, 299]],
      [[110, 297]],
      [[110, 296]],
      [[113, 293]],
      [[113, 292]],
      [[115, 290]],
      [[115, 289]],
      [[117, 287]],
      [[117, 286]],
      [[118, 285]],
      [[116, 283]],
      [[116, 282]],
      [[115, 282]],
      [[106, 273]],
      [[106, 272]],
      [[104, 270]],
      [[104, 269]],
      [[102, 267]],
      [[102, 266]],
      [[100, 264]],
      [[100, 263]],
      [[ 99, 262]],
      [[ 99, 261]],
      [[ 98, 260]],
      [[ 98, 259]],
      [[ 97, 258]],
      [[ 97, 257]],
      [[ 96, 256]],
      [[ 96, 255]],
      [[ 95, 254]],
      [[ 95, 253]],
      [[ 94, 252]],
      [[ 94, 250]],
      [[ 93, 249]],
      [[ 93, 248]],
      [[ 92, 247]],
      [[ 92, 246]],
      [[ 91, 245]],
      [[ 91, 243]],
      [[ 90, 242]],
      [[ 90, 240]],
      [[ 89, 239]],
      [[ 89, 237]],
      [[ 88, 236]],
      [[ 88, 227]],
      [[ 87, 226]],
      [[ 87, 223]],
      [[ 86, 222]],
      [[ 86, 220]],
      [[ 78, 212]],
      [[ 76, 212]],
      [[ 75, 211]]]), # checked
      np.array(
      [[[356, 201]],
      [[355, 202]],
      [[350, 202]],
      [[349, 203]],
      [[348, 203]],
      [[347, 204]],
      [[346, 204]],
      [[345, 205]],
      [[344, 205]],
      [[343, 206]],
      [[343, 210]],
      [[344, 211]],
      [[344, 215]],
      [[343, 216]],
      [[343, 217]],
      [[341, 219]],
      [[341, 220]],
      [[335, 226]],
      [[334, 226]],
      [[331, 229]],
      [[330, 229]],
      [[328, 231]],
      [[327, 231]],
      [[326, 232]],
      [[325, 232]],
      [[324, 233]],
      [[323, 233]],
      [[322, 234]],
      [[321, 234]],
      [[320, 235]],
      [[319, 235]],
      [[318, 236]],
      [[317, 236]],
      [[316, 237]],
      [[315, 237]],
      [[314, 238]],
      [[312, 238]],
      [[311, 239]],
      [[310, 239]],
      [[307, 242]],
      [[307, 247]],
      [[309, 249]],
      [[316, 249]],
      [[317, 250]],
      [[320, 250]],
      [[321, 251]],
      [[322, 251]],
      [[323, 252]],
      [[324, 252]],
      [[325, 253]],
      [[327, 253]],
      [[328, 254]],
      [[329, 254]],
      [[332, 257]],
      [[332, 258]],
      [[335, 258]],
      [[336, 259]],
      [[339, 259]],
      [[340, 258]],
      [[343, 258]],
      [[344, 257]],
      [[344, 255]],
      [[345, 254]],
      [[345, 252]],
      [[346, 251]],
      [[346, 250]],
      [[347, 249]],
      [[347, 247]],
      [[348, 246]],
      [[348, 245]],
      [[349, 244]],
      [[349, 243]],
      [[351, 241]],
      [[351, 240]],
      [[354, 237]],
      [[354, 236]],
      [[359, 231]],
      [[359, 230]],
      [[367, 222]],
      [[368, 222]],
      [[374, 216]],
      [[374, 215]],
      [[376, 213]],
      [[373, 210]],
      [[372, 210]],
      [[371, 209]],
      [[370, 209]],
      [[367, 206]],
      [[366, 206]],
      [[363, 203]],
      [[362, 203]],
      [[361, 202]],
      [[360, 202]],
      [[359, 201]]]), # checked
      np.array(
      [[[116, 196]],
      [[115, 197]],
      [[110, 197]],
      [[109, 198]],
      [[106, 198]],
      [[105, 199]],
      [[104, 199]],
      [[102, 201]],
      [[102, 204]],
      [[103, 205]],
      [[103, 212]],
      [[104, 213]],
      [[104, 214]],
      [[107, 217]],
      [[107, 218]],
      [[109, 220]],
      [[109, 221]],
      [[110, 222]],
      [[110, 224]],
      [[111, 225]],
      [[111, 226]],
      [[112, 227]],
      [[112, 229]],
      [[113, 230]],
      [[113, 232]],
      [[114, 233]],
      [[114, 235]],
      [[115, 236]],
      [[115, 238]],
      [[116, 239]],
      [[116, 240]],
      [[117, 241]],
      [[117, 243]],
      [[118, 244]],
      [[118, 247]],
      [[119, 248]],
      [[119, 250]],
      [[120, 251]],
      [[120, 253]],
      [[121, 254]],
      [[121, 257]],
      [[122, 258]],
      [[122, 260]],
      [[123, 261]],
      [[123, 264]],
      [[124, 265]],
      [[124, 269]],
      [[125, 270]],
      [[125, 274]],
      [[124, 275]],
      [[124, 279]],
      [[123, 280]],
      [[123, 282]],
      [[124, 282]],
      [[125, 283]],
      [[126, 283]],
      [[127, 284]],
      [[128, 284]],
      [[129, 285]],
      [[131, 285]],
      [[132, 286]],
      [[133, 286]],
      [[134, 287]],
      [[135, 287]],
      [[136, 288]],
      [[138, 288]],
      [[139, 289]],
      [[140, 289]],
      [[141, 290]],
      [[143, 290]],
      [[144, 291]],
      [[145, 291]],
      [[146, 292]],
      [[147, 292]],
      [[148, 293]],
      [[149, 293]],
      [[149, 282]],
      [[148, 281]],
      [[148, 279]],
      [[147, 278]],
      [[147, 277]],
      [[146, 276]],
      [[146, 275]],
      [[143, 272]],
      [[143, 271]],
      [[141, 269]],
      [[141, 268]],
      [[140, 267]],
      [[140, 266]],
      [[139, 265]],
      [[139, 263]],
      [[138, 262]],
      [[138, 261]],
      [[137, 260]],
      [[137, 258]],
      [[136, 257]],
      [[136, 255]],
      [[135, 254]],
      [[135, 250]],
      [[134, 249]],
      [[134, 246]],
      [[133, 245]],
      [[133, 240]],
      [[132, 239]],
      [[132, 231]],
      [[131, 230]],
      [[131, 229]],
      [[132, 228]],
      [[132, 226]],
      [[131, 225]],
      [[131, 223]],
      [[132, 222]],
      [[132, 218]],
      [[133, 217]],
      [[133, 215]],
      [[134, 214]],
      [[134, 210]],
      [[133, 209]],
      [[133, 206]],
      [[131, 204]],
      [[131, 203]],
      [[129, 201]],
      [[129, 200]],
      [[128, 199]],
      [[128, 198]],
      [[127, 197]],
      [[124, 197]],
      [[123, 196]],
      [[122, 196]],
      [[121, 197]],
      [[120, 196]],
      [[118, 196]],
      [[117, 197]]]), # checked
      np.array(
      [[[156, 177]],
      [[155, 178]],
      [[151, 178]],
      [[150, 179]],
      [[149, 179]],
      [[147, 181]],
      [[147, 183]],
      [[146, 184]],
      [[146, 187]],
      [[145, 188]],
      [[145, 196]],
      [[147, 198]],
      [[147, 200]],
      [[148, 201]],
      [[148, 202]],
      [[149, 203]],
      [[149, 205]],
      [[150, 206]],
      [[150, 208]],
      [[151, 209]],
      [[151, 212]],
      [[152, 213]],
      [[152, 216]],
      [[153, 217]],
      [[153, 221]],
      [[154, 222]],
      [[154, 226]],
      [[155, 227]],
      [[155, 232]],
      [[156, 233]],
      [[156, 240]],
      [[157, 241]],
      [[157, 267]],
      [[156, 268]],
      [[156, 272]],
      [[155, 273]],
      [[155, 276]],
      [[154, 277]],
      [[154, 284]],
      [[153, 285]],
      [[153, 292]],
      [[152, 293]],
      [[152, 294]],
      [[153, 294]],
      [[154, 293]],
      [[155, 293]],
      [[156, 292]],
      [[157, 292]],
      [[158, 291]],
      [[159, 291]],
      [[160, 290]],
      [[161, 290]],
      [[162, 289]],
      [[163, 289]],
      [[164, 288]],
      [[165, 288]],
      [[166, 287]],
      [[167, 287]],
      [[168, 286]],
      [[170, 286]],
      [[171, 285]],
      [[172, 285]],
      [[173, 284]],
      [[174, 284]],
      [[175, 283]],
      [[176, 283]],
      [[177, 282]],
      [[178, 282]],
      [[179, 281]],
      [[180, 281]],
      [[181, 280]],
      [[182, 280]],
      [[183, 279]],
      [[184, 279]],
      [[185, 278]],
      [[186, 278]],
      [[187, 277]],
      [[188, 277]],
      [[188, 276]],
      [[187, 275]],
      [[187, 274]],
      [[186, 273]],
      [[186, 272]],
      [[183, 269]],
      [[183, 268]],
      [[181, 266]],
      [[181, 265]],
      [[180, 264]],
      [[180, 263]],
      [[179, 262]],
      [[179, 258]],
      [[178, 257]],
      [[178, 254]],
      [[177, 253]],
      [[177, 244]],
      [[176, 243]],
      [[176, 217]],
      [[177, 216]],
      [[177, 210]],
      [[178, 209]],
      [[178, 207]],
      [[179, 206]],
      [[179, 204]],
      [[181, 202]],
      [[181, 199]],
      [[182, 198]],
      [[182, 197]],
      [[181, 196]],
      [[181, 195]],
      [[180, 194]],
      [[181, 193]],
      [[180, 192]],
      [[180, 190]],
      [[179, 189]],
      [[179, 188]],
      [[177, 186]],
      [[177, 185]],
      [[174, 182]],
      [[175, 181]],
      [[173, 179]],
      [[171, 179]],
      [[170, 178]],
      [[167, 178]],
      [[166, 177]]]), # checked
      np.array(
      [[[220, 173]],
      [[219, 174]],
      [[214, 174]],
      [[213, 175]],
      [[212, 175]],
      [[211, 176]],
      [[211, 178]],
      [[210, 179]],
      [[210, 181]],
      [[208, 183]],
      [[208, 184]],
      [[207, 185]],
      [[207, 189]],
      [[208, 190]],
      [[208, 195]],
      [[207, 196]],
      [[207, 197]],
      [[208, 198]],
      [[208, 208]],
      [[209, 209]],
      [[209, 215]],
      [[210, 216]],
      [[210, 220]],
      [[209, 221]],
      [[209, 231]],
      [[208, 232]],
      [[208, 236]],
      [[207, 237]],
      [[207, 241]],
      [[206, 242]],
      [[206, 246]],
      [[205, 247]],
      [[205, 250]],
      [[204, 251]],
      [[204, 253]],
      [[203, 254]],
      [[203, 256]],
      [[202, 257]],
      [[202, 259]],
      [[201, 260]],
      [[201, 261]],
      [[200, 262]],
      [[200, 263]],
      [[199, 264]],
      [[199, 265]],
      [[198, 266]],
      [[198, 267]],
      [[197, 268]],
      [[197, 269]],
      [[196, 270]],
      [[196, 271]],
      [[195, 272]],
      [[195, 273]],
      [[191, 277]],
      [[191, 278]],
      [[190, 279]],
      [[189, 279]],
      [[186, 282]],
      [[186, 284]],
      [[185, 285]],
      [[187, 285]],
      [[188, 286]],
      [[191, 286]],
      [[192, 287]],
      [[196, 287]],
      [[197, 288]],
      [[200, 288]],
      [[201, 289]],
      [[204, 289]],
      [[205, 290]],
      [[209, 290]],
      [[210, 291]],
      [[213, 291]],
      [[214, 292]],
      [[218, 292]],
      [[219, 293]],
      [[222, 293]],
      [[223, 294]],
      [[225, 294]],
      [[225, 293]],
      [[226, 292]],
      [[226, 291]],
      [[227, 290]],
      [[227, 289]],
      [[228, 288]],
      [[228, 286]],
      [[227, 285]],
      [[227, 284]],
      [[226, 283]],
      [[226, 282]],
      [[225, 281]],
      [[225, 278]],
      [[224, 277]],
      [[224, 260]],
      [[225, 259]],
      [[225, 254]],
      [[226, 253]],
      [[226, 250]],
      [[227, 249]],
      [[227, 246]],
      [[228, 245]],
      [[228, 241]],
      [[229, 240]],
      [[229, 236]],
      [[230, 235]],
      [[230, 232]],
      [[231, 231]],
      [[231, 228]],
      [[232, 227]],
      [[232, 223]],
      [[233, 222]],
      [[233, 220]],
      [[234, 219]],
      [[234, 216]],
      [[235, 215]],
      [[235, 212]],
      [[236, 211]],
      [[236, 210]],
      [[237, 209]],
      [[237, 207]],
      [[238, 206]],
      [[238, 204]],
      [[239, 203]],
      [[239, 201]],
      [[241, 199]],
      [[241, 198]],
      [[242, 197]],
      [[242, 194]],
      [[243, 193]],
      [[243, 191]],
      [[242, 190]],
      [[242, 186]],
      [[241, 185]],
      [[241, 184]],
      [[240, 183]],
      [[240, 182]],
      [[235, 177]],
      [[234, 177]],
      [[232, 175]],
      [[229, 175]],
      [[228, 174]],
      [[224, 174]],
      [[223, 173]]]), # checked
      np.array(
      [[[391, 172]],
      [[390, 173]],
      [[388, 173]],
      [[385, 176]],
      [[384, 176]],
      [[382, 178]],
      [[382, 179]],
      [[379, 182]],
      [[378, 182]],
      [[376, 184]],
      [[375, 184]],
      [[373, 186]],
      [[372, 186]],
      [[371, 187]],
      [[370, 187]],
      [[369, 188]],
      [[367, 188]],
      [[366, 189]],
      [[365, 189]],
      [[364, 190]],
      [[363, 190]],
      [[362, 191]],
      [[359, 191]],
      [[358, 192]],
      [[356, 192]],
      [[355, 193]],
      [[354, 193]],
      [[352, 195]],
      [[352, 196]],
      [[353, 197]],
      [[353, 198]],
      [[356, 198]],
      [[357, 199]],
      [[360, 199]],
      [[361, 200]],
      [[364, 200]],
      [[367, 203]],
      [[367, 204]],
      [[368, 204]],
      [[370, 206]],
      [[372, 206]],
      [[373, 207]],
      [[374, 207]],
      [[376, 209]],
      [[376, 210]],
      [[377, 209]],
      [[379, 209]],
      [[380, 208]],
      [[380, 206]],
      [[381, 205]],
      [[381, 203]],
      [[382, 202]],
      [[382, 200]],
      [[383, 199]],
      [[383, 198]],
      [[385, 196]],
      [[385, 195]],
      [[395, 185]],
      [[396, 185]],
      [[398, 183]],
      [[400, 183]],
      [[404, 179]],
      [[403, 179]],
      [[402, 178]],
      [[402, 175]],
      [[400, 173]],
      [[399, 173]],
      [[398, 172]],
      [[397, 173]],
      [[395, 173]],
      [[394, 172]]]), # checked
      np.array(
      [[[ 53, 151]],
      [[ 51, 153]],
      [[ 49, 153]],
      [[ 48, 154]],
      [[ 46, 154]],
      [[ 45, 155]],
      [[ 37, 155]],
      [[ 36, 156]],
      [[ 35, 156]],
      [[ 35, 164]],
      [[ 38, 167]],
      [[ 38, 168]],
      [[ 40, 170]],
      [[ 40, 171]],
      [[ 42, 173]],
      [[ 42, 174]],
      [[ 43, 175]],
      [[ 43, 177]],
      [[ 44, 178]],
      [[ 44, 180]],
      [[ 45, 181]],
      [[ 45, 183]],
      [[ 46, 184]],
      [[ 46, 185]],
      [[ 47, 186]],
      [[ 47, 187]],
      [[ 48, 188]],
      [[ 48, 191]],
      [[ 49, 192]],
      [[ 49, 195]],
      [[ 50, 196]],
      [[ 50, 203]],
      [[ 49, 204]],
      [[ 49, 211]],
      [[ 51, 213]],
      [[ 59, 213]],
      [[ 60, 212]],
      [[ 61, 212]],
      [[ 62, 211]],
      [[ 64, 211]],
      [[ 65, 210]],
      [[ 67, 210]],
      [[ 68, 209]],
      [[ 71, 209]],
      [[ 72, 208]],
      [[ 83, 208]],
      [[ 84, 207]],
      [[ 85, 207]],
      [[ 85, 205]],
      [[ 86, 204]],
      [[ 86, 202]],
      [[ 85, 201]],
      [[ 85, 200]],
      [[ 84, 199]],
      [[ 83, 199]],
      [[ 70, 186]],
      [[ 70, 185]],
      [[ 68, 183]],
      [[ 68, 182]],
      [[ 67, 181]],
      [[ 67, 180]],
      [[ 65, 178]],
      [[ 65, 177]],
      [[ 64, 176]],
      [[ 64, 175]],
      [[ 63, 174]],
      [[ 63, 173]],
      [[ 62, 172]],
      [[ 62, 170]],
      [[ 60, 168]],
      [[ 60, 163]],
      [[ 59, 162]],
      [[ 59, 160]],
      [[ 60, 159]],
      [[ 60, 158]],
      [[ 59, 157]],
      [[ 59, 155]],
      [[ 58, 154]],
      [[ 57, 154]],
      [[ 54, 151]]]), # checked
      np.array(
      [[[112, 121]],
      [[111, 122]],
      [[ 95, 122]],
      [[ 94, 123]],
      [[ 94, 125]],
      [[ 93, 126]],
      [[ 93, 129]],
      [[ 92, 130]],
      [[ 93, 131]],
      [[ 92, 132]],
      [[ 93, 133]],
      [[ 93, 134]],
      [[ 94, 135]],
      [[ 94, 136]],
      [[ 96, 138]],
      [[ 96, 142]],
      [[ 97, 143]],
      [[ 97, 148]],
      [[ 98, 149]],
      [[ 98, 152]],
      [[ 99, 153]],
      [[ 99, 155]],
      [[100, 156]],
      [[100, 158]],
      [[101, 159]],
      [[101, 162]],
      [[102, 163]],
      [[102, 179]],
      [[101, 180]],
      [[101, 182]],
      [[100, 183]],
      [[100, 187]],
      [[ 99, 188]],
      [[ 99, 190]],
      [[100, 191]],
      [[100, 193]],
      [[101, 194]],
      [[102, 194]],
      [[103, 195]],
      [[106, 195]],
      [[107, 194]],
      [[113, 194]],
      [[114, 193]],
      [[125, 193]],
      [[126, 194]],
      [[130, 194]],
      [[131, 193]],
      [[133, 193]],
      [[135, 191]],
      [[135, 187]],
      [[134, 186]],
      [[134, 184]],
      [[133, 183]],
      [[133, 182]],
      [[131, 180]],
      [[131, 179]],
      [[130, 178]],
      [[130, 177]],
      [[128, 175]],
      [[128, 174]],
      [[127, 173]],
      [[127, 172]],
      [[126, 171]],
      [[126, 169]],
      [[125, 168]],
      [[125, 165]],
      [[124, 164]],
      [[124, 154]],
      [[123, 153]],
      [[123, 143]],
      [[122, 142]],
      [[122, 139]],
      [[121, 138]],
      [[121, 132]],
      [[122, 131]],
      [[122, 129]],
      [[123, 128]],
      [[122, 127]],
      [[122, 126]],
      [[119, 123]],
      [[119, 122]],
      [[118, 121]]]), # checked
      np.array(
      [[[ 39, 116]],
      [[ 38, 117]],
      [[ 36, 117]],
      [[ 35, 118]],
      [[ 34, 118]],
      [[ 33, 119]],
      [[ 29, 119]],
      [[ 28, 118]],
      [[ 24, 118]],
      [[ 22, 120]],
      [[ 22, 125]],
      [[ 24, 127]],
      [[ 24, 128]],
      [[ 25, 129]],
      [[ 25, 134]],
      [[ 26, 135]],
      [[ 26, 136]],
      [[ 27, 137]],
      [[ 27, 142]],
      [[ 28, 143]],
      [[ 28, 151]],
      [[ 29, 152]],
      [[ 29, 153]],
      [[ 37, 153]],
      [[ 38, 152]],
      [[ 43, 152]],
      [[ 44, 151]],
      [[ 45, 151]],
      [[ 46, 150]],
      [[ 47, 150]],
      [[ 48, 149]],
      [[ 53, 149]],
      [[ 54, 148]],
      [[ 55, 148]],
      [[ 55, 145]],
      [[ 50, 140]],
      [[ 50, 139]],
      [[ 47, 136]],
      [[ 47, 135]],
      [[ 45, 133]],
      [[ 45, 132]],
      [[ 44, 131]],
      [[ 44, 124]],
      [[ 45, 123]],
      [[ 45, 121]],
      [[ 46, 120]],
      [[ 42, 116]]]), # checked
      np.array(
      [[[240,  99]],
      [[240, 100]],
      [[238, 102]],
      [[238, 103]],
      [[235, 106]],
      [[235, 108]],
      [[234, 109]],
      [[235, 110]],
      [[235, 115]],
      [[234, 116]],
      [[234, 119]],
      [[233, 120]],
      [[233, 122]],
      [[232, 123]],
      [[232, 124]],
      [[231, 125]],
      [[231, 127]],
      [[230, 128]],
      [[230, 130]],
      [[229, 131]],
      [[229, 133]],
      [[228, 134]],
      [[228, 135]],
      [[227, 136]],
      [[227, 138]],
      [[226, 139]],
      [[226, 140]],
      [[225, 141]],
      [[225, 142]],
      [[224, 143]],
      [[224, 144]],
      [[223, 145]],
      [[223, 146]],
      [[222, 147]],
      [[222, 148]],
      [[220, 150]],
      [[220, 151]],
      [[209, 162]],
      [[209, 163]],
      [[208, 164]],
      [[208, 169]],
      [[209, 170]],
      [[210, 170]],
      [[211, 171]],
      [[215, 171]],
      [[216, 170]],
      [[227, 170]],
      [[228, 171]],
      [[229, 171]],
      [[230, 172]],
      [[233, 172]],
      [[234, 173]],
      [[235, 173]],
      [[236, 174]],
      [[238, 174]],
      [[239, 175]],
      [[249, 175]],
      [[250, 174]],
      [[250, 173]],
      [[251, 172]],
      [[251, 171]],
      [[252, 170]],
      [[252, 169]],
      [[251, 168]],
      [[251, 164]],
      [[250, 163]],
      [[250, 148]],
      [[251, 147]],
      [[251, 144]],
      [[252, 143]],
      [[252, 141]],
      [[253, 140]],
      [[253, 138]],
      [[254, 137]],
      [[254, 135]],
      [[255, 134]],
      [[255, 131]],
      [[256, 130]],
      [[256, 127]],
      [[257, 126]],
      [[257, 125]],
      [[258, 124]],
      [[258, 122]],
      [[260, 120]],
      [[260, 119]],
      [[265, 114]],
      [[265, 107]],
      [[264, 106]],
      [[264, 104]],
      [[262, 102]],
      [[249, 102]],
      [[248, 101]],
      [[246, 101]],
      [[245, 100]],
      [[241, 100]]]), # checked
      np.array(
      [[[160,  94]],
      [[159,  95]],
      [[159,  96]],
      [[158,  97]],
      [[158,  98]],
      [[156, 100]],
      [[156, 102]],
      [[155, 103]],
      [[156, 104]],
      [[156, 107]],
      [[157, 108]],
      [[157, 118]],
      [[156, 119]],
      [[156, 143]],
      [[155, 144]],
      [[155, 148]],
      [[154, 149]],
      [[154, 152]],
      [[153, 153]],
      [[153, 154]],
      [[152, 155]],
      [[152, 156]],
      [[151, 157]],
      [[151, 158]],
      [[150, 159]],
      [[150, 160]],
      [[148, 162]],
      [[148, 163]],
      [[147, 164]],
      [[147, 167]],
      [[146, 168]],
      [[146, 173]],
      [[147, 174]],
      [[149, 174]],
      [[150, 175]],
      [[152, 175]],
      [[153, 174]],
      [[162, 174]],
      [[163, 173]],
      [[164, 174]],
      [[169, 174]],
      [[170, 175]],
      [[172, 175]],
      [[173, 176]],
      [[176, 176]],
      [[177, 177]],
      [[182, 177]],
      [[183, 176]],
      [[185, 176]],
      [[186, 175]],
      [[187, 175]],
      [[188, 174]],
      [[188, 170]],
      [[187, 169]],
      [[187, 166]],
      [[186, 165]],
      [[186, 163]],
      [[185, 162]],
      [[185, 161]],
      [[184, 160]],
      [[184, 157]],
      [[183, 156]],
      [[183, 152]],
      [[182, 151]],
      [[182, 137]],
      [[183, 136]],
      [[183, 130]],
      [[184, 129]],
      [[184, 113]],
      [[185, 112]],
      [[185, 111]],
      [[186, 110]],
      [[186, 109]],
      [[188, 107]],
      [[188, 102]],
      [[187, 101]],
      [[187,  99]],
      [[186,  98]],
      [[186,  97]],
      [[183,  94]],
      [[180,  94]],
      [[179,  95]],
      [[163,  95]],
      [[162,  94]]]), # checked
      np.array(
      [[[ 27,  85]],
      [[ 26,  86]],
      [[ 23,  86]],
      [[ 21,  88]],
      [[ 21,  91]],
      [[ 22,  92]],
      [[ 22,  93]],
      [[ 23,  94]],
      [[ 23,  96]],
      [[ 24,  97]],
      [[ 24, 100]],
      [[ 25, 101]],
      [[ 25, 102]],
      [[ 24, 103]],
      [[ 24, 106]],
      [[ 23, 107]],
      [[ 23, 108]],
      [[ 22, 109]],
      [[ 22, 110]],
      [[ 21, 111]],
      [[ 21, 115]],
      [[ 22, 116]],
      [[ 33, 116]],
      [[ 34, 115]],
      [[ 37, 115]],
      [[ 38, 114]],
      [[ 41, 114]],
      [[ 42, 113]],
      [[ 43, 113]],
      [[ 42, 112]],
      [[ 42, 111]],
      [[ 43, 110]],
      [[ 42, 109]],
      [[ 41, 109]],
      [[ 36, 104]],
      [[ 36, 103]],
      [[ 34, 101]],
      [[ 34,  98]],
      [[ 33,  97]],
      [[ 33,  94]],
      [[ 34,  93]],
      [[ 34,  87]],
      [[ 33,  86]],
      [[ 30,  86]],
      [[ 29,  85]]]), # checked
      np.array(
      [[[ 91,  70]],
      [[ 90,  71]],
      [[ 90,  72]],
      [[ 88,  74]],
      [[ 88,  79]],
      [[ 91,  82]],
      [[ 91,  84]],
      [[ 92,  85]],
      [[ 92, 100]],
      [[ 91, 101]],
      [[ 91, 106]],
      [[ 90, 107]],
      [[ 90, 110]],
      [[ 89, 111]],
      [[ 89, 112]],
      [[ 88, 113]],
      [[ 88, 117]],
      [[ 90, 119]],
      [[109, 119]],
      [[110, 118]],
      [[113, 118]],
      [[114, 117]],
      [[121, 117]],
      [[121, 114]],
      [[122, 113]],
      [[119, 110]],
      [[119, 109]],
      [[118, 108]],
      [[118, 107]],
      [[116, 105]],
      [[116, 103]],
      [[115, 102]],
      [[115,  98]],
      [[114,  97]],
      [[114,  95]],
      [[113,  94]],
      [[113,  82]],
      [[114,  81]],
      [[114,  80]],
      [[116,  78]],
      [[116,  74]],
      [[112,  70]],
      [[108,  70]],
      [[107,  71]],
      [[ 98,  71]],
      [[ 97,  70]]]), # checked
      np.array(
      [[[261,  56]],
      [[260,  57]],
      [[247,  57]],
      [[246,  58]],
      [[246,  59]],
      [[245,  60]],
      [[245,  61]],
      [[244,  62]],
      [[244,  63]],
      [[245,  64]],
      [[245,  68]],
      [[246,  69]],
      [[245,  70]],
      [[245,  75]],
      [[244,  76]],
      [[244,  79]],
      [[243,  80]],
      [[243,  83]],
      [[242,  84]],
      [[242,  85]],
      [[240,  87]],
      [[240,  88]],
      [[239,  89]],
      [[239,  90]],
      [[238,  91]],
      [[238,  92]],
      [[237,  93]],
      [[237,  96]],
      [[238,  97]],
      [[245,  97]],
      [[246,  98]],
      [[249,  98]],
      [[250,  99]],
      [[269,  99]],
      [[270,  98]],
      [[271,  98]],
      [[271,  94]],
      [[270,  93]],
      [[270,  92]],
      [[269,  91]],
      [[269,  88]],
      [[268,  87]],
      [[268,  85]],
      [[267,  84]],
      [[267,  82]],
      [[266,  81]],
      [[266,  78]],
      [[265,  77]],
      [[265,  73]],
      [[266,  72]],
      [[266,  69]],
      [[268,  67]],
      [[268,  66]],
      [[269,  65]],
      [[269,  63]],
      [[270,  62]],
      [[270,  59]],
      [[267,  56]]]), # checked
      np.array(
      [[[176,  40]],
      [[175,  41]],
      [[171,  41]],
      [[170,  42]],
      [[158,  42]],
      [[158,  43]],
      [[157,  44]],
      [[157,  45]],
      [[156,  46]],
      [[156,  47]],
      [[155,  48]],
      [[155,  49]],
      [[156,  50]],
      [[156,  52]],
      [[157,  53]],
      [[157,  54]],
      [[158,  55]],
      [[158,  57]],
      [[159,  58]],
      [[159,  73]],
      [[158,  74]],
      [[158,  77]],
      [[157,  78]],
      [[157,  81]],
      [[156,  82]],
      [[156,  84]],
      [[155,  85]],
      [[155,  90]],
      [[157,  92]],
      [[160,  92]],
      [[161,  91]],
      [[166,  91]],
      [[167,  92]],
      [[180,  92]],
      [[181,  91]],
      [[186,  91]],
      [[187,  90]],
      [[190,  90]],
      [[191,  89]],
      [[191,  85]],
      [[190,  84]],
      [[190,  83]],
      [[188,  81]],
      [[188,  79]],
      [[187,  78]],
      [[187,  77]],
      [[186,  76]],
      [[186,  74]],
      [[185,  73]],
      [[185,  71]],
      [[184,  70]],
      [[184,  67]],
      [[183,  66]],
      [[183,  65]],
      [[182,  64]],
      [[182,  62]],
      [[181,  61]],
      [[181,  54]],
      [[182,  53]],
      [[182,  52]],
      [[183,  51]],
      [[183,  48]],
      [[184,  47]],
      [[184,  46]],
      [[183,  45]],
      [[183,  44]],
      [[179,  40]]]), # checked
      np.array(
      [[[ 98,  35]],
      [[ 97,  36]],
      [[ 96,  36]],
      [[ 94,  38]],
      [[ 94,  39]],
      [[ 93,  40]],
      [[ 93,  42]],
      [[ 94,  43]],
      [[ 94,  44]],
      [[ 95,  45]],
      [[ 95,  47]],
      [[ 96,  48]],
      [[ 96,  50]],
      [[ 95,  51]],
      [[ 95,  54]],
      [[ 94,  55]],
      [[ 94,  56]],
      [[ 93,  57]],
      [[ 93,  58]],
      [[ 88,  63]],
      [[ 88,  67]],
      [[ 90,  67]],
      [[ 91,  68]],
      [[ 98,  68]],
      [[ 99,  69]],
      [[104,  69]],
      [[105,  68]],
      [[111,  68]],
      [[112,  67]],
      [[115,  67]],
      [[115,  63]],
      [[110,  58]],
      [[110,  57]],
      [[109,  56]],
      [[109,  55]],
      [[108,  54]],
      [[108,  50]],
      [[109,  49]],
      [[109,  46]],
      [[110,  45]],
      [[110,  44]],
      [[111,  43]],
      [[111,  41]],
      [[110,  40]],
      [[110,  37]],
      [[109,  37]],
      [[108,  36]],
      [[106,  36]],
      [[105,  35]]]), # checked
      np.array([[[251,  23]],
      [[250,  24]],
      [[247,  24]],
      [[245,  26]],
      [[245,  27]],
      [[244,  28]],
      [[244,  30]],
      [[246,  32]],
      [[246,  33]],
      [[247,  34]],
      [[247,  35]],
      [[248,  36]],
      [[248,  41]],
      [[249,  42]],
      [[248,  43]],
      [[248,  46]],
      [[246,  48]],
      [[246,  49]],
      [[245,  50]],
      [[245,  53]],
      [[246,  54]],
      [[254,  54]],
      [[255,  55]],
      [[256,  55]],
      [[257,  54]],
      [[262,  54]],
      [[263,  53]],
      [[268,  53]],
      [[269,  52]],
      [[269,  51]],
      [[268,  50]],
      [[268,  49]],
      [[261,  42]],
      [[261,  41]],
      [[260,  40]],
      [[260,  39]],
      [[259,  38]],
      [[259,  35]],
      [[258,  34]],
      [[258,  31]],
      [[259,  30]],
      [[259,  27]],
      [[258,  26]],
      [[257,  26]],
      [[255,  24]],
      [[252,  24]]]), # checked
      np.array(
      [[[160,   7]],
      [[159,   8]],
      [[159,   9]],
      [[158,  10]],
      [[157,  10]],
      [[155,   8]],
      [[155,   9]],
      [[154,  10]],
      [[154,  12]],
      [[153,  13]],
      [[153,  14]],
      [[154,  15]],
      [[154,  17]],
      [[155,  17]],
      [[156,  18]],
      [[156,  19]],
      [[157,  20]],
      [[157,  21]],
      [[158,  22]],
      [[158,  30]],
      [[157,  31]],
      [[157,  32]],
      [[154,  35]],
      [[154,  38]],
      [[155,  38]],
      [[156,  39]],
      [[172,  39]],
      [[173,  38]],
      [[177,  38]],
      [[178,  37]],
      [[180,  37]],
      [[181,  36]],
      [[182,  36]],
      [[181,  35]],
      [[181,  34]],
      [[178,  31]],
      [[177,  31]],
      [[176,  30]],
      [[176,  29]],
      [[172,  25]],
      [[172,  24]],
      [[171,  23]],
      [[171,  20]],
      [[170,  19]],
      [[170,  16]],
      [[171,  15]],
      [[171,  14]],
      [[170,  13]],
      [[171,  12]],
      [[167,   8]],
      [[164,   8]],
      [[163,   7]]]), # checked
      np.array(
        [[[ 87, 342]],
        [[ 86, 343]],
        [[ 85, 343]],
        [[ 80, 348]],
        [[ 80, 349]],
        [[ 79, 350]],
        [[ 78, 350]],
        [[ 77, 351]],
        [[ 77, 356]],
        [[ 73, 360]],
        [[ 73, 361]],
        [[ 72, 362]],
        [[ 72, 364]],
        [[ 71, 365]],
        [[ 71, 366]],
        [[ 70, 367]],
        [[ 70, 369]],
        [[ 69, 370]],
        [[ 69, 371]],
        [[ 68, 372]],
        [[ 68, 374]],
        [[ 67, 375]],
        [[ 67, 376]],
        [[ 66, 377]],
        [[ 66, 378]],
        [[ 65, 379]],
        [[ 65, 380]],
        [[ 64, 381]],
        [[ 64, 382]],
        [[ 63, 383]],
        [[ 63, 384]],
        [[ 62, 385]],
        [[ 62, 386]],
        [[ 61, 387]],
        [[ 61, 388]],
        [[ 59, 390]],
        [[ 59, 391]],
        [[ 58, 392]],
        [[ 58, 393]],
        [[ 57, 394]],
        [[ 57, 395]],
        [[ 55, 397]],
        [[ 55, 398]],
        [[ 53, 400]],
        [[ 53, 401]],
        [[ 52, 402]],
        [[ 52, 403]],
        [[ 50, 405]],
        [[ 50, 406]],
        [[ 48, 408]],
        [[ 48, 409]],
        [[ 46, 411]],
        [[ 46, 412]],
        [[ 45, 413]],
        [[ 45, 414]],
        [[ 43, 416]],
        [[ 43, 417]],
        [[ 41, 419]],
        [[ 41, 420]],
        [[ 40, 421]],
        [[ 40, 422]],
        [[ 37, 425]],
        [[ 37, 426]],
        [[ 36, 427]],
        [[ 36, 428]],
        [[ 35, 429]],
        [[ 35, 430]],
        [[ 33, 432]],
        [[ 33, 433]],
        [[ 31, 435]],
        [[ 31, 436]],
        [[ 30, 437]],
        [[ 30, 438]],
        [[ 29, 439]],
        [[ 29, 440]],
        [[ 27, 442]],
        [[ 27, 444]],
        [[ 59, 444]],
        [[ 59, 443]],
        [[ 62, 440]],
        [[ 62, 439]],
        [[ 64, 437]],
        [[ 64, 435]],
        [[ 65, 434]],
        [[ 65, 433]],
        [[ 66, 432]],
        [[ 66, 431]],
        [[ 68, 429]],
        [[ 68, 428]],
        [[ 69, 427]],
        [[ 69, 426]],
        [[ 70, 425]],
        [[ 70, 424]],
        [[ 71, 423]],
        [[ 71, 421]],
        [[ 72, 420]],
        [[ 72, 419]],
        [[ 73, 418]],
        [[ 73, 415]],
        [[ 75, 413]],
        [[ 75, 411]],
        [[ 76, 410]],
        [[ 76, 409]],
        [[ 78, 407]],
        [[ 78, 406]],
        [[ 79, 405]],
        [[ 79, 404]],
        [[ 81, 402]],
        [[ 81, 401]],
        [[ 83, 399]],
        [[ 83, 398]],
        [[ 95, 386]],
        [[ 96, 386]],
        [[ 99, 383]],
        [[100, 383]],
        [[102, 381]],
        [[103, 381]],
        [[104, 380]],
        [[105, 380]],
        [[107, 378]],
        [[108, 378]],
        [[109, 377]],
        [[110, 377]],
        [[112, 375]],
        [[112, 371]],
        [[114, 369]],
        [[114, 368]],
        [[115, 367]],
        [[116, 367]],
        [[117, 366]],
        [[117, 361]],
        [[116, 360]],
        [[116, 359]],
        [[115, 358]],
        [[113, 358]],
        [[112, 357]],
        [[109, 357]],
        [[108, 356]],
        [[105, 356]],
        [[104, 355]],
        [[100, 355]],
        [[ 99, 354]],
        [[ 98, 354]],
        [[ 96, 352]],
        [[ 96, 351]],
        [[ 95, 350]],
        [[ 95, 343]],
        [[ 94, 342]]],
        dtype=np.int32
      ),
      np.array(
        [[[200, 351]],
        [[199, 352]],
        [[197, 352]],
        [[196, 353]],
        [[194, 353]],
        [[193, 354]],
        [[191, 354]],
        [[190, 355]],
        [[187, 355]],
        [[186, 356]],
        [[182, 356]],
        [[181, 357]],
        [[177, 357]],
        [[176, 358]],
        [[155, 358]],
        [[154, 359]],
        [[151, 359]],
        [[150, 358]],
        [[149, 359]],
        [[138, 359]],
        [[137, 358]],
        [[132, 358]],
        [[131, 359]],
        [[129, 359]],
        [[127, 361]],
        [[127, 364]],
        [[126, 365]],
        [[126, 366]],
        [[129, 369]],
        [[128, 370]],
        [[126, 370]],
        [[125, 371]],
        [[125, 374]],
        [[124, 375]],
        [[124, 377]],
        [[122, 379]],
        [[122, 380]],
        [[123, 381]],
        [[123, 383]],
        [[124, 384]],
        [[124, 400]],
        [[123, 401]],
        [[123, 407]],
        [[122, 408]],
        [[122, 411]],
        [[121, 412]],
        [[121, 415]],
        [[120, 416]],
        [[120, 418]],
        [[119, 419]],
        [[119, 422]],
        [[117, 424]],
        [[117, 428]],
        [[116, 429]],
        [[116, 430]],
        [[114, 432]],
        [[114, 434]],
        [[113, 435]],
        [[113, 436]],
        [[112, 437]],
        [[112, 439]],
        [[111, 440]],
        [[111, 444]],
        [[130, 444]],
        [[131, 443]],
        [[151, 443]],
        [[152, 442]],
        [[153, 442]],
        [[155, 440]],
        [[155, 439]],
        [[156, 438]],
        [[156, 437]],
        [[158, 435]],
        [[158, 434]],
        [[159, 433]],
        [[159, 432]],
        [[161, 430]],
        [[161, 429]],
        [[162, 428]],
        [[162, 427]],
        [[163, 426]],
        [[163, 425]],
        [[165, 423]],
        [[165, 422]],
        [[166, 421]],
        [[166, 420]],
        [[168, 418]],
        [[168, 417]],
        [[170, 415]],
        [[170, 414]],
        [[173, 411]],
        [[173, 410]],
        [[176, 407]],
        [[176, 406]],
        [[188, 394]],
        [[188, 393]],
        [[192, 389]],
        [[192, 388]],
        [[194, 386]],
        [[194, 384]],
        [[195, 383]],
        [[195, 379]],
        [[196, 378]],
        [[197, 378]],
        [[198, 377]],
        [[199, 377]],
        [[203, 373]],
        [[203, 372]],
        [[205, 370]],
        [[205, 369]],
        [[206, 368]],
        [[206, 367]],
        [[208, 365]],
        [[208, 364]],
        [[209, 363]],
        [[209, 361]],
        [[210, 360]],
        [[210, 358]],
        [[211, 357]],
        [[211, 356]],
        [[210, 355]],
        [[210, 353]],
        [[209, 352]],
        [[208, 352]],
        [[207, 351]]],
        dtype=np.int32
      )
    ]

  expected_contours = np.empty(21, dtype=object)
  expected_contours[0] = ExpectedContourDistalPhalanx(1)
  expected_contours[1] = ExpectedContourMedialPhalanx(1)
  expected_contours[2] = ExpectedContourProximalPhalanx(1)
  expected_contours[3] = ExpectedContourMetacarpal(
    1,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[0]
  )
  expected_contours[4] = ExpectedContourDistalPhalanx(
    2,
    first_encounter=expected_contours[0]
  )
  expected_contours[5] = ExpectedContourMedialPhalanx(
    2,
    first_encounter=expected_contours[1]
  )
  expected_contours[6] = ExpectedContourProximalPhalanx(
    2,
    first_encounter=expected_contours[2]
  )
  expected_contours[7] = ExpectedContourMetacarpal(
    2,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[4],
    first_encounter=expected_contours[3]
  )
  expected_contours[8] = ExpectedContourDistalPhalanx(
    3,
    first_encounter=expected_contours[0]
  )
  expected_contours[9] = ExpectedContourMedialPhalanx(
    3,
    first_encounter=expected_contours[1]
  )
  expected_contours[10] = ExpectedContourProximalPhalanx(
    3,
    first_encounter=expected_contours[2]
  )
  expected_contours[11] = ExpectedContourMetacarpal(
    3,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[8],
    first_encounter=expected_contours[3]
  )
  expected_contours[12] = ExpectedContourDistalPhalanx(
    4,
    first_encounter=expected_contours[0]
  )
  expected_contours[13] = ExpectedContourMedialPhalanx(
    4,
    first_encounter=expected_contours[1]
  )
  expected_contours[14] = ExpectedContourProximalPhalanx(
    4,
    first_encounter=expected_contours[2]
  )
  expected_contours[15] = ExpectedContourMetacarpal(
    4,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[12],
    first_encounter=expected_contours[3]
  )
  expected_contours[16] = ExpectedContourDistalPhalanx(
    5,
    first_encounter=expected_contours[0]
  )
  expected_contours[17] = ExpectedContourProximalPhalanx(
    5,
    first_encounter=expected_contours[2]
  )
  expected_contours[18] = ExpectedContourMetacarpal(
    5,
    first_encounter=expected_contours[3]
  )
  expected_contours[19] = ExpectedContourUlna()
  expected_contours[20] = ExpectedContourRadius()

  contour_map = [
    12,
    9,
    7,
    1,
    16,
    13,
    8,
    3,
    18,
    15,
    11,
    4,
    17,
    14,
    10,
    5,
    6,
    2,
    0,
    19,
    20,
  ]

  contour_map_mask = [
    12,
    9,
    7,
    1,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. First finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    16,
    13,
    8,
    3,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Second finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    18,
    15,
    11,
    4,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Third finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    17,
    14,
    10,
    5,
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Fourth finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contour_map_mask = [
    6,
    2,
    0,
    19,
    20
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='Full hand. Fifth finger.',
    minimize_image=False,
    contour_map_mask=contour_map_mask
  )

  contours = [
    np.array(
      [[[317, 252]],
      [[316, 253]],
      [[314, 253]],
      [[313, 254]],
      [[309, 254]],
      [[309, 255]],
      [[306, 258]],
      [[305, 258]],
      [[303, 260]],
      [[303, 261]],
      [[301, 263]],
      [[299, 263]],
      [[298, 264]],
      [[298, 265]],
      [[292, 271]],
      [[291, 271]],
      [[287, 275]],
      [[286, 275]],
      [[284, 277]],
      [[283, 277]],
      [[280, 280]],
      [[279, 280]],
      [[277, 282]],
      [[276, 282]],
      [[275, 283]],
      [[274, 283]],
      [[273, 284]],
      [[272, 284]],
      [[271, 285]],
      [[270, 285]],
      [[268, 287]],
      [[266, 287]],
      [[265, 288]],
      [[264, 288]],
      [[263, 289]],
      [[261, 289]],
      [[260, 290]],
      [[257, 290]],
      [[256, 291]],
      [[253, 291]],
      [[252, 292]],
      [[247, 292]],
      [[246, 293]],
      [[243, 293]],
      [[242, 294]],
      [[240, 294]],
      [[239, 295]],
      [[236, 295]],
      [[235, 296]],
      [[233, 296]],
      [[230, 299]],
      [[230, 303]],
      [[232, 305]],
      [[232, 306]],
      [[235, 309]],
      [[236, 309]],
      [[237, 310]],
      [[237, 311]],
      [[238, 312]],
      [[238, 315]],
      [[239, 316]],
      [[240, 316]],
      [[242, 318]],
      [[243, 318]],
      [[244, 319]],
      [[250, 319]],
      [[251, 320]],
      [[253, 320]],
      [[254, 319]],
      [[256, 319]],
      [[257, 318]],
      [[258, 318]],
      [[259, 317]],
      [[260, 317]],
      [[261, 316]],
      [[263, 316]],
      [[265, 314]],
      [[266, 314]],
      [[267, 313]],
      [[268, 313]],
      [[271, 310]],
      [[272, 310]],
      [[277, 305]],
      [[278, 305]],
      [[280, 303]],
      [[281, 303]],
      [[283, 301]],
      [[284, 301]],
      [[286, 299]],
      [[287, 299]],
      [[289, 297]],
      [[290, 297]],
      [[292, 295]],
      [[293, 295]],
      [[294, 294]],
      [[295, 294]],
      [[296, 293]],
      [[297, 293]],
      [[299, 291]],
      [[300, 291]],
      [[301, 290]],
      [[302, 290]],
      [[304, 288]],
      [[305, 288]],
      [[306, 287]],
      [[307, 287]],
      [[308, 286]],
      [[309, 286]],
      [[311, 284]],
      [[312, 284]],
      [[314, 282]],
      [[315, 282]],
      [[316, 281]],
      [[317, 281]],
      [[318, 280]],
      [[319, 280]],
      [[321, 278]],
      [[323, 278]],
      [[324, 277]],
      [[325, 277]],
      [[326, 276]],
      [[327, 276]],
      [[328, 275]],
      [[329, 275]],
      [[331, 273]],
      [[332, 273]],
      [[332, 272]],
      [[334, 270]],
      [[334, 269]],
      [[335, 268]],
      [[335, 264]],
      [[334, 263]],
      [[334, 262]],
      [[332, 260]],
      [[331, 260]],
      [[328, 257]],
      [[327, 257]],
      [[326, 256]],
      [[325, 256]],
      [[324, 255]],
      [[323, 255]],
      [[321, 253]],
      [[320, 253]],
      [[319, 252]]],
      dtype=np.int32
    ),
    np.array(
      [[[294, 250]],
      [[293, 251]],
      [[293, 255]],
      [[294, 256]],
      [[299, 256]],
      [[300, 255]],
      [[301, 255]],
      [[302, 256]],
      [[304, 256]],
      [[305, 255]],
      [[305, 252]],
      [[304, 251]],
      [[303, 251]],
      [[302, 250]]],
      dtype=np.int32
    )
  ]
  expected_contours = [
    ExpectedContourSesamoidMetacarpal(),
    ExpectedContourSesamoid()
  ]
  show_contours_position_restrictions(
    expected_contours,
    contour_map=[0, 1],
    contours=contours,
    padding=5,
    title='Fifth metacarpal and sesamoid.',
    minimize_image=False,
    show_position_restrictions=True
  )

def radiography_004_case():
  contours = [
    np.array([ # ulna (0) 
      [[125, 417]],
      [[123, 419]],
      [[123, 421]],
      [[122, 422]],
      [[122, 426]],
      [[121, 427]],
      [[121, 428]],
      [[122, 429]],
      [[121, 430]],
      [[122, 431]],
      [[122, 432]],
      [[123, 433]],
      [[123, 443]],
      [[124, 444]],
      [[124, 467]],
      [[142, 467]],
      [[142, 466]],
      [[143, 465]],
      [[143, 461]],
      [[144, 460]],
      [[144, 457]],
      [[145, 456]],
      [[145, 455]],
      [[146, 454]],
      [[146, 452]],
      [[147, 451]],
      [[147, 449]],
      [[148, 448]],
      [[148, 447]],
      [[149, 446]],
      [[149, 445]],
      [[150, 444]],
      [[150, 442]],
      [[151, 441]],
      [[151, 433]],
      [[152, 432]],
      [[152, 431]],
      [[151, 430]],
      [[151, 427]],
      [[148, 424]],
      [[147, 424]],
      [[146, 423]],
      [[144, 423]],
      [[143, 422]],
      [[142, 423]],
      [[139, 423]],
      [[138, 424]],
      [[137, 424]],
      [[136, 425]],
      [[134, 425]],
      [[131, 422]],
      [[131, 421]],
      [[130, 421]],
      [[129, 420]],
      [[129, 419]],
      [[127, 417]]],
      dtype=np.int32
    ),
    np.array([ # radio (1) 
      [[203, 404]],
      [[202, 405]],
      [[199, 405]],
      [[197, 407]],
      [[196, 407]],
      [[194, 409]],
      [[193, 409]],
      [[192, 410]],
      [[191, 410]],
      [[190, 411]],
      [[188, 411]],
      [[190, 411]],
      [[191, 410]],
      [[193, 410]],
      [[194, 409]],
      [[195, 409]],
      [[197, 407]],
      [[198, 407]],
      [[200, 405]],
      [[202, 405]],
      [[203, 404]],
      [[208, 409]],
      [[208, 421]],
      [[207, 422]],
      [[207, 428]],
      [[206, 429]],
      [[206, 432]],
      [[205, 433]],
      [[204, 433]],
      [[204, 434]],
      [[203, 435]],
      [[204, 436]],
      [[204, 439]],
      [[203, 440]],
      [[203, 443]],
      [[202, 444]],
      [[202, 447]],
      [[201, 448]],
      [[201, 450]],
      [[200, 451]],
      [[200, 454]],
      [[199, 455]],
      [[199, 457]],
      [[198, 458]],
      [[198, 461]],
      [[197, 462]],
      [[197, 464]],
      [[196, 465]],
      [[196, 466]],
      [[195, 467]],
      [[163, 467]],
      [[162, 466]],
      [[162, 460]],
      [[161, 459]],
      [[161, 454]],
      [[160, 453]],
      [[160, 450]],
      [[159, 449]],
      [[159, 447]],
      [[158, 446]],
      [[158, 445]],
      [[157, 444]],
      [[157, 442]],
      [[156, 441]],
      [[156, 439]],
      [[154, 437]],
      [[154, 432]],
      [[155, 431]],
      [[155, 423]],
      [[156, 422]],
      [[156, 421]],
      [[158, 419]],
      [[159, 419]],
      [[160, 418]],
      [[161, 418]],
      [[162, 417]],
      [[165, 417]],
      [[166, 416]],
      [[169, 416]],
      [[170, 415]],
      [[177, 415]],
      [[178, 414]],
      [[184, 414]],
      [[185, 413]],
      [[187, 413]],
      [[185, 413]],
      [[184, 414]],
      [[178, 414]],
      [[177, 415]],
      [[170, 415]],
      [[169, 416]],
      [[166, 416]],
      [[165, 417]],
      [[162, 417]],
      [[161, 418]],
      [[160, 418]],
      [[159, 419]],
      [[158, 419]],
      [[156, 421]],
      [[156, 422]],
      [[155, 423]],
      [[155, 430]],
      [[154, 431]],
      [[154, 437]],
      [[155, 438]],
      [[155, 439]],
      [[156, 440]],
      [[156, 441]],
      [[157, 442]],
      [[157, 444]],
      [[158, 445]],
      [[158, 446]],
      [[159, 447]],
      [[159, 449]],
      [[160, 450]],
      [[160, 453]],
      [[161, 454]],
      [[161, 459]],
      [[162, 460]],
      [[162, 467]],
      [[196, 467]],
      [[196, 465]],
      [[197, 464]],
      [[197, 462]],
      [[198, 461]],
      [[198, 458]],
      [[199, 457]],
      [[199, 455]],
      [[200, 454]],
      [[200, 451]],
      [[201, 450]],
      [[201, 448]],
      [[202, 447]],
      [[202, 444]],
      [[203, 443]],
      [[203, 440]],
      [[204, 439]],
      [[204, 436]],
      [[203, 435]],
      [[206, 432]],
      [[206, 429]],
      [[207, 428]],
      [[207, 422]],
      [[208, 421]],
      [[208, 409]],
      [[207, 408]],
      [[207, 407]],
      [[204, 404]]],
      dtype=np.int32
    ),
    np.array([ # metacarpal 5 (2) 
      [[269, 308]],
      [[268, 309]],
      [[267, 309]],
      [[266, 310]],
      [[265, 310]],
      [[263, 312]],
      [[262, 312]],
      [[260, 314]],
      [[260, 317]],
      [[261, 318]],
      [[261, 321]],
      [[260, 322]],
      [[260, 324]],
      [[259, 325]],
      [[259, 326]],
      [[258, 327]],
      [[258, 328]],
      [[257, 329]],
      [[257, 330]],
      [[256, 331]],
      [[256, 332]],
      [[254, 334]],
      [[254, 335]],
      [[251, 338]],
      [[251, 339]],
      [[248, 342]],
      [[248, 343]],
      [[237, 354]],
      [[236, 354]],
      [[234, 356]],
      [[233, 356]],
      [[231, 358]],
      [[230, 358]],
      [[229, 359]],
      [[228, 359]],
      [[227, 360]],
      [[226, 360]],
      [[225, 361]],
      [[223, 361]],
      [[222, 362]],
      [[220, 362]],
      [[218, 364]],
      [[218, 369]],
      [[219, 370]],
      [[219, 372]],
      [[222, 375]],
      [[222, 376]],
      [[223, 377]],
      [[223, 378]],
      [[224, 379]],
      [[224, 380]],
      [[226, 382]],
      [[227, 382]],
      [[228, 383]],
      [[239, 383]],
      [[242, 380]],
      [[242, 379]],
      [[243, 378]],
      [[243, 377]],
      [[245, 375]],
      [[245, 374]],
      [[247, 372]],
      [[247, 371]],
      [[248, 370]],
      [[248, 369]],
      [[249, 368]],
      [[249, 367]],
      [[251, 365]],
      [[251, 364]],
      [[253, 362]],
      [[253, 361]],
      [[258, 356]],
      [[258, 355]],
      [[262, 351]],
      [[262, 350]],
      [[266, 346]],
      [[266, 345]],
      [[271, 340]],
      [[271, 339]],
      [[285, 325]],
      [[285, 323]],
      [[286, 322]],
      [[286, 319]],
      [[284, 317]],
      [[282, 317]],
      [[280, 315]],
      [[280, 314]],
      [[276, 310]],
      [[275, 310]],
      [[274, 309]],
      [[272, 309]],
      [[271, 308]]],
      dtype=np.int32
    ),
    np.array([ # proximal 5 (3) 
      [[306, 259]],
      [[304, 261]],
      [[303, 261]],
      [[303, 262]],
      [[302, 263]],
      [[302, 270]],
      [[301, 271]],
      [[301, 272]],
      [[300, 273]],
      [[300, 274]],
      [[299, 275]],
      [[299, 276]],
      [[296, 279]],
      [[296, 280]],
      [[292, 284]],
      [[291, 284]],
      [[287, 288]],
      [[286, 288]],
      [[284, 290]],
      [[283, 290]],
      [[281, 292]],
      [[280, 292]],
      [[276, 296]],
      [[275, 295]],
      [[272, 295]],
      [[270, 297]],
      [[270, 303]],
      [[271, 304]],
      [[272, 304]],
      [[273, 305]],
      [[274, 305]],
      [[279, 310]],
      [[280, 310]],
      [[282, 312]],
      [[283, 312]],
      [[286, 315]],
      [[287, 315]],
      [[290, 312]],
      [[290, 310]],
      [[292, 308]],
      [[292, 307]],
      [[293, 306]],
      [[293, 305]],
      [[294, 304]],
      [[294, 303]],
      [[295, 302]],
      [[295, 301]],
      [[297, 299]],
      [[297, 298]],
      [[299, 296]],
      [[299, 295]],
      [[301, 293]],
      [[301, 292]],
      [[304, 289]],
      [[304, 288]],
      [[314, 278]],
      [[314, 277]],
      [[315, 276]],
      [[316, 276]],
      [[319, 273]],
      [[319, 268]],
      [[318, 267]],
      [[318, 266]],
      [[316, 264]],
      [[313, 264]],
      [[312, 263]],
      [[312, 262]],
      [[311, 261]],
      [[310, 261]],
      [[308, 259]]],
      dtype=np.int32
    ),
    np.array([ # metacarpal 1 (4) 
      [[108, 257]],
      [[107, 258]],
      [[105, 258]],
      [[104, 259]],
      [[103, 259]],
      [[102, 260]],
      [[102, 261]],
      [[101, 262]],
      [[101, 270]],
      [[102, 271]],
      [[102, 274]],
      [[103, 275]],
      [[103, 276]],
      [[104, 277]],
      [[104, 278]],
      [[105, 279]],
      [[105, 280]],
      [[106, 281]],
      [[106, 283]],
      [[107, 284]],
      [[107, 285]],
      [[108, 286]],
      [[108, 287]],
      [[109, 288]],
      [[109, 289]],
      [[110, 290]],
      [[110, 292]],
      [[111, 293]],
      [[111, 294]],
      [[112, 295]],
      [[112, 297]],
      [[113, 298]],
      [[113, 299]],
      [[114, 300]],
      [[114, 302]],
      [[115, 303]],
      [[115, 305]],
      [[116, 306]],
      [[116, 308]],
      [[117, 309]],
      [[117, 311]],
      [[118, 312]],
      [[118, 314]],
      [[119, 315]],
      [[119, 318]],
      [[120, 319]],
      [[120, 322]],
      [[121, 323]],
      [[121, 330]],
      [[122, 331]],
      [[122, 337]],
      [[123, 338]],
      [[123, 342]],
      [[124, 343]],
      [[124, 345]],
      [[125, 346]],
      [[125, 348]],
      [[126, 349]],
      [[126, 350]],
      [[127, 351]],
      [[127, 353]],
      [[128, 354]],
      [[128, 355]],
      [[129, 356]],
      [[129, 357]],
      [[130, 358]],
      [[131, 358]],
      [[132, 359]],
      [[133, 358]],
      [[134, 358]],
      [[137, 355]],
      [[138, 355]],
      [[141, 352]],
      [[142, 352]],
      [[145, 349]],
      [[146, 349]],
      [[148, 347]],
      [[148, 346]],
      [[146, 344]],
      [[146, 343]],
      [[145, 342]],
      [[145, 341]],
      [[141, 337]],
      [[141, 336]],
      [[140, 335]],
      [[140, 334]],
      [[138, 332]],
      [[138, 331]],
      [[137, 330]],
      [[137, 329]],
      [[135, 327]],
      [[135, 325]],
      [[134, 324]],
      [[134, 322]],
      [[133, 321]],
      [[133, 320]],
      [[132, 319]],
      [[132, 318]],
      [[131, 317]],
      [[131, 315]],
      [[130, 314]],
      [[130, 313]],
      [[129, 312]],
      [[129, 309]],
      [[128, 308]],
      [[128, 306]],
      [[127, 305]],
      [[127, 303]],
      [[126, 302]],
      [[126, 300]],
      [[125, 299]],
      [[125, 297]],
      [[124, 296]],
      [[124, 294]],
      [[123, 293]],
      [[123, 291]],
      [[122, 290]],
      [[122, 287]],
      [[121, 286]],
      [[121, 283]],
      [[120, 282]],
      [[120, 278]],
      [[119, 277]],
      [[119, 274]],
      [[120, 273]],
      [[120, 272]],
      [[121, 271]],
      [[121, 265]],
      [[120, 264]],
      [[120, 262]],
      [[119, 261]],
      [[119, 260]],
      [[117, 258]],
      [[115, 258]],
      [[114, 257]]],
      dtype=np.int32
    ),
    np.array([ # metacarpal 2 (5) 
      [[138, 242]],
      [[137, 243]],
      [[135, 243]],
      [[133, 245]],
      [[132, 245]],
      [[131, 246]],
      [[131, 252]],
      [[132, 253]],
      [[132, 257]],
      [[133, 258]],
      [[133, 259]],
      [[134, 260]],
      [[134, 265]],
      [[135, 266]],
      [[135, 269]],
      [[136, 270]],
      [[136, 275]],
      [[137, 276]],
      [[137, 279]],
      [[138, 280]],
      [[138, 283]],
      [[139, 284]],
      [[139, 287]],
      [[140, 288]],
      [[140, 291]],
      [[141, 292]],
      [[141, 295]],
      [[142, 296]],
      [[142, 299]],
      [[143, 300]],
      [[143, 304]],
      [[144, 305]],
      [[144, 309]],
      [[145, 310]],
      [[145, 315]],
      [[146, 316]],
      [[146, 331]],
      [[145, 332]],
      [[145, 334]],
      [[144, 335]],
      [[144, 337]],
      [[145, 338]],
      [[147, 338]],
      [[148, 339]],
      [[153, 339]],
      [[154, 340]],
      [[160, 340]],
      [[161, 341]],
      [[164, 341]],
      [[164, 334]],
      [[163, 333]],
      [[163, 329]],
      [[162, 328]],
      [[162, 327]],
      [[161, 326]],
      [[161, 325]],
      [[160, 324]],
      [[160, 323]],
      [[159, 322]],
      [[159, 321]],
      [[158, 320]],
      [[158, 318]],
      [[157, 317]],
      [[157, 314]],
      [[156, 313]],
      [[156, 310]],
      [[155, 309]],
      [[155, 304]],
      [[154, 303]],
      [[154, 297]],
      [[153, 296]],
      [[153, 289]],
      [[152, 288]],
      [[152, 281]],
      [[151, 280]],
      [[151, 272]],
      [[150, 271]],
      [[150, 265]],
      [[151, 264]],
      [[151, 255]],
      [[152, 254]],
      [[152, 248]],
      [[148, 244]],
      [[147, 244]],
      [[146, 243]],
      [[143, 243]],
      [[142, 242]]],
      dtype=np.int32
    ),
    np.array([ # metacarpal 4 (6) 
      [[213, 232]],
      [[212, 233]],
      [[209, 233]],
      [[207, 235]],
      [[207, 237]],
      [[206, 238]],
      [[206, 239]],
      [[205, 240]],
      [[205, 242]],
      [[203, 244]],
      [[203, 246]],
      [[202, 247]],
      [[202, 248]],
      [[203, 249]],
      [[203, 262]],
      [[202, 263]],
      [[202, 274]],
      [[201, 275]],
      [[201, 288]],
      [[200, 289]],
      [[200, 304]],
      [[199, 305]],
      [[199, 317]],
      [[198, 318]],
      [[198, 323]],
      [[197, 324]],
      [[197, 328]],
      [[196, 329]],
      [[196, 331]],
      [[195, 332]],
      [[195, 334]],
      [[194, 335]],
      [[194, 337]],
      [[193, 338]],
      [[193, 339]],
      [[192, 340]],
      [[192, 341]],
      [[191, 342]],
      [[191, 344]],
      [[190, 345]],
      [[190, 347]],
      [[189, 348]],
      [[189, 350]],
      [[190, 350]],
      [[191, 351]],
      [[192, 351]],
      [[193, 352]],
      [[194, 352]],
      [[195, 353]],
      [[197, 353]],
      [[198, 354]],
      [[199, 354]],
      [[200, 355]],
      [[201, 355]],
      [[202, 356]],
      [[204, 356]],
      [[205, 357]],
      [[206, 357]],
      [[207, 358]],
      [[209, 358]],
      [[210, 359]],
      [[211, 359]],
      [[212, 360]],
      [[213, 360]],
      [[214, 361]],
      [[215, 361]],
      [[215, 360]],
      [[214, 359]],
      [[214, 358]],
      [[215, 357]],
      [[215, 353]],
      [[214, 352]],
      [[215, 351]],
      [[215, 348]],
      [[214, 347]],
      [[214, 343]],
      [[213, 342]],
      [[213, 339]],
      [[212, 338]],
      [[212, 314]],
      [[213, 313]],
      [[213, 306]],
      [[214, 305]],
      [[214, 298]],
      [[215, 297]],
      [[215, 293]],
      [[216, 292]],
      [[216, 288]],
      [[217, 287]],
      [[217, 284]],
      [[218, 283]],
      [[218, 280]],
      [[219, 279]],
      [[219, 277]],
      [[220, 276]],
      [[220, 273]],
      [[221, 272]],
      [[221, 270]],
      [[222, 269]],
      [[222, 265]],
      [[223, 264]],
      [[223, 262]],
      [[224, 261]],
      [[224, 260]],
      [[227, 257]],
      [[228, 257]],
      [[229, 256]],
      [[229, 254]],
      [[230, 253]],
      [[230, 248]],
      [[229, 247]],
      [[229, 244]],
      [[228, 243]],
      [[228, 241]],
      [[226, 241]],
      [[225, 240]],
      [[225, 239]],
      [[224, 238]],
      [[224, 236]],
      [[223, 235]],
      [[222, 235]],
      [[221, 234]],
      [[220, 234]],
      [[219, 233]],
      [[216, 233]],
      [[215, 232]]],
      dtype=np.int32
    ),
    np.array([ # metacarpal 3 (7) 
      [[173, 229]],
      [[172, 230]],
      [[168, 230]],
      [[167, 231]],
      [[166, 231]],
      [[164, 233]],
      [[164, 245]],
      [[163, 246]],
      [[163, 253]],
      [[164, 254]],
      [[164, 260]],
      [[165, 261]],
      [[165, 275]],
      [[166, 276]],
      [[166, 284]],
      [[167, 285]],
      [[167, 291]],
      [[168, 292]],
      [[168, 299]],
      [[169, 300]],
      [[169, 315]],
      [[170, 316]],
      [[170, 319]],
      [[169, 320]],
      [[169, 328]],
      [[168, 329]],
      [[168, 333]],
      [[170, 335]],
      [[171, 335]],
      [[174, 338]],
      [[175, 338]],
      [[179, 342]],
      [[180, 342]],
      [[183, 345]],
      [[184, 345]],
      [[186, 347]],
      [[186, 341]],
      [[187, 340]],
      [[187, 331]],
      [[186, 330]],
      [[186, 325]],
      [[185, 324]],
      [[185, 320]],
      [[184, 319]],
      [[184, 315]],
      [[183, 314]],
      [[183, 304]],
      [[182, 303]],
      [[182, 279]],
      [[183, 278]],
      [[183, 266]],
      [[184, 265]],
      [[184, 260]],
      [[185, 259]],
      [[185, 256]],
      [[186, 255]],
      [[186, 254]],
      [[187, 253]],
      [[187, 252]],
      [[189, 250]],
      [[190, 250]],
      [[190, 243]],
      [[189, 242]],
      [[189, 240]],
      [[188, 239]],
      [[188, 237]],
      [[183, 232]],
      [[182, 232]],
      [[181, 231]],
      [[179, 231]],
      [[178, 230]],
      [[174, 230]]],
      dtype=np.int32
    ),
    np.array([ # distal 5 (8)
      [[336, 220]],
      [[335, 221]],
      [[334, 221]],
      [[333, 222]],
      [[332, 222]],
      [[330, 224]],
      [[330, 225]],
      [[329, 226]],
      [[329, 227]],
      [[328, 228]],
      [[328, 229]],
      [[327, 230]],
      [[327, 231]],
      [[324, 234]],
      [[324, 235]],
      [[322, 237]],
      [[322, 238]],
      [[319, 241]],
      [[319, 242]],
      [[317, 244]],
      [[317, 245]],
      [[315, 247]],
      [[314, 247]],
      [[313, 248]],
      [[312, 248]],
      [[310, 250]],
      [[309, 250]],
      [[309, 251]],
      [[308, 252]],
      [[308, 255]],
      [[309, 256]],
      [[309, 257]],
      [[311, 259]],
      [[312, 259]],
      [[315, 262]],
      [[318, 262]],
      [[319, 263]],
      [[323, 263]],
      [[323, 258]],
      [[324, 257]],
      [[324, 253]],
      [[325, 252]],
      [[325, 250]],
      [[326, 249]],
      [[326, 247]],
      [[328, 245]],
      [[328, 244]],
      [[329, 243]],
      [[329, 241]],
      [[331, 239]],
      [[331, 238]],
      [[332, 237]],
      [[332, 236]],
      [[333, 235]],
      [[333, 234]],
      [[335, 232]],
      [[335, 231]],
      [[337, 229]],
      [[337, 228]],
      [[341, 224]],
      [[341, 221]],
      [[340, 220]]],
      dtype=np.int32
    ),
    np.array([ # proximal 1 (9)
      [[100, 191]],
      [[ 99, 192]],
      [[ 98, 192]],
      [[ 97, 193]],
      [[ 95, 193]],
      [[ 94, 194]],
      [[ 91, 194]],
      [[ 91, 195]],
      [[ 90, 196]],
      [[ 90, 199]],
      [[ 91, 200]],
      [[ 91, 202]],
      [[ 92, 203]],
      [[ 92, 205]],
      [[ 93, 206]],
      [[ 93, 207]],
      [[ 94, 208]],
      [[ 94, 210]],
      [[ 95, 211]],
      [[ 95, 216]],
      [[ 96, 217]],
      [[ 96, 223]],
      [[ 97, 224]],
      [[ 97, 233]],
      [[ 98, 234]],
      [[ 98, 241]],
      [[ 97, 242]],
      [[ 97, 247]],
      [[ 96, 248]],
      [[ 96, 251]],
      [[ 95, 252]],
      [[ 95, 254]],
      [[ 96, 255]],
      [[ 96, 256]],
      [[ 97, 257]],
      [[102, 257]],
      [[103, 256]],
      [[104, 256]],
      [[105, 255]],
      [[108, 255]],
      [[109, 254]],
      [[118, 254]],
      [[119, 253]],
      [[119, 248]],
      [[118, 247]],
      [[118, 246]],
      [[117, 245]],
      [[117, 244]],
      [[115, 242]],
      [[115, 241]],
      [[114, 240]],
      [[114, 239]],
      [[112, 237]],
      [[112, 236]],
      [[111, 235]],
      [[111, 233]],
      [[110, 232]],
      [[110, 230]],
      [[109, 229]],
      [[109, 227]],
      [[108, 226]],
      [[108, 223]],
      [[107, 222]],
      [[107, 219]],
      [[106, 218]],
      [[106, 214]],
      [[105, 213]],
      [[105, 207]],
      [[104, 206]],
      [[104, 203]],
      [[105, 202]],
      [[105, 197]],
      [[104, 196]],
      [[104, 193]],
      [[102, 191]]],
      dtype=np.int32
    ),
    np.array([ # proximal 2 (10)
      [[138, 158]],
      [[137, 159]],
      [[128, 159]],
      [[127, 160]],
      [[127, 171]],
      [[128, 172]],
      [[128, 173]],
      [[129, 174]],
      [[129, 177]],
      [[130, 178]],
      [[130, 198]],
      [[131, 199]],
      [[131, 211]],
      [[132, 212]],
      [[132, 218]],
      [[131, 219]],
      [[131, 225]],
      [[130, 226]],
      [[130, 229]],
      [[129, 230]],
      [[129, 232]],
      [[128, 233]],
      [[128, 235]],
      [[127, 236]],
      [[127, 237]],
      [[128, 238]],
      [[128, 239]],
      [[129, 240]],
      [[129, 241]],
      [[133, 241]],
      [[134, 240]],
      [[137, 240]],
      [[138, 239]],
      [[143, 239]],
      [[144, 240]],
      [[150, 240]],
      [[151, 239]],
      [[151, 238]],
      [[152, 237]],
      [[152, 232]],
      [[151, 231]],
      [[151, 230]],
      [[150, 229]],
      [[150, 227]],
      [[149, 226]],
      [[149, 224]],
      [[148, 223]],
      [[148, 222]],
      [[147, 221]],
      [[147, 218]],
      [[146, 217]],
      [[146, 213]],
      [[145, 212]],
      [[145, 203]],
      [[144, 202]],
      [[144, 190]],
      [[143, 189]],
      [[143, 170]],
      [[144, 169]],
      [[144, 168]],
      [[143, 167]],
      [[144, 166]],
      [[143, 165]],
      [[143, 160]],
      [[141, 158]]],
      dtype=np.int32
    ),
    np.array([ # medial 1 (11)
      [[ 93, 155]],
      [[ 92, 156]],
      [[ 89, 156]],
      [[ 88, 157]],
      [[ 82, 157]],
      [[ 82, 163]],
      [[ 83, 164]],
      [[ 83, 165]],
      [[ 85, 167]],
      [[ 85, 168]],
      [[ 86, 169]],
      [[ 86, 176]],
      [[ 87, 177]],
      [[ 87, 192]],
      [[ 93, 192]],
      [[ 94, 191]],
      [[ 96, 191]],
      [[ 97, 190]],
      [[ 98, 190]],
      [[ 99, 189]],
      [[102, 189]],
      [[103, 188]],
      [[103, 185]],
      [[101, 183]],
      [[101, 182]],
      [[ 99, 180]],
      [[ 99, 179]],
      [[ 97, 177]],
      [[ 97, 176]],
      [[ 96, 175]],
      [[ 96, 172]],
      [[ 95, 171]],
      [[ 95, 156]],
      [[ 94, 155]]],
      dtype=np.int32
    ),
    np.array([ # proximal 4 (12) 
      [[208, 149]],
      [[207, 150]],
      [[198, 150]],
      [[197, 151]],
      [[197, 162]],
      [[198, 163]],
      [[198, 165]],
      [[199, 166]],
      [[199, 171]],
      [[200, 172]],
      [[200, 184]],
      [[201, 185]],
      [[201, 192]],
      [[202, 193]],
      [[202, 205]],
      [[203, 206]],
      [[203, 213]],
      [[202, 214]],
      [[202, 220]],
      [[201, 221]],
      [[201, 224]],
      [[200, 225]],
      [[201, 226]],
      [[200, 227]],
      [[201, 228]],
      [[201, 231]],
      [[202, 231]],
      [[203, 232]],
      [[204, 232]],
      [[205, 231]],
      [[207, 231]],
      [[208, 230]],
      [[209, 230]],
      [[210, 229]],
      [[219, 229]],
      [[220, 230]],
      [[223, 230]],
      [[224, 229]],
      [[226, 229]],
      [[227, 228]],
      [[228, 228]],
      [[228, 226]],
      [[229, 225]],
      [[229, 223]],
      [[228, 222]],
      [[228, 220]],
      [[225, 217]],
      [[225, 216]],
      [[224, 215]],
      [[224, 214]],
      [[223, 213]],
      [[223, 211]],
      [[221, 209]],
      [[221, 207]],
      [[220, 206]],
      [[220, 204]],
      [[219, 203]],
      [[219, 200]],
      [[218, 199]],
      [[218, 195]],
      [[217, 194]],
      [[217, 190]],
      [[216, 189]],
      [[216, 184]],
      [[215, 183]],
      [[215, 181]],
      [[214, 180]],
      [[214, 164]],
      [[215, 163]],
      [[215, 153]],
      [[213, 151]],
      [[213, 150]],
      [[210, 150]],
      [[209, 149]]],
      dtype=np.int32
    ),
    np.array([ # proximal 3 (13)
      [[173, 137]],
      [[172, 138]],
      [[170, 138]],
      [[168, 140]],
      [[165, 140]],
      [[164, 139]],
      [[159, 139]],
      [[159, 146]],
      [[158, 147]],
      [[158, 148]],
      [[159, 149]],
      [[159, 153]],
      [[160, 154]],
      [[160, 159]],
      [[161, 160]],
      [[161, 182]],
      [[162, 183]],
      [[162, 198]],
      [[163, 199]],
      [[163, 205]],
      [[162, 206]],
      [[162, 214]],
      [[161, 215]],
      [[161, 217]],
      [[160, 218]],
      [[160, 220]],
      [[159, 221]],
      [[159, 222]],
      [[160, 223]],
      [[159, 224]],
      [[159, 225]],
      [[160, 226]],
      [[160, 227]],
      [[161, 228]],
      [[166, 228]],
      [[167, 227]],
      [[171, 227]],
      [[172, 226]],
      [[174, 226]],
      [[175, 227]],
      [[185, 227]],
      [[187, 225]],
      [[187, 218]],
      [[185, 216]],
      [[185, 214]],
      [[184, 213]],
      [[184, 212]],
      [[182, 210]],
      [[182, 208]],
      [[181, 207]],
      [[181, 205]],
      [[180, 204]],
      [[180, 202]],
      [[179, 201]],
      [[179, 197]],
      [[178, 196]],
      [[178, 189]],
      [[177, 188]],
      [[177, 179]],
      [[176, 178]],
      [[176, 168]],
      [[175, 167]],
      [[175, 153]],
      [[177, 151]],
      [[177, 145]],
      [[176, 144]],
      [[176, 141]],
      [[175, 140]],
      [[175, 139]]],
      dtype=np.int32
    ),
    np.array([ # distal 1 (14)
      [[ 84, 122]],
      [[ 83, 123]],
      [[ 82, 123]],
      [[ 81, 124]],
      [[ 81, 130]],
      [[ 82, 131]],
      [[ 82, 136]],
      [[ 83, 137]],
      [[ 83, 146]],
      [[ 82, 147]],
      [[ 82, 148]],
      [[ 81, 149]],
      [[ 81, 154]],
      [[ 82, 155]],
      [[ 87, 155]],
      [[ 88, 154]],
      [[ 91, 154]],
      [[ 92, 153]],
      [[ 93, 153]],
      [[ 94, 152]],
      [[ 94, 151]],
      [[ 95, 150]],
      [[ 94, 149]],
      [[ 94, 148]],
      [[ 91, 145]],
      [[ 91, 143]],
      [[ 89, 141]],
      [[ 89, 138]],
      [[ 88, 137]],
      [[ 88, 130]],
      [[ 89, 129]],
      [[ 89, 126]],
      [[ 88, 125]],
      [[ 88, 124]],
      [[ 86, 122]]],
      dtype=np.int32
    ),
    np.array([ # medial 2 (15)
      [[127, 107]],
      [[126, 108]],
      [[125, 108]],
      [[125, 110]],
      [[124, 111]],
      [[124, 115]],
      [[125, 116]],
      [[125, 118]],
      [[126, 119]],
      [[126, 123]],
      [[127, 124]],
      [[127, 130]],
      [[126, 131]],
      [[126, 140]],
      [[125, 141]],
      [[125, 151]],
      [[124, 152]],
      [[124, 156]],
      [[125, 157]],
      [[127, 157]],
      [[128, 156]],
      [[132, 156]],
      [[133, 157]],
      [[134, 156]],
      [[138, 156]],
      [[139, 155]],
      [[143, 155]],
      [[143, 150]],
      [[142, 149]],
      [[142, 146]],
      [[141, 145]],
      [[141, 141]],
      [[140, 140]],
      [[140, 136]],
      [[139, 135]],
      [[139, 131]],
      [[138, 130]],
      [[138, 119]],
      [[139, 118]],
      [[139, 117]],
      [[140, 116]],
      [[140, 111]],
      [[139, 110]],
      [[139, 108]],
      [[138, 107]],
      [[133, 107]],
      [[132, 108]],
      [[129, 108]],
      [[128, 107]]],
      dtype=np.int32
    ),
    np.array([ # medial 4 (16)
      [[202, 103]],
      [[201, 104]],
      [[199, 104]],
      [[198, 105]],
      [[194, 105]],
      [[194, 107]],
      [[193, 108]],
      [[193, 110]],
      [[194, 111]],
      [[194, 114]],
      [[195, 115]],
      [[195, 117]],
      [[196, 118]],
      [[196, 140]],
      [[195, 141]],
      [[195, 148]],
      [[196, 148]],
      [[197, 147]],
      [[201, 147]],
      [[202, 148]],
      [[205, 148]],
      [[206, 147]],
      [[208, 147]],
      [[209, 146]],
      [[211, 146]],
      [[212, 147]],
      [[213, 147]],
      [[215, 145]],
      [[215, 142]],
      [[214, 141]],
      [[214, 140]],
      [[213, 139]],
      [[213, 138]],
      [[212, 137]],
      [[212, 133]],
      [[211, 132]],
      [[211, 131]],
      [[210, 130]],
      [[210, 128]],
      [[208, 126]],
      [[208, 122]],
      [[207, 121]],
      [[207, 113]],
      [[208, 112]],
      [[208, 105]],
      [[207, 104]],
      [[207, 103]]],
      dtype=np.int32
    ),
    np.array([ # medial 3 (17)
      [[163,  82]],
      [[162,  83]],
      [[157,  83]],
      [[156,  84]],
      [[156,  87]],
      [[155,  88]],
      [[155,  92]],
      [[156,  93]],
      [[156,  96]],
      [[157,  97]],
      [[157, 102]],
      [[158, 103]],
      [[158, 106]],
      [[157, 107]],
      [[157, 125]],
      [[156, 126]],
      [[156, 131]],
      [[155, 132]],
      [[155, 134]],
      [[156, 135]],
      [[156, 136]],
      [[168, 136]],
      [[169, 135]],
      [[176, 135]],
      [[177, 134]],
      [[177, 132]],
      [[178, 131]],
      [[177, 130]],
      [[177, 129]],
      [[175, 127]],
      [[175, 122]],
      [[174, 121]],
      [[174, 119]],
      [[173, 118]],
      [[173, 116]],
      [[172, 115]],
      [[172, 112]],
      [[171, 111]],
      [[171, 109]],
      [[170, 108]],
      [[170, 104]],
      [[169, 103]],
      [[169,  96]],
      [[170,  95]],
      [[170,  93]],
      [[171,  92]],
      [[171,  91]],
      [[172,  90]],
      [[172,  87]],
      [[171,  86]],
      [[171,  85]],
      [[170,  84]],
      [[170,  83]],
      [[169,  82]]],
      dtype=np.int32
    ),
    np.array([ # distal 4 (18)
      [[190,  70]],
      [[190,  71]],
      [[188,  73]],
      [[188,  77]],
      [[189,  78]],
      [[189,  80]],
      [[190,  81]],
      [[190,  83]],
      [[191,  84]],
      [[191,  87]],
      [[192,  88]],
      [[192,  95]],
      [[191,  96]],
      [[191,  99]],
      [[192, 100]],
      [[192, 102]],
      [[193, 102]],
      [[194, 103]],
      [[195, 102]],
      [[199, 102]],
      [[200, 101]],
      [[201, 101]],
      [[202, 100]],
      [[205, 100]],
      [[206,  99]],
      [[206,  96]],
      [[205,  95]],
      [[205,  94]],
      [[204,  93]],
      [[204,  92]],
      [[201,  89]],
      [[201,  88]],
      [[200,  87]],
      [[200,  86]],
      [[199,  85]],
      [[199,  84]],
      [[198,  83]],
      [[198,  80]],
      [[197,  79]],
      [[197,  74]],
      [[196,  73]],
      [[196,  72]],
      [[194,  70]]],
      dtype=np.int32
    ),
    np.array([ # distal 2 (19)
      [[130,  70]],
      [[129,  71]],
      [[128,  71]],
      [[126,  73]],
      [[126,  74]],
      [[125,  75]],
      [[125,  78]],
      [[126,  79]],
      [[126,  82]],
      [[127,  83]],
      [[127,  86]],
      [[128,  87]],
      [[128,  90]],
      [[127,  91]],
      [[127,  94]],
      [[126,  95]],
      [[126,  97]],
      [[125,  98]],
      [[125,  99]],
      [[124, 100]],
      [[124, 102]],
      [[125, 103]],
      [[124, 104]],
      [[125, 105]],
      [[137, 105]],
      [[138, 104]],
      [[140, 104]],
      [[140, 100]],
      [[139,  99]],
      [[139,  98]],
      [[137,  96]],
      [[137,  94]],
      [[136,  93]],
      [[136,  90]],
      [[135,  89]],
      [[135,  81]],
      [[136,  80]],
      [[136,  75]],
      [[135,  74]],
      [[135,  72]],
      [[134,  71]],
      [[131,  71]]],
      dtype=np.int32
    ),
    np.array([ # distal 3 (20)
      [[156,  46]],
      [[153,  49]],
      [[153,  53]],
      [[155,  55]],
      [[155,  61]],
      [[156,  62]],
      [[156,  70]],
      [[155,  71]],
      [[155,  73]],
      [[154,  74]],
      [[154,  80]],
      [[155,  80]],
      [[156,  81]],
      [[158,  81]],
      [[159,  80]],
      [[164,  80]],
      [[165,  79]],
      [[168,  79]],
      [[169,  78]],
      [[170,  78]],
      [[170,  74]],
      [[168,  72]],
      [[168,  71]],
      [[167,  70]],
      [[167,  69]],
      [[166,  68]],
      [[166,  67]],
      [[165,  66]],
      [[165,  64]],
      [[164,  63]],
      [[164,  58]],
      [[163,  57]],
      [[164,  56]],
      [[164,  51]],
      [[163,  50]],
      [[163,  48]],
      [[162,  47]],
      [[161,  47]],
      [[160,  46]]],
      dtype=np.int32
    ),
  ]

  distal_1 = 14
  medial_1 = 11
  proximal_1 = 9
  metacarpal_1 = 4
  distal_2 = 19
  medial_2 = 15
  proximal_2 = 10
  metacarpal_2 = 5
  distal_3 = 20
  medial_3 = 17
  proximal_3 = 13
  metacarpal_3 = 7
  distal_4 = 18
  medial_4 = 16
  proximal_4 = 12
  metacarpal_4 = 6
  distal_5 = 8
  proximal_5 = 3
  metacarpal_5 = 2
  ulna = 0
  radio = 1

  contour_map = [
    distal_1, medial_1, proximal_1, metacarpal_1,
    distal_2, medial_2, proximal_2, metacarpal_2,
    distal_3, medial_3, proximal_3, metacarpal_3,
    distal_4, medial_4, proximal_4, metacarpal_4,
    distal_5, proximal_5, metacarpal_5,
    ulna,
    radio,
  ]

  expected_contours = np.empty(21, dtype=object)
  expected_contours[0] = ExpectedContourDistalPhalanx(1)
  expected_contours[1] = ExpectedContourMedialPhalanx(1)
  expected_contours[2] = ExpectedContourProximalPhalanx(1)
  expected_contours[3] = ExpectedContourMetacarpal(
    1,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[0]
  )
  expected_contours[4] = ExpectedContourDistalPhalanx(
    2,
    first_encounter=expected_contours[0]
  )
  expected_contours[5] = ExpectedContourMedialPhalanx(
    2,
    first_encounter=expected_contours[1]
  )
  expected_contours[6] = ExpectedContourProximalPhalanx(
    2,
    first_encounter=expected_contours[2]
  )
  expected_contours[7] = ExpectedContourMetacarpal(
    2,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[4],
    first_encounter=expected_contours[3]
  )
  expected_contours[8] = ExpectedContourDistalPhalanx(
    3,
    first_encounter=expected_contours[0]
  )
  expected_contours[9] = ExpectedContourMedialPhalanx(
    3,
    first_encounter=expected_contours[1]
  )
  expected_contours[10] = ExpectedContourProximalPhalanx(
    3,
    first_encounter=expected_contours[2]
  )
  expected_contours[11] = ExpectedContourMetacarpal(
    3,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[8],
    first_encounter=expected_contours[3]
  )
  expected_contours[12] = ExpectedContourDistalPhalanx(
    4,
    first_encounter=expected_contours[0]
  )
  expected_contours[13] = ExpectedContourMedialPhalanx(
    4,
    first_encounter=expected_contours[1]
  )
  expected_contours[14] = ExpectedContourProximalPhalanx(
    4,
    first_encounter=expected_contours[2]
  )
  expected_contours[15] = ExpectedContourMetacarpal(
    4,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[12],
    first_encounter=expected_contours[3]
  )
  expected_contours[16] = ExpectedContourDistalPhalanx(
    5,
    first_encounter=expected_contours[0]
  )
  expected_contours[17] = ExpectedContourProximalPhalanx(
    5,
    first_encounter=expected_contours[2]
  )
  expected_contours[18] = ExpectedContourMetacarpal(
    5,
    first_encounter=expected_contours[3]
  )
  expected_contours[19] = ExpectedContourUlna()
  expected_contours[20] = ExpectedContourRadius()

  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. First finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[0:4]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Second finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[4:8]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Third finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[8:12]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Fourth finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[12:16],
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Fifth finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[16:19],
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Ulna, radius.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[19:21]
  )

def radiography_004_case_bug():
  contours = [np.array([[[ 64, 391]],

       [[ 62, 393]],

       [[ 62, 395]],

       [[ 61, 396]],

       [[ 61, 400]],

       [[ 60, 401]],

       [[ 60, 402]],

       [[ 61, 403]],

       [[ 60, 404]],

       [[ 61, 405]],

       [[ 61, 406]],

       [[ 62, 407]],

       [[ 62, 417]],

       [[ 63, 418]],

       [[ 63, 441]],

       [[ 81, 441]],

       [[ 81, 440]],

       [[ 82, 439]],

       [[ 82, 435]],

       [[ 83, 434]],

       [[ 83, 431]],

       [[ 84, 430]],

       [[ 84, 429]],

       [[ 85, 428]],

       [[ 85, 426]],

       [[ 86, 425]],

       [[ 86, 423]],

       [[ 87, 422]],

       [[ 87, 421]],

       [[ 88, 420]],

       [[ 88, 419]],

       [[ 89, 418]],

       [[ 89, 416]],

       [[ 90, 415]],

       [[ 90, 407]],

       [[ 91, 406]],

       [[ 91, 405]],

       [[ 90, 404]],

       [[ 90, 401]],

       [[ 87, 398]],

       [[ 86, 398]],

       [[ 85, 397]],

       [[ 83, 397]],

       [[ 82, 396]],

       [[ 81, 397]],

       [[ 78, 397]],

       [[ 77, 398]],

       [[ 76, 398]],

       [[ 75, 399]],

       [[ 73, 399]],

       [[ 70, 396]],

       [[ 70, 395]],

       [[ 69, 395]],

       [[ 68, 394]],

       [[ 68, 393]],

       [[ 66, 391]]], dtype=np.int32), np.array([[[142, 378]],

       [[141, 379]],

       [[138, 379]],

       [[136, 381]],

       [[135, 381]],

       [[133, 383]],

       [[132, 383]],

       [[131, 384]],

       [[130, 384]],

       [[129, 385]],

       [[127, 385]],

       [[129, 385]],

       [[130, 384]],

       [[132, 384]],

       [[133, 383]],

       [[134, 383]],

       [[136, 381]],

       [[137, 381]],

       [[139, 379]],

       [[141, 379]],

       [[142, 378]],

       [[147, 383]],

       [[147, 395]],

       [[146, 396]],

       [[146, 402]],

       [[145, 403]],

       [[145, 406]],

       [[144, 407]],

       [[143, 407]],

       [[143, 408]],

       [[142, 409]],

       [[143, 410]],

       [[143, 413]],

       [[142, 414]],

       [[142, 417]],

       [[141, 418]],

       [[141, 421]],

       [[140, 422]],

       [[140, 424]],

       [[139, 425]],

       [[139, 428]],

       [[138, 429]],

       [[138, 431]],

       [[137, 432]],

       [[137, 435]],

       [[136, 436]],

       [[136, 438]],

       [[135, 439]],

       [[135, 440]],

       [[134, 441]],

       [[102, 441]],

       [[101, 440]],

       [[101, 434]],

       [[100, 433]],

       [[100, 428]],

       [[ 99, 427]],

       [[ 99, 424]],

       [[ 98, 423]],

       [[ 98, 421]],

       [[ 97, 420]],

       [[ 97, 419]],

       [[ 96, 418]],

       [[ 96, 416]],

       [[ 95, 415]],

       [[ 95, 413]],

       [[ 93, 411]],

       [[ 93, 406]],

       [[ 94, 405]],

       [[ 94, 397]],

       [[ 95, 396]],

       [[ 95, 395]],

       [[ 97, 393]],

       [[ 98, 393]],

       [[ 99, 392]],

       [[100, 392]],

       [[101, 391]],

       [[104, 391]],

       [[105, 390]],

       [[108, 390]],

       [[109, 389]],

       [[116, 389]],

       [[117, 388]],

       [[123, 388]],

       [[124, 387]],

       [[126, 387]],

       [[124, 387]],

       [[123, 388]],

       [[117, 388]],

       [[116, 389]],

       [[109, 389]],

       [[108, 390]],

       [[105, 390]],

       [[104, 391]],

       [[101, 391]],

       [[100, 392]],

       [[ 99, 392]],

       [[ 98, 393]],

       [[ 97, 393]],

       [[ 95, 395]],

       [[ 95, 396]],

       [[ 94, 397]],

       [[ 94, 404]],

       [[ 93, 405]],

       [[ 93, 411]],

       [[ 94, 412]],

       [[ 94, 413]],

       [[ 95, 414]],

       [[ 95, 415]],

       [[ 96, 416]],

       [[ 96, 418]],

       [[ 97, 419]],

       [[ 97, 420]],

       [[ 98, 421]],

       [[ 98, 423]],

       [[ 99, 424]],

       [[ 99, 427]],

       [[100, 428]],

       [[100, 433]],

       [[101, 434]],

       [[101, 441]],

       [[135, 441]],

       [[135, 439]],

       [[136, 438]],

       [[136, 436]],

       [[137, 435]],

       [[137, 432]],

       [[138, 431]],

       [[138, 429]],

       [[139, 428]],

       [[139, 425]],

       [[140, 424]],

       [[140, 422]],

       [[141, 421]],

       [[141, 418]],

       [[142, 417]],

       [[142, 414]],

       [[143, 413]],

       [[143, 410]],

       [[142, 409]],

       [[145, 406]],

       [[145, 403]],

       [[146, 402]],

       [[146, 396]],

       [[147, 395]],

       [[147, 383]],

       [[146, 382]],

       [[146, 381]],

       [[143, 378]]], dtype=np.int32), np.array([[[208, 282]],

       [[207, 283]],

       [[206, 283]],

       [[205, 284]],

       [[204, 284]],

       [[202, 286]],

       [[201, 286]],

       [[199, 288]],

       [[199, 291]],

       [[200, 292]],

       [[200, 295]],

       [[199, 296]],

       [[199, 298]],

       [[198, 299]],

       [[198, 300]],

       [[197, 301]],

       [[197, 302]],

       [[196, 303]],

       [[196, 304]],

       [[195, 305]],

       [[195, 306]],

       [[193, 308]],

       [[193, 309]],

       [[190, 312]],

       [[190, 313]],

       [[187, 316]],

       [[187, 317]],

       [[176, 328]],

       [[175, 328]],

       [[173, 330]],

       [[172, 330]],

       [[170, 332]],

       [[169, 332]],

       [[168, 333]],

       [[167, 333]],

       [[166, 334]],

       [[165, 334]],

       [[164, 335]],

       [[162, 335]],

       [[161, 336]],

       [[159, 336]],

       [[157, 338]],

       [[157, 343]],

       [[158, 344]],

       [[158, 346]],

       [[161, 349]],

       [[161, 350]],

       [[162, 351]],

       [[162, 352]],

       [[163, 353]],

       [[163, 354]],

       [[165, 356]],

       [[166, 356]],

       [[167, 357]],

       [[178, 357]],

       [[181, 354]],

       [[181, 353]],

       [[182, 352]],

       [[182, 351]],

       [[184, 349]],

       [[184, 348]],

       [[186, 346]],

       [[186, 345]],

       [[187, 344]],

       [[187, 343]],

       [[188, 342]],

       [[188, 341]],

       [[190, 339]],

       [[190, 338]],

       [[192, 336]],

       [[192, 335]],

       [[197, 330]],

       [[197, 329]],

       [[201, 325]],

       [[201, 324]],

       [[205, 320]],

       [[205, 319]],

       [[210, 314]],

       [[210, 313]],

       [[224, 299]],

       [[224, 297]],

       [[225, 296]],

       [[225, 293]],

       [[223, 291]],

       [[221, 291]],

       [[219, 289]],

       [[219, 288]],

       [[215, 284]],

       [[214, 284]],

       [[213, 283]],

       [[211, 283]],

       [[210, 282]]], dtype=np.int32), np.array([[[245, 233]],

       [[243, 235]],

       [[242, 235]],

       [[242, 236]],

       [[241, 237]],

       [[241, 244]],

       [[240, 245]],

       [[240, 246]],

       [[239, 247]],

       [[239, 248]],

       [[238, 249]],

       [[238, 250]],

       [[235, 253]],

       [[235, 254]],

       [[231, 258]],

       [[230, 258]],

       [[226, 262]],

       [[225, 262]],

       [[223, 264]],

       [[222, 264]],

       [[220, 266]],

       [[219, 266]],

       [[215, 270]],

       [[214, 269]],

       [[211, 269]],

       [[209, 271]],

       [[209, 277]],

       [[210, 278]],

       [[211, 278]],

       [[212, 279]],

       [[213, 279]],

       [[218, 284]],

       [[219, 284]],

       [[221, 286]],

       [[222, 286]],

       [[225, 289]],

       [[226, 289]],

       [[229, 286]],

       [[229, 284]],

       [[231, 282]],

       [[231, 281]],

       [[232, 280]],

       [[232, 279]],

       [[233, 278]],

       [[233, 277]],

       [[234, 276]],

       [[234, 275]],

       [[236, 273]],

       [[236, 272]],

       [[238, 270]],

       [[238, 269]],

       [[240, 267]],

       [[240, 266]],

       [[243, 263]],

       [[243, 262]],

       [[253, 252]],

       [[253, 251]],

       [[254, 250]],

       [[255, 250]],

       [[258, 247]],

       [[258, 242]],

       [[257, 241]],

       [[257, 240]],

       [[255, 238]],

       [[252, 238]],

       [[251, 237]],

       [[251, 236]],

       [[250, 235]],

       [[249, 235]],

       [[247, 233]]], dtype=np.int32), np.array([[[ 47, 231]],

       [[ 46, 232]],

       [[ 44, 232]],

       [[ 43, 233]],

       [[ 42, 233]],

       [[ 41, 234]],

       [[ 41, 235]],

       [[ 40, 236]],

       [[ 40, 244]],

       [[ 41, 245]],

       [[ 41, 248]],

       [[ 42, 249]],

       [[ 42, 250]],

       [[ 43, 251]],

       [[ 43, 252]],

       [[ 44, 253]],

       [[ 44, 254]],

       [[ 45, 255]],

       [[ 45, 257]],

       [[ 46, 258]],

       [[ 46, 259]],

       [[ 47, 260]],

       [[ 47, 261]],

       [[ 48, 262]],

       [[ 48, 263]],

       [[ 49, 264]],

       [[ 49, 266]],

       [[ 50, 267]],

       [[ 50, 268]],

       [[ 51, 269]],

       [[ 51, 271]],

       [[ 52, 272]],

       [[ 52, 273]],

       [[ 53, 274]],

       [[ 53, 276]],

       [[ 54, 277]],

       [[ 54, 279]],

       [[ 55, 280]],

       [[ 55, 282]],

       [[ 56, 283]],

       [[ 56, 285]],

       [[ 57, 286]],

       [[ 57, 288]],

       [[ 58, 289]],

       [[ 58, 292]],

       [[ 59, 293]],

       [[ 59, 296]],

       [[ 60, 297]],

       [[ 60, 304]],

       [[ 61, 305]],

       [[ 61, 311]],

       [[ 62, 312]],

       [[ 62, 316]],

       [[ 63, 317]],

       [[ 63, 319]],

       [[ 64, 320]],

       [[ 64, 322]],

       [[ 65, 323]],

       [[ 65, 324]],

       [[ 66, 325]],

       [[ 66, 327]],

       [[ 67, 328]],

       [[ 67, 329]],

       [[ 68, 330]],

       [[ 68, 331]],

       [[ 69, 332]],

       [[ 70, 332]],

       [[ 71, 333]],

       [[ 72, 332]],

       [[ 73, 332]],

       [[ 76, 329]],

       [[ 77, 329]],

       [[ 80, 326]],

       [[ 81, 326]],

       [[ 84, 323]],

       [[ 85, 323]],

       [[ 87, 321]],

       [[ 87, 320]],

       [[ 85, 318]],

       [[ 85, 317]],

       [[ 84, 316]],

       [[ 84, 315]],

       [[ 80, 311]],

       [[ 80, 310]],

       [[ 79, 309]],

       [[ 79, 308]],

       [[ 77, 306]],

       [[ 77, 305]],

       [[ 76, 304]],

       [[ 76, 303]],

       [[ 74, 301]],

       [[ 74, 299]],

       [[ 73, 298]],

       [[ 73, 296]],

       [[ 72, 295]],

       [[ 72, 294]],

       [[ 71, 293]],

       [[ 71, 292]],

       [[ 70, 291]],

       [[ 70, 289]],

       [[ 69, 288]],

       [[ 69, 287]],

       [[ 68, 286]],

       [[ 68, 283]],

       [[ 67, 282]],

       [[ 67, 280]],

       [[ 66, 279]],

       [[ 66, 277]],

       [[ 65, 276]],

       [[ 65, 274]],

       [[ 64, 273]],

       [[ 64, 271]],

       [[ 63, 270]],

       [[ 63, 268]],

       [[ 62, 267]],

       [[ 62, 265]],

       [[ 61, 264]],

       [[ 61, 261]],

       [[ 60, 260]],

       [[ 60, 257]],

       [[ 59, 256]],

       [[ 59, 252]],

       [[ 58, 251]],

       [[ 58, 248]],

       [[ 59, 247]],

       [[ 59, 246]],

       [[ 60, 245]],

       [[ 60, 239]],

       [[ 59, 238]],

       [[ 59, 236]],

       [[ 58, 235]],

       [[ 58, 234]],

       [[ 56, 232]],

       [[ 54, 232]],

       [[ 53, 231]]], dtype=np.int32), np.array([[[ 77, 216]],

       [[ 76, 217]],

       [[ 74, 217]],

       [[ 72, 219]],

       [[ 71, 219]],

       [[ 70, 220]],

       [[ 70, 226]],

       [[ 71, 227]],

       [[ 71, 231]],

       [[ 72, 232]],

       [[ 72, 233]],

       [[ 73, 234]],

       [[ 73, 239]],

       [[ 74, 240]],

       [[ 74, 243]],

       [[ 75, 244]],

       [[ 75, 249]],

       [[ 76, 250]],

       [[ 76, 253]],

       [[ 77, 254]],

       [[ 77, 257]],

       [[ 78, 258]],

       [[ 78, 261]],

       [[ 79, 262]],

       [[ 79, 265]],

       [[ 80, 266]],

       [[ 80, 269]],

       [[ 81, 270]],

       [[ 81, 273]],

       [[ 82, 274]],

       [[ 82, 278]],

       [[ 83, 279]],

       [[ 83, 283]],

       [[ 84, 284]],

       [[ 84, 289]],

       [[ 85, 290]],

       [[ 85, 305]],

       [[ 84, 306]],

       [[ 84, 308]],

       [[ 83, 309]],

       [[ 83, 311]],

       [[ 84, 312]],

       [[ 86, 312]],

       [[ 87, 313]],

       [[ 92, 313]],

       [[ 93, 314]],

       [[ 99, 314]],

       [[100, 315]],

       [[103, 315]],

       [[103, 308]],

       [[102, 307]],

       [[102, 303]],

       [[101, 302]],

       [[101, 301]],

       [[100, 300]],

       [[100, 299]],

       [[ 99, 298]],

       [[ 99, 297]],

       [[ 98, 296]],

       [[ 98, 295]],

       [[ 97, 294]],

       [[ 97, 292]],

       [[ 96, 291]],

       [[ 96, 288]],

       [[ 95, 287]],

       [[ 95, 284]],

       [[ 94, 283]],

       [[ 94, 278]],

       [[ 93, 277]],

       [[ 93, 271]],

       [[ 92, 270]],

       [[ 92, 263]],

       [[ 91, 262]],

       [[ 91, 255]],

       [[ 90, 254]],

       [[ 90, 246]],

       [[ 89, 245]],

       [[ 89, 239]],

       [[ 90, 238]],

       [[ 90, 229]],

       [[ 91, 228]],

       [[ 91, 222]],

       [[ 87, 218]],

       [[ 86, 218]],

       [[ 85, 217]],

       [[ 82, 217]],

       [[ 81, 216]]], dtype=np.int32), np.array([[[152, 206]],

       [[151, 207]],

       [[148, 207]],

       [[146, 209]],

       [[146, 211]],

       [[145, 212]],

       [[145, 213]],

       [[144, 214]],

       [[144, 216]],

       [[142, 218]],

       [[142, 220]],

       [[141, 221]],

       [[141, 222]],

       [[142, 223]],

       [[142, 236]],

       [[141, 237]],

       [[141, 248]],

       [[140, 249]],

       [[140, 262]],

       [[139, 263]],

       [[139, 278]],

       [[138, 279]],

       [[138, 291]],

       [[137, 292]],

       [[137, 297]],

       [[136, 298]],

       [[136, 302]],

       [[135, 303]],

       [[135, 305]],

       [[134, 306]],

       [[134, 308]],

       [[133, 309]],

       [[133, 311]],

       [[132, 312]],

       [[132, 313]],

       [[131, 314]],

       [[131, 315]],

       [[130, 316]],

       [[130, 318]],

       [[129, 319]],

       [[129, 321]],

       [[128, 322]],

       [[128, 324]],

       [[129, 324]],

       [[130, 325]],

       [[131, 325]],

       [[132, 326]],

       [[133, 326]],

       [[134, 327]],

       [[136, 327]],

       [[137, 328]],

       [[138, 328]],

       [[139, 329]],

       [[140, 329]],

       [[141, 330]],

       [[143, 330]],

       [[144, 331]],

       [[145, 331]],

       [[146, 332]],

       [[148, 332]],

       [[149, 333]],

       [[150, 333]],

       [[151, 334]],

       [[152, 334]],

       [[153, 335]],

       [[154, 335]],

       [[154, 334]],

       [[153, 333]],

       [[153, 332]],

       [[154, 331]],

       [[154, 327]],

       [[153, 326]],

       [[154, 325]],

       [[154, 322]],

       [[153, 321]],

       [[153, 317]],

       [[152, 316]],

       [[152, 313]],

       [[151, 312]],

       [[151, 288]],

       [[152, 287]],

       [[152, 280]],

       [[153, 279]],

       [[153, 272]],

       [[154, 271]],

       [[154, 267]],

       [[155, 266]],

       [[155, 262]],

       [[156, 261]],

       [[156, 258]],

       [[157, 257]],

       [[157, 254]],

       [[158, 253]],

       [[158, 251]],

       [[159, 250]],

       [[159, 247]],

       [[160, 246]],

       [[160, 244]],

       [[161, 243]],

       [[161, 239]],

       [[162, 238]],

       [[162, 236]],

       [[163, 235]],

       [[163, 234]],

       [[166, 231]],

       [[167, 231]],

       [[168, 230]],

       [[168, 228]],

       [[169, 227]],

       [[169, 222]],

       [[168, 221]],

       [[168, 218]],

       [[167, 217]],

       [[167, 215]],

       [[165, 215]],

       [[164, 214]],

       [[164, 213]],

       [[163, 212]],

       [[163, 210]],

       [[162, 209]],

       [[161, 209]],

       [[160, 208]],

       [[159, 208]],

       [[158, 207]],

       [[155, 207]],

       [[154, 206]]], dtype=np.int32), np.array([[[112, 203]],

       [[111, 204]],

       [[107, 204]],

       [[106, 205]],

       [[105, 205]],

       [[103, 207]],

       [[103, 219]],

       [[102, 220]],

       [[102, 227]],

       [[103, 228]],

       [[103, 234]],

       [[104, 235]],

       [[104, 249]],

       [[105, 250]],

       [[105, 258]],

       [[106, 259]],

       [[106, 265]],

       [[107, 266]],

       [[107, 273]],

       [[108, 274]],

       [[108, 289]],

       [[109, 290]],

       [[109, 293]],

       [[108, 294]],

       [[108, 302]],

       [[107, 303]],

       [[107, 307]],

       [[109, 309]],

       [[110, 309]],

       [[113, 312]],

       [[114, 312]],

       [[118, 316]],

       [[119, 316]],

       [[122, 319]],

       [[123, 319]],

       [[125, 321]],

       [[125, 315]],

       [[126, 314]],

       [[126, 305]],

       [[125, 304]],

       [[125, 299]],

       [[124, 298]],

       [[124, 294]],

       [[123, 293]],

       [[123, 289]],

       [[122, 288]],

       [[122, 278]],

       [[121, 277]],

       [[121, 253]],

       [[122, 252]],

       [[122, 240]],

       [[123, 239]],

       [[123, 234]],

       [[124, 233]],

       [[124, 230]],

       [[125, 229]],

       [[125, 228]],

       [[126, 227]],

       [[126, 226]],

       [[128, 224]],

       [[129, 224]],

       [[129, 217]],

       [[128, 216]],

       [[128, 214]],

       [[127, 213]],

       [[127, 211]],

       [[122, 206]],

       [[121, 206]],

       [[120, 205]],

       [[118, 205]],

       [[117, 204]],

       [[113, 204]]], dtype=np.int32), np.array([[[275, 194]],

       [[274, 195]],

       [[273, 195]],

       [[272, 196]],

       [[271, 196]],

       [[269, 198]],

       [[269, 199]],

       [[268, 200]],

       [[268, 201]],

       [[267, 202]],

       [[267, 203]],

       [[266, 204]],

       [[266, 205]],

       [[263, 208]],

       [[263, 209]],

       [[261, 211]],

       [[261, 212]],

       [[258, 215]],

       [[258, 216]],

       [[256, 218]],

       [[256, 219]],

       [[254, 221]],

       [[253, 221]],

       [[252, 222]],

       [[251, 222]],

       [[249, 224]],

       [[248, 224]],

       [[248, 225]],

       [[247, 226]],

       [[247, 229]],

       [[248, 230]],

       [[248, 231]],

       [[250, 233]],

       [[251, 233]],

       [[254, 236]],

       [[257, 236]],

       [[258, 237]],

       [[262, 237]],

       [[262, 232]],

       [[263, 231]],

       [[263, 227]],

       [[264, 226]],

       [[264, 224]],

       [[265, 223]],

       [[265, 221]],

       [[267, 219]],

       [[267, 218]],

       [[268, 217]],

       [[268, 215]],

       [[270, 213]],

       [[270, 212]],

       [[271, 211]],

       [[271, 210]],

       [[272, 209]],

       [[272, 208]],

       [[274, 206]],

       [[274, 205]],

       [[276, 203]],

       [[276, 202]],

       [[280, 198]],

       [[280, 195]],

       [[279, 194]]], dtype=np.int32), np.array([[[ 39, 165]],

       [[ 38, 166]],

       [[ 37, 166]],

       [[ 36, 167]],

       [[ 34, 167]],

       [[ 33, 168]],

       [[ 30, 168]],

       [[ 30, 169]],

       [[ 29, 170]],

       [[ 29, 173]],

       [[ 30, 174]],

       [[ 30, 176]],

       [[ 31, 177]],

       [[ 31, 179]],

       [[ 32, 180]],

       [[ 32, 181]],

       [[ 33, 182]],

       [[ 33, 184]],

       [[ 34, 185]],

       [[ 34, 190]],

       [[ 35, 191]],

       [[ 35, 197]],

       [[ 36, 198]],

       [[ 36, 207]],

       [[ 37, 208]],

       [[ 37, 215]],

       [[ 36, 216]],

       [[ 36, 221]],

       [[ 35, 222]],

       [[ 35, 225]],

       [[ 34, 226]],

       [[ 34, 228]],

       [[ 35, 229]],

       [[ 35, 230]],

       [[ 36, 231]],

       [[ 41, 231]],

       [[ 42, 230]],

       [[ 43, 230]],

       [[ 44, 229]],

       [[ 47, 229]],

       [[ 48, 228]],

       [[ 57, 228]],

       [[ 58, 227]],

       [[ 58, 222]],

       [[ 57, 221]],

       [[ 57, 220]],

       [[ 56, 219]],

       [[ 56, 218]],

       [[ 54, 216]],

       [[ 54, 215]],

       [[ 53, 214]],

       [[ 53, 213]],

       [[ 51, 211]],

       [[ 51, 210]],

       [[ 50, 209]],

       [[ 50, 207]],

       [[ 49, 206]],

       [[ 49, 204]],

       [[ 48, 203]],

       [[ 48, 201]],

       [[ 47, 200]],

       [[ 47, 197]],

       [[ 46, 196]],

       [[ 46, 193]],

       [[ 45, 192]],

       [[ 45, 188]],

       [[ 44, 187]],

       [[ 44, 181]],

       [[ 43, 180]],

       [[ 43, 177]],

       [[ 44, 176]],

       [[ 44, 171]],

       [[ 43, 170]],

       [[ 43, 167]],

       [[ 41, 165]]], dtype=np.int32), np.array([[[ 77, 132]],

       [[ 76, 133]],

       [[ 67, 133]],

       [[ 66, 134]],

       [[ 66, 145]],

       [[ 67, 146]],

       [[ 67, 147]],

       [[ 68, 148]],

       [[ 68, 151]],

       [[ 69, 152]],

       [[ 69, 172]],

       [[ 70, 173]],

       [[ 70, 185]],

       [[ 71, 186]],

       [[ 71, 192]],

       [[ 70, 193]],

       [[ 70, 199]],

       [[ 69, 200]],

       [[ 69, 203]],

       [[ 68, 204]],

       [[ 68, 206]],

       [[ 67, 207]],

       [[ 67, 209]],

       [[ 66, 210]],

       [[ 66, 211]],

       [[ 67, 212]],

       [[ 67, 213]],

       [[ 68, 214]],

       [[ 68, 215]],

       [[ 72, 215]],

       [[ 73, 214]],

       [[ 76, 214]],

       [[ 77, 213]],

       [[ 82, 213]],

       [[ 83, 214]],

       [[ 89, 214]],

       [[ 90, 213]],

       [[ 90, 212]],

       [[ 91, 211]],

       [[ 91, 206]],

       [[ 90, 205]],

       [[ 90, 204]],

       [[ 89, 203]],

       [[ 89, 201]],

       [[ 88, 200]],

       [[ 88, 198]],

       [[ 87, 197]],

       [[ 87, 196]],

       [[ 86, 195]],

       [[ 86, 192]],

       [[ 85, 191]],

       [[ 85, 187]],

       [[ 84, 186]],

       [[ 84, 177]],

       [[ 83, 176]],

       [[ 83, 164]],

       [[ 82, 163]],

       [[ 82, 144]],

       [[ 83, 143]],

       [[ 83, 142]],

       [[ 82, 141]],

       [[ 83, 140]],

       [[ 82, 139]],

       [[ 82, 134]],

       [[ 80, 132]]], dtype=np.int32), np.array([[[ 32, 129]],

       [[ 31, 130]],

       [[ 28, 130]],

       [[ 27, 131]],

       [[ 21, 131]],

       [[ 21, 137]],

       [[ 22, 138]],

       [[ 22, 139]],

       [[ 24, 141]],

       [[ 24, 142]],

       [[ 25, 143]],

       [[ 25, 150]],

       [[ 26, 151]],

       [[ 26, 166]],

       [[ 32, 166]],

       [[ 33, 165]],

       [[ 35, 165]],

       [[ 36, 164]],

       [[ 37, 164]],

       [[ 38, 163]],

       [[ 41, 163]],

       [[ 42, 162]],

       [[ 42, 159]],

       [[ 40, 157]],

       [[ 40, 156]],

       [[ 38, 154]],

       [[ 38, 153]],

       [[ 36, 151]],

       [[ 36, 150]],

       [[ 35, 149]],

       [[ 35, 146]],

       [[ 34, 145]],

       [[ 34, 130]],

       [[ 33, 129]]], dtype=np.int32), np.array([[[147, 123]],

       [[146, 124]],

       [[137, 124]],

       [[136, 125]],

       [[136, 136]],

       [[137, 137]],

       [[137, 139]],

       [[138, 140]],

       [[138, 145]],

       [[139, 146]],

       [[139, 158]],

       [[140, 159]],

       [[140, 166]],

       [[141, 167]],

       [[141, 179]],

       [[142, 180]],

       [[142, 187]],

       [[141, 188]],

       [[141, 194]],

       [[140, 195]],

       [[140, 198]],

       [[139, 199]],

       [[140, 200]],

       [[139, 201]],

       [[140, 202]],

       [[140, 205]],

       [[141, 205]],

       [[142, 206]],

       [[143, 206]],

       [[144, 205]],

       [[146, 205]],

       [[147, 204]],

       [[148, 204]],

       [[149, 203]],

       [[158, 203]],

       [[159, 204]],

       [[162, 204]],

       [[163, 203]],

       [[165, 203]],

       [[166, 202]],

       [[167, 202]],

       [[167, 200]],

       [[168, 199]],

       [[168, 197]],

       [[167, 196]],

       [[167, 194]],

       [[164, 191]],

       [[164, 190]],

       [[163, 189]],

       [[163, 188]],

       [[162, 187]],

       [[162, 185]],

       [[160, 183]],

       [[160, 181]],

       [[159, 180]],

       [[159, 178]],

       [[158, 177]],

       [[158, 174]],

       [[157, 173]],

       [[157, 169]],

       [[156, 168]],

       [[156, 164]],

       [[155, 163]],

       [[155, 158]],

       [[154, 157]],

       [[154, 155]],

       [[153, 154]],

       [[153, 138]],

       [[154, 137]],

       [[154, 127]],

       [[152, 125]],

       [[152, 124]],

       [[149, 124]],

       [[148, 123]]], dtype=np.int32), np.array([[[112, 111]],

       [[111, 112]],

       [[109, 112]],

       [[107, 114]],

       [[104, 114]],

       [[103, 113]],

       [[ 98, 113]],

       [[ 98, 120]],

       [[ 97, 121]],

       [[ 97, 122]],

       [[ 98, 123]],

       [[ 98, 127]],

       [[ 99, 128]],

       [[ 99, 133]],

       [[100, 134]],

       [[100, 156]],

       [[101, 157]],

       [[101, 172]],

       [[102, 173]],

       [[102, 179]],

       [[101, 180]],

       [[101, 188]],

       [[100, 189]],

       [[100, 191]],

       [[ 99, 192]],

       [[ 99, 194]],

       [[ 98, 195]],

       [[ 98, 196]],

       [[ 99, 197]],

       [[ 98, 198]],

       [[ 98, 199]],

       [[ 99, 200]],

       [[ 99, 201]],

       [[100, 202]],

       [[105, 202]],

       [[106, 201]],

       [[110, 201]],

       [[111, 200]],

       [[113, 200]],

       [[114, 201]],

       [[124, 201]],

       [[126, 199]],

       [[126, 192]],

       [[124, 190]],

       [[124, 188]],

       [[123, 187]],

       [[123, 186]],

       [[121, 184]],

       [[121, 182]],

       [[120, 181]],

       [[120, 179]],

       [[119, 178]],

       [[119, 176]],

       [[118, 175]],

       [[118, 171]],

       [[117, 170]],

       [[117, 163]],

       [[116, 162]],

       [[116, 153]],

       [[115, 152]],

       [[115, 142]],

       [[114, 141]],

       [[114, 127]],

       [[116, 125]],

       [[116, 119]],

       [[115, 118]],

       [[115, 115]],

       [[114, 114]],

       [[114, 113]]], dtype=np.int32), np.array([[[ 23,  96]],

       [[ 22,  97]],

       [[ 21,  97]],

       [[ 20,  98]],

       [[ 20, 104]],

       [[ 21, 105]],

       [[ 21, 110]],

       [[ 22, 111]],

       [[ 22, 120]],

       [[ 21, 121]],

       [[ 21, 122]],

       [[ 20, 123]],

       [[ 20, 128]],

       [[ 21, 129]],

       [[ 26, 129]],

       [[ 27, 128]],

       [[ 30, 128]],

       [[ 31, 127]],

       [[ 32, 127]],

       [[ 33, 126]],

       [[ 33, 125]],

       [[ 34, 124]],

       [[ 33, 123]],

       [[ 33, 122]],

       [[ 30, 119]],

       [[ 30, 117]],

       [[ 28, 115]],

       [[ 28, 112]],

       [[ 27, 111]],

       [[ 27, 104]],

       [[ 28, 103]],

       [[ 28, 100]],

       [[ 27,  99]],

       [[ 27,  98]],

       [[ 25,  96]]], dtype=np.int32), np.array([[[ 66,  81]],

       [[ 65,  82]],

       [[ 64,  82]],

       [[ 64,  84]],

       [[ 63,  85]],

       [[ 63,  89]],

       [[ 64,  90]],

       [[ 64,  92]],

       [[ 65,  93]],

       [[ 65,  97]],

       [[ 66,  98]],

       [[ 66, 104]],

       [[ 65, 105]],

       [[ 65, 114]],

       [[ 64, 115]],

       [[ 64, 125]],

       [[ 63, 126]],

       [[ 63, 130]],

       [[ 64, 131]],

       [[ 66, 131]],

       [[ 67, 130]],

       [[ 71, 130]],

       [[ 72, 131]],

       [[ 73, 130]],

       [[ 77, 130]],

       [[ 78, 129]],

       [[ 82, 129]],

       [[ 82, 124]],

       [[ 81, 123]],

       [[ 81, 120]],

       [[ 80, 119]],

       [[ 80, 115]],

       [[ 79, 114]],

       [[ 79, 110]],

       [[ 78, 109]],

       [[ 78, 105]],

       [[ 77, 104]],

       [[ 77,  93]],

       [[ 78,  92]],

       [[ 78,  91]],

       [[ 79,  90]],

       [[ 79,  85]],

       [[ 78,  84]],

       [[ 78,  82]],

       [[ 77,  81]],

       [[ 72,  81]],

       [[ 71,  82]],

       [[ 68,  82]],

       [[ 67,  81]]], dtype=np.int32), np.array([[[141,  77]],

       [[140,  78]],

       [[138,  78]],

       [[137,  79]],

       [[133,  79]],

       [[133,  81]],

       [[132,  82]],

       [[132,  84]],

       [[133,  85]],

       [[133,  88]],

       [[134,  89]],

       [[134,  91]],

       [[135,  92]],

       [[135, 114]],

       [[134, 115]],

       [[134, 122]],

       [[135, 122]],

       [[136, 121]],

       [[140, 121]],

       [[141, 122]],

       [[144, 122]],

       [[145, 121]],

       [[147, 121]],

       [[148, 120]],

       [[150, 120]],

       [[151, 121]],

       [[152, 121]],

       [[154, 119]],

       [[154, 116]],

       [[153, 115]],

       [[153, 114]],

       [[152, 113]],

       [[152, 112]],

       [[151, 111]],

       [[151, 107]],

       [[150, 106]],

       [[150, 105]],

       [[149, 104]],

       [[149, 102]],

       [[147, 100]],

       [[147,  96]],

       [[146,  95]],

       [[146,  87]],

       [[147,  86]],

       [[147,  79]],

       [[146,  78]],

       [[146,  77]]], dtype=np.int32), np.array([[[102,  56]],

       [[101,  57]],

       [[ 96,  57]],

       [[ 95,  58]],

       [[ 95,  61]],

       [[ 94,  62]],

       [[ 94,  66]],

       [[ 95,  67]],

       [[ 95,  70]],

       [[ 96,  71]],

       [[ 96,  76]],

       [[ 97,  77]],

       [[ 97,  80]],

       [[ 96,  81]],

       [[ 96,  99]],

       [[ 95, 100]],

       [[ 95, 105]],

       [[ 94, 106]],

       [[ 94, 108]],

       [[ 95, 109]],

       [[ 95, 110]],

       [[107, 110]],

       [[108, 109]],

       [[115, 109]],

       [[116, 108]],

       [[116, 106]],

       [[117, 105]],

       [[116, 104]],

       [[116, 103]],

       [[114, 101]],

       [[114,  96]],

       [[113,  95]],

       [[113,  93]],

       [[112,  92]],

       [[112,  90]],

       [[111,  89]],

       [[111,  86]],

       [[110,  85]],

       [[110,  83]],

       [[109,  82]],

       [[109,  78]],

       [[108,  77]],

       [[108,  70]],

       [[109,  69]],

       [[109,  67]],

       [[110,  66]],

       [[110,  65]],

       [[111,  64]],

       [[111,  61]],

       [[110,  60]],

       [[110,  59]],

       [[109,  58]],

       [[109,  57]],

       [[108,  56]]], dtype=np.int32), np.array([[[129,  44]],

       [[129,  45]],

       [[127,  47]],

       [[127,  51]],

       [[128,  52]],

       [[128,  54]],

       [[129,  55]],

       [[129,  57]],

       [[130,  58]],

       [[130,  61]],

       [[131,  62]],

       [[131,  69]],

       [[130,  70]],

       [[130,  73]],

       [[131,  74]],

       [[131,  76]],

       [[132,  76]],

       [[133,  77]],

       [[134,  76]],

       [[138,  76]],

       [[139,  75]],

       [[140,  75]],

       [[141,  74]],

       [[144,  74]],

       [[145,  73]],

       [[145,  70]],

       [[144,  69]],

       [[144,  68]],

       [[143,  67]],

       [[143,  66]],

       [[140,  63]],

       [[140,  62]],

       [[139,  61]],

       [[139,  60]],

       [[138,  59]],

       [[138,  58]],

       [[137,  57]],

       [[137,  54]],

       [[136,  53]],

       [[136,  48]],

       [[135,  47]],

       [[135,  46]],

       [[133,  44]]], dtype=np.int32), np.array([[[69, 44]],

       [[68, 45]],

       [[67, 45]],

       [[65, 47]],

       [[65, 48]],

       [[64, 49]],

       [[64, 52]],

       [[65, 53]],

       [[65, 56]],

       [[66, 57]],

       [[66, 60]],

       [[67, 61]],

       [[67, 64]],

       [[66, 65]],

       [[66, 68]],

       [[65, 69]],

       [[65, 71]],

       [[64, 72]],

       [[64, 73]],

       [[63, 74]],

       [[63, 76]],

       [[64, 77]],

       [[63, 78]],

       [[64, 79]],

       [[76, 79]],

       [[77, 78]],

       [[79, 78]],

       [[79, 74]],

       [[78, 73]],

       [[78, 72]],

       [[76, 70]],

       [[76, 68]],

       [[75, 67]],

       [[75, 64]],

       [[74, 63]],

       [[74, 55]],

       [[75, 54]],

       [[75, 49]],

       [[74, 48]],

       [[74, 46]],

       [[73, 45]],

       [[70, 45]]], dtype=np.int32), np.array([[[ 95,  20]],

       [[ 92,  23]],

       [[ 92,  27]],

       [[ 94,  29]],

       [[ 94,  35]],

       [[ 95,  36]],

       [[ 95,  44]],

       [[ 94,  45]],

       [[ 94,  47]],

       [[ 93,  48]],

       [[ 93,  54]],

       [[ 94,  54]],

       [[ 95,  55]],

       [[ 97,  55]],

       [[ 98,  54]],

       [[103,  54]],

       [[104,  53]],

       [[107,  53]],

       [[108,  52]],

       [[109,  52]],

       [[109,  48]],

       [[107,  46]],

       [[107,  45]],

       [[106,  44]],

       [[106,  43]],

       [[105,  42]],

       [[105,  41]],

       [[104,  40]],

       [[104,  38]],

       [[103,  37]],

       [[103,  32]],

       [[102,  31]],

       [[103,  30]],

       [[103,  25]],

       [[102,  24]],

       [[102,  22]],

       [[101,  21]],

       [[100,  21]],

       [[ 99,  20]]], dtype=np.int32)]
  
  
  distal_1 = 14
  medial_1 = 11
  proximal_1 = 9
  metacarpal_1 = 4
  distal_2 = 19
  medial_2 = 15
  proximal_2 = 10
  metacarpal_2 = 5
  distal_3 = 20
  medial_3 = 7
  proximal_3 = 13
  metacarpal_3 = 7
  distal_4 = 18
  medial_4 = 16
  proximal_4 = 12
  metacarpal_4 = 6
  distal_5 = 8
  proximal_5 = 3
  metacarpal_5 = 2
  ulna = 0
  radio = 1

  contour_map = [
    distal_1, medial_1, proximal_1, metacarpal_1,
    distal_2, medial_2, proximal_2, metacarpal_2,
    distal_3, medial_3, proximal_3, metacarpal_3,
    distal_4, medial_4, proximal_4, metacarpal_4,
    distal_5, proximal_5, metacarpal_5,
    ulna,
    radio,
  ]

  expected_contours = np.empty(21, dtype=object)
  expected_contours[0] = ExpectedContourDistalPhalanx(1)
  expected_contours[1] = ExpectedContourMedialPhalanx(1)
  expected_contours[2] = ExpectedContourProximalPhalanx(1)
  expected_contours[3] = ExpectedContourMetacarpal(
    1,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[0]
  )
  expected_contours[4] = ExpectedContourDistalPhalanx(
    2,
    first_encounter=expected_contours[0]
  )
  expected_contours[5] = ExpectedContourMedialPhalanx(
    2,
    first_encounter=expected_contours[1]
  )
  expected_contours[6] = ExpectedContourProximalPhalanx(
    2,
    first_encounter=expected_contours[2]
  )
  expected_contours[7] = ExpectedContourMetacarpal(
    2,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[4],
    first_encounter=expected_contours[3]
  )
  expected_contours[8] = ExpectedContourDistalPhalanx(
    3,
    first_encounter=expected_contours[0]
  )
  expected_contours[9] = ExpectedContourMedialPhalanx(
    3,
    first_encounter=expected_contours[1]
  )
  expected_contours[10] = ExpectedContourProximalPhalanx(
    3,
    first_encounter=expected_contours[2]
  )
  expected_contours[11] = ExpectedContourMetacarpal(
    3,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[8],
    first_encounter=expected_contours[3]
  )
  expected_contours[12] = ExpectedContourDistalPhalanx(
    4,
    first_encounter=expected_contours[0]
  )
  expected_contours[13] = ExpectedContourMedialPhalanx(
    4,
    first_encounter=expected_contours[1]
  )
  expected_contours[14] = ExpectedContourProximalPhalanx(
    4,
    first_encounter=expected_contours[2]
  )
  expected_contours[15] = ExpectedContourMetacarpal(
    4,
    ends_branchs_sequence=True,
    first_in_branch=expected_contours[12],
    first_encounter=expected_contours[3]
  )
  expected_contours[16] = ExpectedContourDistalPhalanx(
    5,
    first_encounter=expected_contours[0]
  )
  expected_contours[17] = ExpectedContourProximalPhalanx(
    5,
    first_encounter=expected_contours[2]
  )
  expected_contours[18] = ExpectedContourMetacarpal(
    5,
    first_encounter=expected_contours[3]
  )
  expected_contours[19] = ExpectedContourUlna()
  expected_contours[20] = ExpectedContourRadius()

  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. First finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[0:4]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Second finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[4:8]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Third finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[8:12]
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Fourth finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[12:16],
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Fifth finger.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[16:19],
  )
  show_contours_position_restrictions(
    expected_contours,
    contour_map,
    contours,
    padding=5,
    title='004 radiography, 17.5 age hand. Ulna, radius.',
    minimize_image=False,
    show_position_restrictions=True,
    contour_map_mask=contour_map[19:21]
  )

def visualize_execute_tests():
  # canonical_hand_case()
  # radiography_004_case()
  radiography_004_case_bug()
  
  plt.show()
